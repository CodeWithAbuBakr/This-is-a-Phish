/*! For license information please see taskpane.js.LICENSE.txt */
"use strict";(self.webpackChunkoffice_addin_taskpane_react=self.webpackChunkoffice_addin_taskpane_react||[]).push([[926],{3072:function(e,t){var r="function"==typeof Symbol&&Symbol.for,n=r?Symbol.for("react.element"):60103,o=r?Symbol.for("react.portal"):60106,i=r?Symbol.for("react.fragment"):60107,a=r?Symbol.for("react.strict_mode"):60108,s=r?Symbol.for("react.profiler"):60114,c=r?Symbol.for("react.provider"):60109,l=r?Symbol.for("react.context"):60110,u=r?Symbol.for("react.async_mode"):60111,d=r?Symbol.for("react.concurrent_mode"):60111,h=r?Symbol.for("react.forward_ref"):60112,p=r?Symbol.for("react.suspense"):60113,f=r?Symbol.for("react.suspense_list"):60120,g=r?Symbol.for("react.memo"):60115,m=r?Symbol.for("react.lazy"):60116,y=r?Symbol.for("react.block"):60121,v=r?Symbol.for("react.fundamental"):60117,b=r?Symbol.for("react.responder"):60118,w=r?Symbol.for("react.scope"):60119;function C(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case n:switch(e=e.type){case u:case d:case i:case s:case a:case p:return e;default:switch(e=e&&e.$$typeof){case l:case h:case m:case g:case c:return e;default:return t}}case o:return t}}}function A(e){return C(e)===d}t.AsyncMode=u,t.ConcurrentMode=d,t.ContextConsumer=l,t.ContextProvider=c,t.Element=n,t.ForwardRef=h,t.Fragment=i,t.Lazy=m,t.Memo=g,t.Portal=o,t.Profiler=s,t.StrictMode=a,t.Suspense=p,t.isAsyncMode=function(e){return A(e)||C(e)===u},t.isConcurrentMode=A,t.isContextConsumer=function(e){return C(e)===l},t.isContextProvider=function(e){return C(e)===c},t.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===n},t.isForwardRef=function(e){return C(e)===h},t.isFragment=function(e){return C(e)===i},t.isLazy=function(e){return C(e)===m},t.isMemo=function(e){return C(e)===g},t.isPortal=function(e){return C(e)===o},t.isProfiler=function(e){return C(e)===s},t.isStrictMode=function(e){return C(e)===a},t.isSuspense=function(e){return C(e)===p},t.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===i||e===d||e===s||e===a||e===p||e===f||"object"==typeof e&&null!==e&&(e.$$typeof===m||e.$$typeof===g||e.$$typeof===c||e.$$typeof===l||e.$$typeof===h||e.$$typeof===v||e.$$typeof===b||e.$$typeof===w||e.$$typeof===y)},t.typeOf=C},4146:function(e,t,r){var n=r(73404),o={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},i={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},a={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},s={};function c(e){return n.isMemo(e)?a:s[e.$$typeof]||o}s[n.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},s[n.Memo]=a;var l=Object.defineProperty,u=Object.getOwnPropertyNames,d=Object.getOwnPropertySymbols,h=Object.getOwnPropertyDescriptor,p=Object.getPrototypeOf,f=Object.prototype;e.exports=function e(t,r,n){if("string"!=typeof r){if(f){var o=p(r);o&&o!==f&&e(t,o,n)}var a=u(r);d&&(a=a.concat(d(r)));for(var s=c(t),g=c(r),m=0;m<a.length;++m){var y=a[m];if(!(i[y]||n&&n[y]||g&&g[y]||s&&s[y])){var v=h(r,y);try{l(t,y,v)}catch(e){}}}}return t}},5338:function(e,t,r){var n=r(40961);t.H=n.createRoot,n.hydrateRoot},6774:function(e,t){Symbol.for("react.transitional.element"),Symbol.for("react.portal");var r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler");Symbol.for("react.provider");var i=Symbol.for("react.consumer"),a=Symbol.for("react.context"),s=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),l=Symbol.for("react.suspense_list"),u=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),h=(Symbol.for("react.view_transition"),Symbol.for("react.client.reference"));t.Hy=function(e){return"string"==typeof e||"function"==typeof e||e===r||e===o||e===n||e===c||e===l||"object"==typeof e&&null!==e&&(e.$$typeof===d||e.$$typeof===u||e.$$typeof===a||e.$$typeof===i||e.$$typeof===s||e.$$typeof===h||void 0!==e.getModuleId)}},10540:function(e){e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},16069:function(e,t){Object.prototype.toString},21020:function(e,t,r){var n=r(96540),o=Symbol.for("react.element"),i=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,s=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function l(e,t,r){var n,i={},l=null,u=null;for(n in void 0!==r&&(l=""+r),void 0!==t.key&&(l=""+t.key),void 0!==t.ref&&(u=t.ref),t)a.call(t,n)&&!c.hasOwnProperty(n)&&(i[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps)void 0===i[n]&&(i[n]=t[n]);return{$$typeof:o,type:e,key:l,ref:u,props:i,_owner:s.current}}t.Fragment=i,t.jsx=l,t.jsxs=l},22799:function(e,t){if("function"==typeof Symbol&&Symbol.for){var r=Symbol.for;r("react.element"),r("react.portal"),r("react.fragment"),r("react.strict_mode"),r("react.profiler"),r("react.provider"),r("react.context"),r("react.forward_ref"),r("react.suspense"),r("react.suspense_list"),r("react.memo"),r("react.lazy"),r("react.block"),r("react.server.block"),r("react.fundamental"),r("react.debug_trace_mode"),r("react.legacy_hidden")}},39046:function(){},41113:function(e){e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},44363:function(e,t,r){r(22799)},55056:function(e,t,r){e.exports=function(e){var t=r.nc;t&&e.setAttribute("nonce",t)}},65975:function(e,t,r){var n=r(96540),o=r.t(n,2),i=r(5338),a=(r(16069),r(64583).Promise);function s(e={}){let t,{initialEntries:r=["/"],initialIndex:n,v5Compat:o=!1}=e;t=r.map(((e,t)=>p(e,"string"==typeof e?null:e.state,0===t?"default":void 0)));let i=c(null==n?t.length-1:n),a="POP",s=null;function c(e){return Math.min(Math.max(e,0),t.length-1)}function h(){return t[i]}function p(e,r=null,n){let o=function(e,t,r=null,n){return{pathname:"string"==typeof e?e:e.pathname,search:"",hash:"",..."string"==typeof t?d(t):t,state:r,key:t&&t.key||n||Math.random().toString(36).substring(2,10)}}(t?h().pathname:"/",e,r,n);return l("/"===o.pathname.charAt(0),`relative pathnames are not supported in memory history: ${JSON.stringify(e)}`),o}function f(e){return"string"==typeof e?e:u(e)}return{get index(){return i},get action(){return a},get location(){return h()},createHref:f,createURL(e){return new URL(f(e),"http://localhost")},encodeLocation(e){let t="string"==typeof e?d(e):e;return{pathname:t.pathname||"",search:t.search||"",hash:t.hash||""}},push(e,r){a="PUSH";let n=p(e,r);i+=1,t.splice(i,t.length,n),o&&s&&s({action:a,location:n,delta:1})},replace(e,r){a="REPLACE";let n=p(e,r);t[i]=n,o&&s&&s({action:a,location:n,delta:0})},go(e){a="POP";let r=c(i+e),n=t[r];i=r,s&&s({action:a,location:n,delta:e})},listen(e){return s=e,()=>{s=null}}}}function c(e,t){if(!1===e||null==e)throw new Error(t)}function l(e,t){if(!e){"undefined"!=typeof console&&console.warn(t);try{throw new Error(t)}catch(e){}}}function u({pathname:e="/",search:t="",hash:r=""}){return t&&"?"!==t&&(e+="?"===t.charAt(0)?t:"?"+t),r&&"#"!==r&&(e+="#"===r.charAt(0)?r:"#"+r),e}function d(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substring(r),e=e.substring(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substring(n),e=e.substring(0,n)),e&&(t.pathname=e)}return t}function h(e,t,r="/"){return function(e,t,r,n){let o=I(("string"==typeof t?d(t):t).pathname||"/",r);if(null==o)return null;let i=p(e);!function(e){e.sort(((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){return e.length===t.length&&e.slice(0,-1).every(((e,r)=>e===t[r]))?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map((e=>e.childrenIndex)),t.routesMeta.map((e=>e.childrenIndex)))))}(i);let a=null;for(let e=0;null==a&&e<i.length;++e){let t=T(o);a=k(i[e],t,n)}return a}(e,t,r,!1)}function p(e,t=[],r=[],n=""){let o=(e,o,i)=>{let a={relativePath:void 0===i?e.path||"":i,caseSensitive:!0===e.caseSensitive,childrenIndex:o,route:e};a.relativePath.startsWith("/")&&(c(a.relativePath.startsWith(n),`Absolute route path "${a.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),a.relativePath=a.relativePath.slice(n.length));let s=P([n,a.relativePath]),l=r.concat(a);e.children&&e.children.length>0&&(c(!0!==e.index,`Index routes must not have child routes. Please remove all child routes from route path "${s}".`),p(e.children,t,l,s)),(null!=e.path||e.index)&&t.push({path:s,score:A(s,e.index),routesMeta:l})};return e.forEach(((e,t)=>{if(""!==e.path&&e.path?.includes("?"))for(let r of f(e.path))o(e,t,r);else o(e,t)})),t}function f(e){let t=e.split("/");if(0===t.length)return[];let[r,...n]=t,o=r.endsWith("?"),i=r.replace(/\?$/,"");if(0===n.length)return o?[i,""]:[i];let a=f(n.join("/")),s=[];return s.push(...a.map((e=>""===e?i:[i,e].join("/")))),o&&s.push(...a),s.map((t=>e.startsWith("/")&&""===t?"/":t))}new WeakMap;var g=/^:[\w-]+$/,m=3,y=2,v=1,b=10,w=-2,C=e=>"*"===e;function A(e,t){let r=e.split("/"),n=r.length;return r.some(C)&&(n+=w),t&&(n+=y),r.filter((e=>!C(e))).reduce(((e,t)=>e+(g.test(t)?m:""===t?v:b)),n)}function k(e,t,r=!1){let{routesMeta:n}=e,o={},i="/",a=[];for(let e=0;e<n.length;++e){let s=n[e],c=e===n.length-1,l="/"===i?t:t.slice(i.length)||"/",u=S({path:s.relativePath,caseSensitive:s.caseSensitive,end:c},l),d=s.route;if(!u&&c&&r&&!n[n.length-1].route.index&&(u=S({path:s.relativePath,caseSensitive:s.caseSensitive,end:!1},l)),!u)return null;Object.assign(o,u.params),a.push({params:o,pathname:P([i,u.pathname]),pathnameBase:R(P([i,u.pathnameBase])),route:d}),"/"!==u.pathnameBase&&(i=P([i,u.pathnameBase]))}return a}function S(e,t){"string"==typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=function(e,t=!1,r=!0){l("*"===e||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let n=[],o="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,((e,t,r)=>(n.push({paramName:t,isOptional:null!=r}),r?"/?([^\\/]+)?":"/([^\\/]+)")));return e.endsWith("*")?(n.push({paramName:"*"}),o+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?o+="\\/*$":""!==e&&"/"!==e&&(o+="(?:(?=\\/|$))"),[new RegExp(o,t?void 0:"i"),n]}(e.path,e.caseSensitive,e.end),o=t.match(r);if(!o)return null;let i=o[0],a=i.replace(/(.)\/+$/,"$1"),s=o.slice(1);return{params:n.reduce(((e,{paramName:t,isOptional:r},n)=>{if("*"===t){let e=s[n]||"";a=i.slice(0,i.length-e.length).replace(/(.)\/+$/,"$1")}const o=s[n];return e[t]=r&&!o?void 0:(o||"").replace(/%2F/g,"/"),e}),{}),pathname:i,pathnameBase:a,pattern:e}}function T(e){try{return e.split("/").map((e=>decodeURIComponent(e).replace(/\//g,"%2F"))).join("/")}catch(t){return l(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function I(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&"/"!==n?null:e.slice(r)||"/"}function E(e,t,r,n){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function x(e){let t=function(e){return e.filter(((e,t)=>0===t||e.route.path&&e.route.path.length>0))}(e);return t.map(((e,r)=>r===t.length-1?e.pathname:e.pathnameBase))}function _(e,t,r,n=!1){let o;"string"==typeof e?o=d(e):(o={...e},c(!o.pathname||!o.pathname.includes("?"),E("?","pathname","search",o)),c(!o.pathname||!o.pathname.includes("#"),E("#","pathname","hash",o)),c(!o.search||!o.search.includes("#"),E("#","search","hash",o)));let i,a=""===e||""===o.pathname,s=a?"/":o.pathname;if(null==s)i=r;else{let e=t.length-1;if(!n&&s.startsWith("..")){let t=s.split("/");for(;".."===t[0];)t.shift(),e-=1;o.pathname=t.join("/")}i=e>=0?t[e]:"/"}let l=function(e,t="/"){let{pathname:r,search:n="",hash:o=""}="string"==typeof e?d(e):e,i=r?r.startsWith("/")?r:function(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach((e=>{".."===e?r.length>1&&r.pop():"."!==e&&r.push(e)})),r.length>1?r.join("/"):"/"}(r,t):t;return{pathname:i,search:O(n),hash:M(o)}}(o,i),u=s&&"/"!==s&&s.endsWith("/"),h=(a||"."===s)&&r.endsWith("/");return l.pathname.endsWith("/")||!u&&!h||(l.pathname+="/"),l}var P=e=>e.join("/").replace(/\/\/+/g,"/"),R=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),O=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",M=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";function N(e){return null!=e&&"number"==typeof e.status&&"string"==typeof e.statusText&&"boolean"==typeof e.internal&&"data"in e}var B=["POST","PUT","PATCH","DELETE"],L=(new Set(B),["GET",...B]);new Set(L),Symbol("ResetLoaderData");var q=n.createContext(null);q.displayName="DataRouter";var H=n.createContext(null);H.displayName="DataRouterState";var $=n.createContext({isTransitioning:!1});$.displayName="ViewTransition",n.createContext(new Map).displayName="Fetchers",n.createContext(null).displayName="Await";var D=n.createContext(null);D.displayName="Navigation";var F=n.createContext(null);F.displayName="Location";var U=n.createContext({outlet:null,matches:[],isDataRoute:!1});U.displayName="Route";var j=n.createContext(null);function z(){return null!=n.useContext(F)}function K(){return c(z(),"useLocation() may be used only in the context of a <Router> component."),n.useContext(F).location}j.displayName="RouteError";var W="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function G(e){n.useContext(D).static||n.useLayoutEffect(e)}function V(){let{isDataRoute:e}=n.useContext(U);return e?function(){let{router:e}=function(e){let t=n.useContext(q);return c(t,te(e)),t}("useNavigate"),t=re("useNavigate"),r=n.useRef(!1);G((()=>{r.current=!0}));let o=n.useCallback((async(n,o={})=>{l(r.current,W),r.current&&("number"==typeof n?e.navigate(n):await e.navigate(n,{fromRouteId:t,...o}))}),[e,t]);return o}():function(){c(z(),"useNavigate() may be used only in the context of a <Router> component.");let e=n.useContext(q),{basename:t,navigator:r}=n.useContext(D),{matches:o}=n.useContext(U),{pathname:i}=K(),a=JSON.stringify(x(o)),s=n.useRef(!1);G((()=>{s.current=!0}));let u=n.useCallback(((n,o={})=>{if(l(s.current,W),!s.current)return;if("number"==typeof n)return void r.go(n);let c=_(n,JSON.parse(a),i,"path"===o.relative);null==e&&"/"!==t&&(c.pathname="/"===c.pathname?t:P([t,c.pathname])),(o.replace?r.replace:r.push)(c,o.state,o)}),[t,r,a,i,e]);return u}()}function Y(e,{relative:t}={}){let{matches:r}=n.useContext(U),{pathname:o}=K(),i=JSON.stringify(x(r));return n.useMemo((()=>_(e,JSON.parse(i),o,"path"===t)),[e,i,o,t])}function Q(e,t,r,o){c(z(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:i}=n.useContext(D),{matches:a}=n.useContext(U),s=a[a.length-1],u=s?s.params:{},p=s?s.pathname:"/",f=s?s.pathnameBase:"/",g=s&&s.route;{let e=g&&g.path||"";oe(p,!g||e.endsWith("*")||e.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${p}" (under <Route path="${e}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.\n\nPlease change the parent <Route path="${e}"> to <Route path="${"/"===e?"*":`${e}/*`}">.`)}let m,y=K();if(t){let e="string"==typeof t?d(t):t;c("/"===f||e.pathname?.startsWith(f),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${f}" but pathname "${e.pathname}" was given in the \`location\` prop.`),m=e}else m=y;let v=m.pathname||"/",b=v;if("/"!==f){let e=f.replace(/^\//,"").split("/");b="/"+v.replace(/^\//,"").split("/").slice(e.length).join("/")}let w=h(e,{pathname:b});l(g||null!=w,`No routes matched location "${m.pathname}${m.search}${m.hash}" `),l(null==w||void 0!==w[w.length-1].route.element||void 0!==w[w.length-1].route.Component||void 0!==w[w.length-1].route.lazy,`Matched leaf route at location "${m.pathname}${m.search}${m.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let C=function(e,t=[],r=null){if(null==e){if(!r)return null;if(r.errors)e=r.matches;else{if(0!==t.length||r.initialized||!(r.matches.length>0))return null;e=r.matches}}let o=e,i=r?.errors;if(null!=i){let e=o.findIndex((e=>e.route.id&&void 0!==i?.[e.route.id]));c(e>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(i).join(",")}`),o=o.slice(0,Math.min(o.length,e+1))}let a=!1,s=-1;if(r)for(let e=0;e<o.length;e++){let t=o[e];if((t.route.HydrateFallback||t.route.hydrateFallbackElement)&&(s=e),t.route.id){let{loaderData:e,errors:n}=r,i=t.route.loader&&!e.hasOwnProperty(t.route.id)&&(!n||void 0===n[t.route.id]);if(t.route.lazy||i){a=!0,o=s>=0?o.slice(0,s+1):[o[0]];break}}}return o.reduceRight(((e,c,l)=>{let u,d=!1,h=null,p=null;r&&(u=i&&c.route.id?i[c.route.id]:void 0,h=c.route.errorElement||X,a&&(s<0&&0===l?(oe("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),d=!0,p=null):s===l&&(d=!0,p=c.route.hydrateFallbackElement||null)));let f=t.concat(o.slice(0,l+1)),g=()=>{let t;return t=u?h:d?p:c.route.Component?n.createElement(c.route.Component,null):c.route.element?c.route.element:e,n.createElement(ee,{match:c,routeContext:{outlet:e,matches:f,isDataRoute:null!=r},children:t})};return r&&(c.route.ErrorBoundary||c.route.errorElement||0===l)?n.createElement(Z,{location:r.location,revalidation:r.revalidation,component:h,error:u,children:g(),routeContext:{outlet:null,matches:f,isDataRoute:!0}}):g()}),null)}(w&&w.map((e=>Object.assign({},e,{params:Object.assign({},u,e.params),pathname:P([f,i.encodeLocation?i.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?f:P([f,i.encodeLocation?i.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])}))),a,r,o);return t&&C?n.createElement(F.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...m},navigationType:"POP"}},C):C}function J(){let e=function(){let e=n.useContext(j),t=function(e){let t=n.useContext(H);return c(t,te(e)),t}("useRouteError"),r=re("useRouteError");return void 0!==e?e:t.errors?.[r]}(),t=N(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,o="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:o},a={padding:"2px 4px",backgroundColor:o},s=null;return console.error("Error handled by React Router default ErrorBoundary:",e),s=n.createElement(n.Fragment,null,n.createElement("p",null,"ðŸ’¿ Hey developer ðŸ‘‹"),n.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",n.createElement("code",{style:a},"ErrorBoundary")," or"," ",n.createElement("code",{style:a},"errorElement")," prop on your route.")),n.createElement(n.Fragment,null,n.createElement("h2",null,"Unexpected Application Error!"),n.createElement("h3",{style:{fontStyle:"italic"}},t),r?n.createElement("pre",{style:i},r):null,s)}n.createContext(null);var X=n.createElement(J,null),Z=class extends n.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return void 0!==this.state.error?n.createElement(U.Provider,{value:this.props.routeContext},n.createElement(j.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function ee({routeContext:e,match:t,children:r}){let o=n.useContext(q);return o&&o.static&&o.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(o.staticContext._deepestRenderedBoundaryId=t.route.id),n.createElement(U.Provider,{value:e},r)}function te(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function re(e){let t=function(e){let t=n.useContext(U);return c(t,te(e)),t}(e),r=t.matches[t.matches.length-1];return c(r.route.id,`${e} can only be used on routes that contain a unique "id"`),r.route.id}var ne={};function oe(e,t,r){t||ne[e]||(ne[e]=!0,l(!1,r))}function ie({basename:e,children:t,initialEntries:r,initialIndex:o}){let i=n.useRef();null==i.current&&(i.current=s({initialEntries:r,initialIndex:o,v5Compat:!0}));let a=i.current,[c,l]=n.useState({action:a.action,location:a.location}),u=n.useCallback((e=>{n.startTransition((()=>l(e)))}),[l]);return n.useLayoutEffect((()=>a.listen(u)),[a,u]),n.createElement(se,{basename:e,children:t,location:c.location,navigationType:c.action,navigator:a})}function ae(e){c(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function se({basename:e="/",children:t=null,location:r,navigationType:o="POP",navigator:i,static:a=!1}){c(!z(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let s=e.replace(/^\/*/,"/"),u=n.useMemo((()=>({basename:s,navigator:i,static:a,future:{}})),[s,i,a]);"string"==typeof r&&(r=d(r));let{pathname:h="/",search:p="",hash:f="",state:g=null,key:m="default"}=r,y=n.useMemo((()=>{let e=I(h,s);return null==e?null:{location:{pathname:e,search:p,hash:f,state:g,key:m},navigationType:o}}),[s,h,p,f,g,m,o]);return l(null!=y,`<Router basename="${s}"> is not able to match the URL "${h}${p}${f}" because it does not start with the basename, so the <Router> won't render anything.`),null==y?null:n.createElement(D.Provider,{value:u},n.createElement(F.Provider,{children:t,value:y}))}function ce({children:e,location:t}){return Q(le(e),t)}function le(e,t=[]){let r=[];return n.Children.forEach(e,((e,o)=>{if(!n.isValidElement(e))return;let i=[...t,o];if(e.type===n.Fragment)return void r.push.apply(r,le(e.props.children,i));c(e.type===ae,`[${"string"==typeof e.type?e.type:e.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),c(!e.props.index||!e.props.children,"An index route cannot have child routes.");let a={id:e.props.id||i.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,hydrateFallbackElement:e.props.hydrateFallbackElement,HydrateFallback:e.props.HydrateFallback,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:!0===e.props.hasErrorBoundary||null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(a.children=le(e.props.children,i)),r.push(a)})),r}n.memo((function({routes:e,future:t,state:r}){return Q(e,void 0,r,t)})),n.Component;var ue="get",de="application/x-www-form-urlencoded";function he(e){return null!=e&&"string"==typeof e.tagName}var pe=null,fe=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function ge(e){return null==e||fe.has(e)?e:(l(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${de}"`),null)}function me(e,t){if(!1===e||null==e)throw new Error(t)}function ye(e){return null!=e&&(null==e.href?"preload"===e.rel&&"string"==typeof e.imageSrcSet&&"string"==typeof e.imageSizes:"string"==typeof e.rel&&"string"==typeof e.href)}function ve(e,t,r,n,o,i){let a=(e,t)=>!r[t]||e.route.id!==r[t].route.id,s=(e,t)=>r[t].pathname!==e.pathname||r[t].route.path?.endsWith("*")&&r[t].params["*"]!==e.params["*"];return"assets"===i?t.filter(((e,t)=>a(e,t)||s(e,t))):"data"===i?t.filter(((t,i)=>{let c=n.routes[t.route.id];if(!c||!c.hasLoader)return!1;if(a(t,i)||s(t,i))return!0;if(t.route.shouldRevalidate){let n=t.route.shouldRevalidate({currentUrl:new URL(o.pathname+o.search+o.hash,window.origin),currentParams:r[0]?.params||{},nextUrl:new URL(e,window.origin),nextParams:t.params,defaultShouldRevalidate:!0});if("boolean"==typeof n)return n}return!0})):[]}function be(e,t,{includeHydrateFallback:r}={}){return n=e.map((e=>{let n=t.routes[e.route.id];if(!n)return[];let o=[n.module];return n.clientActionModule&&(o=o.concat(n.clientActionModule)),n.clientLoaderModule&&(o=o.concat(n.clientLoaderModule)),r&&n.hydrateFallbackModule&&(o=o.concat(n.hydrateFallbackModule)),n.imports&&(o=o.concat(n.imports)),o})).flat(1),[...new Set(n)];var n}Object.getOwnPropertyNames(Object.prototype).sort().join("\0"),"undefined"!=typeof window?window:"undefined"!=typeof globalThis&&globalThis,Symbol("SingleFetchRedirect");function we(){let e=n.useContext(q);return me(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function Ce(){let e=n.useContext(H);return me(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}n.Component;var Ae=n.createContext(void 0);function ke(){let e=n.useContext(Ae);return me(e,"You must render this element inside a <HydratedRouter> element"),e}function Se(e,t){return r=>{e&&e(r),r.defaultPrevented||t(r)}}function Te({page:e,...t}){let{router:r}=we(),o=n.useMemo((()=>h(r.routes,e,r.basename)),[r.routes,e,r.basename]);return o?n.createElement(Ee,{page:e,matches:o,...t}):null}function Ie(e){let{manifest:t,routeModules:r}=ke(),[o,i]=n.useState([]);return n.useEffect((()=>{let n=!1;return async function(e,t,r){return function(e,t){let r=new Set,n=new Set(t);return e.reduce(((e,o)=>{if(t&&(null==(i=o)||"string"!=typeof i.page)&&"script"===o.as&&o.href&&n.has(o.href))return e;var i;let a=JSON.stringify(function(e){let t={},r=Object.keys(e).sort();for(let n of r)t[n]=e[n];return t}(o));return r.has(a)||(r.add(a),e.push({key:a,link:o})),e}),[])}((await a.all(e.map((async e=>{let n=t.routes[e.route.id];if(n){let e=await async function(e,t){if(e.id in t)return t[e.id];try{let r=await import(e.module);return t[e.id]=r,r}catch(t){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new a((()=>{}))}}(n,r);return e.links?e.links():[]}return[]})))).flat(1).filter(ye).filter((e=>"stylesheet"===e.rel||"preload"===e.rel)).map((e=>"stylesheet"===e.rel?{...e,rel:"prefetch",as:"style"}:{...e,rel:"prefetch"})))}(e,t,r).then((e=>{n||i(e)})),()=>{n=!0}}),[e,t,r]),o}function Ee({page:e,matches:t,...r}){let o=K(),{manifest:i,routeModules:a}=ke(),{basename:s}=we(),{loaderData:c,matches:l}=Ce(),u=n.useMemo((()=>ve(e,t,l,i,o,"data")),[e,t,l,i,o]),d=n.useMemo((()=>ve(e,t,l,i,o,"assets")),[e,t,l,i,o]),h=n.useMemo((()=>{if(e===o.pathname+o.search+o.hash)return[];let r=new Set,n=!1;if(t.forEach((e=>{let t=i.routes[e.route.id];t&&t.hasLoader&&(!u.some((t=>t.route.id===e.route.id))&&e.route.id in c&&a[e.route.id]?.shouldRevalidate||t.hasClientLoader?n=!0:r.add(e.route.id))})),0===r.size)return[];let l=function(e,t){let r="string"==typeof e?new URL(e,"undefined"==typeof window?"server://singlefetch/":window.location.origin):e;return"/"===r.pathname?r.pathname="_root.data":t&&"/"===I(r.pathname,t)?r.pathname=`${t.replace(/\/$/,"")}/_root.data`:r.pathname=`${r.pathname.replace(/\/$/,"")}.data`,r}(e,s);return n&&r.size>0&&l.searchParams.set("_routes",t.filter((e=>r.has(e.route.id))).map((e=>e.route.id)).join(",")),[l.pathname+l.search]}),[s,c,o,i,u,t,e,a]),p=n.useMemo((()=>be(d,i)),[d,i]),f=Ie(d);return n.createElement(n.Fragment,null,h.map((e=>n.createElement("link",{key:e,rel:"prefetch",as:"fetch",href:e,...r}))),p.map((e=>n.createElement("link",{key:e,rel:"modulepreload",href:e,...r}))),f.map((({key:e,link:t})=>n.createElement("link",{key:e,...t}))))}Ae.displayName="FrameworkContext";function xe(...e){return t=>{e.forEach((e=>{"function"==typeof e?e(t):null!=e&&(e.current=t)}))}}var _e="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement;try{_e&&(window.__reactRouterVersion="7.6.1")}catch(e){}var Pe=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Re=n.forwardRef((function({onClick:e,discover:t="render",prefetch:r="none",relative:o,reloadDocument:i,replace:a,state:s,target:d,to:h,preventScrollReset:p,viewTransition:f,...g},m){let y,{basename:v}=n.useContext(D),b="string"==typeof h&&Pe.test(h),w=!1;if("string"==typeof h&&b&&(y=h,_e))try{let e=new URL(window.location.href),t=h.startsWith("//")?new URL(e.protocol+h):new URL(h),r=I(t.pathname,v);t.origin===e.origin&&null!=r?h=r+t.search+t.hash:w=!0}catch(e){l(!1,`<Link to="${h}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let C=function(e,{relative:t}={}){c(z(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:o}=n.useContext(D),{hash:i,pathname:a,search:s}=Y(e,{relative:t}),l=a;return"/"!==r&&(l="/"===a?r:P([r,a])),o.createHref({pathname:l,search:s,hash:i})}(h,{relative:o}),[A,k,S]=function(e,t){let r=n.useContext(Ae),[o,i]=n.useState(!1),[a,s]=n.useState(!1),{onFocus:c,onBlur:l,onMouseEnter:u,onMouseLeave:d,onTouchStart:h}=t,p=n.useRef(null);n.useEffect((()=>{if("render"===e&&s(!0),"viewport"===e){let e=new IntersectionObserver((e=>{e.forEach((e=>{s(e.isIntersecting)}))}),{threshold:.5});return p.current&&e.observe(p.current),()=>{e.disconnect()}}}),[e]),n.useEffect((()=>{if(o){let e=setTimeout((()=>{s(!0)}),100);return()=>{clearTimeout(e)}}}),[o]);let f=()=>{i(!0)},g=()=>{i(!1),s(!1)};return r?"intent"!==e?[a,p,{}]:[a,p,{onFocus:Se(c,f),onBlur:Se(l,g),onMouseEnter:Se(u,f),onMouseLeave:Se(d,g),onTouchStart:Se(h,f)}]:[!1,p,{}]}(r,g),T=function(e,{target:t,replace:r,state:o,preventScrollReset:i,relative:a,viewTransition:s}={}){let c=V(),l=K(),d=Y(e,{relative:a});return n.useCallback((n=>{if(function(e,t){return!(0!==e.button||t&&"_self"!==t||function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e))}(n,t)){n.preventDefault();let t=void 0!==r?r:u(l)===u(d);c(e,{replace:t,state:o,preventScrollReset:i,relative:a,viewTransition:s})}}),[l,c,d,r,o,t,e,i,a,s])}(h,{replace:a,state:s,target:d,preventScrollReset:p,relative:o,viewTransition:f}),E=n.createElement("a",{...g,...S,href:y||C,onClick:w||i?e:function(t){e&&e(t),t.defaultPrevented||T(t)},ref:xe(m,k),target:d,"data-discover":b||"render"!==t?void 0:"true"});return A&&!b?n.createElement(n.Fragment,null,E,n.createElement(Te,{page:C})):E}));Re.displayName="Link";var Oe=n.forwardRef((function({"aria-current":e="page",caseSensitive:t=!1,className:r="",end:o=!1,style:i,to:a,viewTransition:s,children:l,...u},d){let h=Y(a,{relative:u.relative}),p=K(),f=n.useContext(H),{navigator:g,basename:m}=n.useContext(D),y=null!=f&&function(e,t={}){let r=n.useContext($);c(null!=r,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:o}=Ne("useViewTransitionState"),i=Y(e,{relative:t.relative});if(!r.isTransitioning)return!1;let a=I(r.currentLocation.pathname,o)||r.currentLocation.pathname,s=I(r.nextLocation.pathname,o)||r.nextLocation.pathname;return null!=S(i.pathname,s)||null!=S(i.pathname,a)}(h)&&!0===s,v=g.encodeLocation?g.encodeLocation(h).pathname:h.pathname,b=p.pathname,w=f&&f.navigation&&f.navigation.location?f.navigation.location.pathname:null;t||(b=b.toLowerCase(),w=w?w.toLowerCase():null,v=v.toLowerCase()),w&&m&&(w=I(w,m)||w);const C="/"!==v&&v.endsWith("/")?v.length-1:v.length;let A,k=b===v||!o&&b.startsWith(v)&&"/"===b.charAt(C),T=null!=w&&(w===v||!o&&w.startsWith(v)&&"/"===w.charAt(v.length)),E={isActive:k,isPending:T,isTransitioning:y},x=k?e:void 0;A="function"==typeof r?r(E):[r,k?"active":null,T?"pending":null,y?"transitioning":null].filter(Boolean).join(" ");let _="function"==typeof i?i(E):i;return n.createElement(Re,{...u,"aria-current":x,className:A,ref:d,style:_,to:a,viewTransition:s},"function"==typeof l?l(E):l)}));Oe.displayName="NavLink";var Me=n.forwardRef((({discover:e="render",fetcherKey:t,navigate:r,reloadDocument:o,replace:i,state:a,method:s=ue,action:l,onSubmit:d,relative:h,preventScrollReset:p,viewTransition:f,...g},m)=>{let y=function(){let{router:e}=Ne("useSubmit"),{basename:t}=n.useContext(D),r=re("useRouteId");return n.useCallback((async(n,o={})=>{let{action:i,method:a,encType:s,formData:c,body:l}=function(e,t){let r,n,o,i,a;if(he(s=e)&&"form"===s.tagName.toLowerCase()){let a=e.getAttribute("action");n=a?I(a,t):null,r=e.getAttribute("method")||ue,o=ge(e.getAttribute("enctype"))||de,i=new FormData(e)}else if(function(e){return he(e)&&"button"===e.tagName.toLowerCase()}(e)||function(e){return he(e)&&"input"===e.tagName.toLowerCase()}(e)&&("submit"===e.type||"image"===e.type)){let a=e.form;if(null==a)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let s=e.getAttribute("formaction")||a.getAttribute("action");if(n=s?I(s,t):null,r=e.getAttribute("formmethod")||a.getAttribute("method")||ue,o=ge(e.getAttribute("formenctype"))||ge(a.getAttribute("enctype"))||de,i=new FormData(a,e),!function(){if(null===pe)try{new FormData(document.createElement("form"),0),pe=!1}catch(e){pe=!0}return pe}()){let{name:t,type:r,value:n}=e;if("image"===r){let e=t?`${t}.`:"";i.append(`${e}x`,"0"),i.append(`${e}y`,"0")}else t&&i.append(t,n)}}else{if(he(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=ue,n=null,o=de,a=e}var s;return i&&"text/plain"===o&&(a=i,i=void 0),{action:n,method:r.toLowerCase(),encType:o,formData:i,body:a}}(n,t);if(!1===o.navigate){let t=o.fetcherKey||Le();await e.fetch(t,r,o.action||i,{preventScrollReset:o.preventScrollReset,formData:c,body:l,formMethod:o.method||a,formEncType:o.encType||s,flushSync:o.flushSync})}else await e.navigate(o.action||i,{preventScrollReset:o.preventScrollReset,formData:c,body:l,formMethod:o.method||a,formEncType:o.encType||s,replace:o.replace,state:o.state,fromRouteId:r,flushSync:o.flushSync,viewTransition:o.viewTransition})}),[e,t,r])}(),v=function(e,{relative:t}={}){let{basename:r}=n.useContext(D),o=n.useContext(U);c(o,"useFormAction must be used inside a RouteContext");let[i]=o.matches.slice(-1),a={...Y(e||".",{relative:t})},s=K();if(null==e){a.search=s.search;let e=new URLSearchParams(a.search),t=e.getAll("index");if(t.some((e=>""===e))){e.delete("index"),t.filter((e=>e)).forEach((t=>e.append("index",t)));let r=e.toString();a.search=r?`?${r}`:""}}return e&&"."!==e||!i.route.index||(a.search=a.search?a.search.replace(/^\?/,"?index&"):"?index"),"/"!==r&&(a.pathname="/"===a.pathname?r:P([r,a.pathname])),u(a)}(l,{relative:h}),b="get"===s.toLowerCase()?"get":"post",w="string"==typeof l&&Pe.test(l);return n.createElement("form",{ref:m,method:b,action:v,onSubmit:o?d:e=>{if(d&&d(e),e.defaultPrevented)return;e.preventDefault();let n=e.nativeEvent.submitter,o=n?.getAttribute("formmethod")||s;y(n||e.currentTarget,{fetcherKey:t,method:o,navigate:r,replace:i,state:a,relative:h,preventScrollReset:p,viewTransition:f})},...g,"data-discover":w||"render"!==e?void 0:"true"})}));function Ne(e){let t=n.useContext(q);return c(t,function(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}(e)),t}Me.displayName="Form";var Be=0,Le=()=>`__${String(++Be)}__`;function qe(e){var t,r,n="";if("string"==typeof e||"number"==typeof e)n+=e;else if("object"==typeof e)if(Array.isArray(e)){var o=e.length;for(t=0;t<o;t++)e[t]&&(r=qe(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}var He=function(){for(var e,t,r=0,n="",o=arguments.length;r<o;r++)(e=arguments[r])&&(t=qe(e))&&(n&&(n+=" "),n+=t);return n};function $e(){return $e=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},$e.apply(null,arguments)}var De=function(){function e(e){var t=this;this._insertTag=function(e){var r;r=0===t.tags.length?t.insertionPoint?t.insertionPoint.nextSibling:t.prepend?t.container.firstChild:t.before:t.tags[t.tags.length-1].nextSibling,t.container.insertBefore(e,r),t.tags.push(e)},this.isSpeedy=void 0===e.speedy||e.speedy,this.tags=[],this.ctr=0,this.nonce=e.nonce,this.key=e.key,this.container=e.container,this.prepend=e.prepend,this.insertionPoint=e.insertionPoint,this.before=null}var t=e.prototype;return t.hydrate=function(e){e.forEach(this._insertTag)},t.insert=function(e){this.ctr%(this.isSpeedy?65e3:1)==0&&this._insertTag(function(e){var t=document.createElement("style");return t.setAttribute("data-emotion",e.key),void 0!==e.nonce&&t.setAttribute("nonce",e.nonce),t.appendChild(document.createTextNode("")),t.setAttribute("data-s",""),t}(this));var t=this.tags[this.tags.length-1];if(this.isSpeedy){var r=function(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}(t);try{r.insertRule(e,r.cssRules.length)}catch(e){}}else t.appendChild(document.createTextNode(e));this.ctr++},t.flush=function(){this.tags.forEach((function(e){var t;return null==(t=e.parentNode)?void 0:t.removeChild(e)})),this.tags=[],this.ctr=0},e}(),Fe=Math.abs,Ue=String.fromCharCode,je=Object.assign;function ze(e){return e.trim()}function Ke(e,t,r){return e.replace(t,r)}function We(e,t){return e.indexOf(t)}function Ge(e,t){return 0|e.charCodeAt(t)}function Ve(e,t,r){return e.slice(t,r)}function Ye(e){return e.length}function Qe(e){return e.length}function Je(e,t){return t.push(e),e}var Xe=1,Ze=1,et=0,tt=0,rt=0,nt="";function ot(e,t,r,n,o,i,a){return{value:e,root:t,parent:r,type:n,props:o,children:i,line:Xe,column:Ze,length:a,return:""}}function it(e,t){return je(ot("",null,null,"",null,null,0),e,{length:-e.length},t)}function at(){return rt=tt>0?Ge(nt,--tt):0,Ze--,10===rt&&(Ze=1,Xe--),rt}function st(){return rt=tt<et?Ge(nt,tt++):0,Ze++,10===rt&&(Ze=1,Xe++),rt}function ct(){return Ge(nt,tt)}function lt(){return tt}function ut(e,t){return Ve(nt,e,t)}function dt(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function ht(e){return Xe=Ze=1,et=Ye(nt=e),tt=0,[]}function pt(e){return nt="",e}function ft(e){return ze(ut(tt-1,yt(91===e?e+2:40===e?e+1:e)))}function gt(e){for(;(rt=ct())&&rt<33;)st();return dt(e)>2||dt(rt)>3?"":" "}function mt(e,t){for(;--t&&st()&&!(rt<48||rt>102||rt>57&&rt<65||rt>70&&rt<97););return ut(e,lt()+(t<6&&32==ct()&&32==st()))}function yt(e){for(;st();)switch(rt){case e:return tt;case 34:case 39:34!==e&&39!==e&&yt(rt);break;case 40:41===e&&yt(e);break;case 92:st()}return tt}function vt(e,t){for(;st()&&e+rt!==57&&(e+rt!==84||47!==ct()););return"/*"+ut(t,tt-1)+"*"+Ue(47===e?e:st())}function bt(e){for(;!dt(ct());)st();return ut(e,tt)}var wt="-ms-",Ct="-moz-",At="-webkit-",kt="comm",St="rule",Tt="decl",It="@keyframes";function Et(e,t){for(var r="",n=Qe(e),o=0;o<n;o++)r+=t(e[o],o,e,t)||"";return r}function xt(e,t,r,n){switch(e.type){case"@layer":if(e.children.length)break;case"@import":case Tt:return e.return=e.return||e.value;case kt:return"";case It:return e.return=e.value+"{"+Et(e.children,n)+"}";case St:e.value=e.props.join(",")}return Ye(r=Et(e.children,n))?e.return=e.value+"{"+r+"}":""}function _t(e){return pt(Pt("",null,null,null,[""],e=ht(e),0,[0],e))}function Pt(e,t,r,n,o,i,a,s,c){for(var l=0,u=0,d=a,h=0,p=0,f=0,g=1,m=1,y=1,v=0,b="",w=o,C=i,A=n,k=b;m;)switch(f=v,v=st()){case 40:if(108!=f&&58==Ge(k,d-1)){-1!=We(k+=Ke(ft(v),"&","&\f"),"&\f")&&(y=-1);break}case 34:case 39:case 91:k+=ft(v);break;case 9:case 10:case 13:case 32:k+=gt(f);break;case 92:k+=mt(lt()-1,7);continue;case 47:switch(ct()){case 42:case 47:Je(Ot(vt(st(),lt()),t,r),c);break;default:k+="/"}break;case 123*g:s[l++]=Ye(k)*y;case 125*g:case 59:case 0:switch(v){case 0:case 125:m=0;case 59+u:-1==y&&(k=Ke(k,/\f/g,"")),p>0&&Ye(k)-d&&Je(p>32?Mt(k+";",n,r,d-1):Mt(Ke(k," ","")+";",n,r,d-2),c);break;case 59:k+=";";default:if(Je(A=Rt(k,t,r,l,u,o,s,b,w=[],C=[],d),i),123===v)if(0===u)Pt(k,t,A,A,w,i,d,s,C);else switch(99===h&&110===Ge(k,3)?100:h){case 100:case 108:case 109:case 115:Pt(e,A,A,n&&Je(Rt(e,A,A,0,0,o,s,b,o,w=[],d),C),o,C,d,s,n?w:C);break;default:Pt(k,A,A,A,[""],C,0,s,C)}}l=u=p=0,g=y=1,b=k="",d=a;break;case 58:d=1+Ye(k),p=f;default:if(g<1)if(123==v)--g;else if(125==v&&0==g++&&125==at())continue;switch(k+=Ue(v),v*g){case 38:y=u>0?1:(k+="\f",-1);break;case 44:s[l++]=(Ye(k)-1)*y,y=1;break;case 64:45===ct()&&(k+=ft(st())),h=ct(),u=d=Ye(b=k+=bt(lt())),v++;break;case 45:45===f&&2==Ye(k)&&(g=0)}}return i}function Rt(e,t,r,n,o,i,a,s,c,l,u){for(var d=o-1,h=0===o?i:[""],p=Qe(h),f=0,g=0,m=0;f<n;++f)for(var y=0,v=Ve(e,d+1,d=Fe(g=a[f])),b=e;y<p;++y)(b=ze(g>0?h[y]+" "+v:Ke(v,/&\f/g,h[y])))&&(c[m++]=b);return ot(e,t,r,0===o?St:s,c,l,u)}function Ot(e,t,r){return ot(e,t,r,kt,Ue(rt),Ve(e,2,-2),0)}function Mt(e,t,r,n){return ot(e,t,r,Tt,Ve(e,0,n),Ve(e,n+1,-1),n)}var Nt=function(e,t,r){for(var n=0,o=0;n=o,o=ct(),38===n&&12===o&&(t[r]=1),!dt(o);)st();return ut(e,tt)},Bt=new WeakMap,Lt=function(e){if("rule"===e.type&&e.parent&&!(e.length<1)){for(var t=e.value,r=e.parent,n=e.column===r.column&&e.line===r.line;"rule"!==r.type;)if(!(r=r.parent))return;if((1!==e.props.length||58===t.charCodeAt(0)||Bt.get(r))&&!n){Bt.set(e,!0);for(var o=[],i=function(e,t){return pt(function(e,t){var r=-1,n=44;do{switch(dt(n)){case 0:38===n&&12===ct()&&(t[r]=1),e[r]+=Nt(tt-1,t,r);break;case 2:e[r]+=ft(n);break;case 4:if(44===n){e[++r]=58===ct()?"&\f":"",t[r]=e[r].length;break}default:e[r]+=Ue(n)}}while(n=st());return e}(ht(e),t))}(t,o),a=r.props,s=0,c=0;s<i.length;s++)for(var l=0;l<a.length;l++,c++)e.props[c]=o[s]?i[s].replace(/&\f/g,a[l]):a[l]+" "+i[s]}}},qt=function(e){if("decl"===e.type){var t=e.value;108===t.charCodeAt(0)&&98===t.charCodeAt(2)&&(e.return="",e.value="")}};function Ht(e,t){switch(function(e,t){return 45^Ge(e,0)?(((t<<2^Ge(e,0))<<2^Ge(e,1))<<2^Ge(e,2))<<2^Ge(e,3):0}(e,t)){case 5103:return At+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return At+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return At+e+Ct+e+wt+e+e;case 6828:case 4268:return At+e+wt+e+e;case 6165:return At+e+wt+"flex-"+e+e;case 5187:return At+e+Ke(e,/(\w+).+(:[^]+)/,At+"box-$1$2"+wt+"flex-$1$2")+e;case 5443:return At+e+wt+"flex-item-"+Ke(e,/flex-|-self/,"")+e;case 4675:return At+e+wt+"flex-line-pack"+Ke(e,/align-content|flex-|-self/,"")+e;case 5548:return At+e+wt+Ke(e,"shrink","negative")+e;case 5292:return At+e+wt+Ke(e,"basis","preferred-size")+e;case 6060:return At+"box-"+Ke(e,"-grow","")+At+e+wt+Ke(e,"grow","positive")+e;case 4554:return At+Ke(e,/([^-])(transform)/g,"$1"+At+"$2")+e;case 6187:return Ke(Ke(Ke(e,/(zoom-|grab)/,At+"$1"),/(image-set)/,At+"$1"),e,"")+e;case 5495:case 3959:return Ke(e,/(image-set\([^]*)/,At+"$1$`$1");case 4968:return Ke(Ke(e,/(.+:)(flex-)?(.*)/,At+"box-pack:$3"+wt+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+At+e+e;case 4095:case 3583:case 4068:case 2532:return Ke(e,/(.+)-inline(.+)/,At+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Ye(e)-1-t>6)switch(Ge(e,t+1)){case 109:if(45!==Ge(e,t+4))break;case 102:return Ke(e,/(.+:)(.+)-([^]+)/,"$1"+At+"$2-$3$1"+Ct+(108==Ge(e,t+3)?"$3":"$2-$3"))+e;case 115:return~We(e,"stretch")?Ht(Ke(e,"stretch","fill-available"),t)+e:e}break;case 4949:if(115!==Ge(e,t+1))break;case 6444:switch(Ge(e,Ye(e)-3-(~We(e,"!important")&&10))){case 107:return Ke(e,":",":"+At)+e;case 101:return Ke(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+At+(45===Ge(e,14)?"inline-":"")+"box$3$1"+At+"$2$3$1"+wt+"$2box$3")+e}break;case 5936:switch(Ge(e,t+11)){case 114:return At+e+wt+Ke(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return At+e+wt+Ke(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return At+e+wt+Ke(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return At+e+wt+e+e}return e}var $t=[function(e,t,r,n){if(e.length>-1&&!e.return)switch(e.type){case Tt:e.return=Ht(e.value,e.length);break;case It:return Et([it(e,{value:Ke(e.value,"@","@"+At)})],n);case St:if(e.length)return function(e,t){return e.map(t).join("")}(e.props,(function(t){switch(function(e){return(e=/(::plac\w+|:read-\w+)/.exec(e))?e[0]:e}(t)){case":read-only":case":read-write":return Et([it(e,{props:[Ke(t,/:(read-\w+)/,":-moz-$1")]})],n);case"::placeholder":return Et([it(e,{props:[Ke(t,/:(plac\w+)/,":"+At+"input-$1")]}),it(e,{props:[Ke(t,/:(plac\w+)/,":-moz-$1")]}),it(e,{props:[Ke(t,/:(plac\w+)/,wt+"input-$1")]})],n)}return""}))}}],Dt=function(e){var t=e.key;if("css"===t){var r=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(r,(function(e){-1!==e.getAttribute("data-emotion").indexOf(" ")&&(document.head.appendChild(e),e.setAttribute("data-s",""))}))}var n,o,i=e.stylisPlugins||$t,a={},s=[];n=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+t+' "]'),(function(e){for(var t=e.getAttribute("data-emotion").split(" "),r=1;r<t.length;r++)a[t[r]]=!0;s.push(e)}));var c,l,u,d,h=[xt,(d=function(e){c.insert(e)},function(e){e.root||(e=e.return)&&d(e)})],p=(l=[Lt,qt].concat(i,h),u=Qe(l),function(e,t,r,n){for(var o="",i=0;i<u;i++)o+=l[i](e,t,r,n)||"";return o});o=function(e,t,r,n){c=r,function(e){Et(_t(e),p)}(e?e+"{"+t.styles+"}":t.styles),n&&(f.inserted[t.name]=!0)};var f={key:t,sheet:new De({key:t,container:n,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:a,registered:{},insert:o};return f.sheet.hydrate(s),f};function Ft(e,t,r){var n="";return r.split(" ").forEach((function(r){void 0!==e[r]?t.push(e[r]+";"):r&&(n+=r+" ")})),n}var Ut=function(e,t,r){var n=e.key+"-"+t.name;!1===r&&void 0===e.registered[n]&&(e.registered[n]=t.styles)},jt=function(e,t,r){Ut(e,t,r);var n=e.key+"-"+t.name;if(void 0===e.inserted[t.name]){var o=t;do{e.insert(t===o?"."+n:"",o,e.sheet,!0),o=o.next}while(void 0!==o)}};function zt(e){for(var t,r=0,n=0,o=e.length;o>=4;++n,o-=4)t=1540483477*(65535&(t=255&e.charCodeAt(n)|(255&e.charCodeAt(++n))<<8|(255&e.charCodeAt(++n))<<16|(255&e.charCodeAt(++n))<<24))+(59797*(t>>>16)<<16),r=1540483477*(65535&(t^=t>>>24))+(59797*(t>>>16)<<16)^1540483477*(65535&r)+(59797*(r>>>16)<<16);switch(o){case 3:r^=(255&e.charCodeAt(n+2))<<16;case 2:r^=(255&e.charCodeAt(n+1))<<8;case 1:r=1540483477*(65535&(r^=255&e.charCodeAt(n)))+(59797*(r>>>16)<<16)}return(((r=1540483477*(65535&(r^=r>>>13))+(59797*(r>>>16)<<16))^r>>>15)>>>0).toString(36)}var Kt={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1};function Wt(e){var t=Object.create(null);return function(r){return void 0===t[r]&&(t[r]=e(r)),t[r]}}var Gt=/[A-Z]|^ms/g,Vt=/_EMO_([^_]+?)_([^]*?)_EMO_/g,Yt=function(e){return 45===e.charCodeAt(1)},Qt=function(e){return null!=e&&"boolean"!=typeof e},Jt=Wt((function(e){return Yt(e)?e:e.replace(Gt,"-$&").toLowerCase()})),Xt=function(e,t){switch(e){case"animation":case"animationName":if("string"==typeof t)return t.replace(Vt,(function(e,t,r){return er={name:t,styles:r,next:er},t}))}return 1===Kt[e]||Yt(e)||"number"!=typeof t||0===t?t:t+"px"};function Zt(e,t,r){if(null==r)return"";var n=r;if(void 0!==n.__emotion_styles)return n;switch(typeof r){case"boolean":return"";case"object":var o=r;if(1===o.anim)return er={name:o.name,styles:o.styles,next:er},o.name;var i=r;if(void 0!==i.styles){var a=i.next;if(void 0!==a)for(;void 0!==a;)er={name:a.name,styles:a.styles,next:er},a=a.next;return i.styles+";"}return function(e,t,r){var n="";if(Array.isArray(r))for(var o=0;o<r.length;o++)n+=Zt(e,t,r[o])+";";else for(var i in r){var a=r[i];if("object"!=typeof a){var s=a;null!=t&&void 0!==t[s]?n+=i+"{"+t[s]+"}":Qt(s)&&(n+=Jt(i)+":"+Xt(i,s)+";")}else if(!Array.isArray(a)||"string"!=typeof a[0]||null!=t&&void 0!==t[a[0]]){var c=Zt(e,t,a);switch(i){case"animation":case"animationName":n+=Jt(i)+":"+c+";";break;default:n+=i+"{"+c+"}"}}else for(var l=0;l<a.length;l++)Qt(a[l])&&(n+=Jt(i)+":"+Xt(i,a[l])+";")}return n}(e,t,r);case"function":if(void 0!==e){var s=er,c=r(e);return er=s,Zt(e,t,c)}}var l=r;if(null==t)return l;var u=t[l];return void 0!==u?u:l}var er,tr=/label:\s*([^\s;{]+)\s*(;|$)/g;function rr(e,t,r){if(1===e.length&&"object"==typeof e[0]&&null!==e[0]&&void 0!==e[0].styles)return e[0];var n=!0,o="";er=void 0;var i=e[0];null==i||void 0===i.raw?(n=!1,o+=Zt(r,t,i)):o+=i[0];for(var a=1;a<e.length;a++)o+=Zt(r,t,e[a]),n&&(o+=i[a]);tr.lastIndex=0;for(var s,c="";null!==(s=tr.exec(o));)c+="-"+s[1];return{name:zt(o)+c,styles:o,next:er}}var nr=!!o.useInsertionEffect&&o.useInsertionEffect,or=nr||function(e){return e()},ir=(nr||n.useLayoutEffect,n.createContext("undefined"!=typeof HTMLElement?Dt({key:"css"}):null)),ar=(ir.Provider,function(e){return(0,n.forwardRef)((function(t,r){var o=(0,n.useContext)(ir);return e(t,o,r)}))}),sr=n.createContext({}),cr={}.hasOwnProperty,lr="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",ur=function(e){var t=e.cache,r=e.serialized,n=e.isStringTag;return Ut(t,r,n),or((function(){return jt(t,r,n)})),null},dr=ar((function(e,t,r){var o=e.css;"string"==typeof o&&void 0!==t.registered[o]&&(o=t.registered[o]);var i=e[lr],a=[o],s="";"string"==typeof e.className?s=Ft(t.registered,a,e.className):null!=e.className&&(s=e.className+" ");var c=rr(a,void 0,n.useContext(sr));s+=t.key+"-"+c.name;var l={};for(var u in e)cr.call(e,u)&&"css"!==u&&u!==lr&&(l[u]=e[u]);return l.className=s,r&&(l.ref=r),n.createElement(n.Fragment,null,n.createElement(ur,{cache:t,serialized:c,isStringTag:"string"==typeof i}),n.createElement(i,l))})),hr=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|fetchpriority|fetchPriority|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,pr=Wt((function(e){return hr.test(e)||111===e.charCodeAt(0)&&110===e.charCodeAt(1)&&e.charCodeAt(2)<91})),fr=function(e){return"theme"!==e},gr=function(e){return"string"==typeof e&&e.charCodeAt(0)>96?pr:fr},mr=function(e,t,r){var n;if(t){var o=t.shouldForwardProp;n=e.__emotion_forwardProp&&o?function(t){return e.__emotion_forwardProp(t)&&o(t)}:o}return"function"!=typeof n&&r&&(n=e.__emotion_forwardProp),n},yr=function(e){var t=e.cache,r=e.serialized,n=e.isStringTag;return Ut(t,r,n),or((function(){return jt(t,r,n)})),null},vr=function e(t,r){var o,i,a=t.__emotion_real===t,s=a&&t.__emotion_base||t;void 0!==r&&(o=r.label,i=r.target);var c=mr(t,r,a),l=c||gr(s),u=!l("as");return function(){var d=arguments,h=a&&void 0!==t.__emotion_styles?t.__emotion_styles.slice(0):[];if(void 0!==o&&h.push("label:"+o+";"),null==d[0]||void 0===d[0].raw)h.push.apply(h,d);else{var p=d[0];h.push(p[0]);for(var f=d.length,g=1;g<f;g++)h.push(d[g],p[g])}var m=ar((function(e,t,r){var o=u&&e.as||s,a="",d=[],p=e;if(null==e.theme){for(var f in p={},e)p[f]=e[f];p.theme=n.useContext(sr)}"string"==typeof e.className?a=Ft(t.registered,d,e.className):null!=e.className&&(a=e.className+" ");var g=rr(h.concat(d),t.registered,p);a+=t.key+"-"+g.name,void 0!==i&&(a+=" "+i);var m=u&&void 0===c?gr(o):l,y={};for(var v in e)u&&"as"===v||m(v)&&(y[v]=e[v]);return y.className=a,r&&(y.ref=r),n.createElement(n.Fragment,null,n.createElement(yr,{cache:t,serialized:g,isStringTag:"string"==typeof o}),n.createElement(o,y))}));return m.displayName=void 0!==o?o:"Styled("+("string"==typeof s?s:s.displayName||s.name||"Component")+")",m.defaultProps=t.defaultProps,m.__emotion_real=m,m.__emotion_base=s,m.__emotion_styles=h,m.__emotion_forwardProp=c,Object.defineProperty(m,"toString",{value:function(){return"."+i}}),m.withComponent=function(t,n){return e(t,$e({},r,n,{shouldForwardProp:mr(m,n,!0)})).apply(void 0,h)},m}}.bind(null);function br(e,t){return vr(e,t)}["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"].forEach((function(e){vr[e]=vr(e)}));const wr=[];function Cr(e){return wr[0]=e,rr(wr)}function Ar(e,...t){const r=new URL(`https://mui.com/production-error/?code=${e}`);return t.forEach((e=>r.searchParams.append("args[]",e))),`Minified MUI error #${e}; visit ${r} for the full message.`}function kr(e){if("string"!=typeof e)throw new Error(Ar(7));return e.charAt(0).toUpperCase()+e.slice(1)}var Sr=r(6774);function Tr(e){if("object"!=typeof e||null===e)return!1;const t=Object.getPrototypeOf(e);return!(null!==t&&t!==Object.prototype&&null!==Object.getPrototypeOf(t)||Symbol.toStringTag in e||Symbol.iterator in e)}function Ir(e){if(n.isValidElement(e)||(0,Sr.Hy)(e)||!Tr(e))return e;const t={};return Object.keys(e).forEach((r=>{t[r]=Ir(e[r])})),t}function Er(e,t,r={clone:!0}){const o=r.clone?{...e}:e;return Tr(e)&&Tr(t)&&Object.keys(t).forEach((i=>{n.isValidElement(t[i])||(0,Sr.Hy)(t[i])?o[i]=t[i]:Tr(t[i])&&Object.prototype.hasOwnProperty.call(e,i)&&Tr(e[i])?o[i]=Er(e[i],t[i],r):r.clone?o[i]=Tr(t[i])?Ir(t[i]):t[i]:o[i]=t[i]})),o}var xr=function(e,t){return t?Er(e,t,{clone:!1}):e};const _r={xs:0,sm:600,md:900,lg:1200,xl:1536},Pr={keys:["xs","sm","md","lg","xl"],up:e=>`@media (min-width:${_r[e]}px)`},Rr={containerQueries:e=>({up:t=>{let r="number"==typeof t?t:_r[t]||t;return"number"==typeof r&&(r=`${r}px`),e?`@container ${e} (min-width:${r})`:`@container (min-width:${r})`}})};function Or(e,t,r){const n=e.theme||{};if(Array.isArray(t)){const e=n.breakpoints||Pr;return t.reduce(((n,o,i)=>(n[e.up(e.keys[i])]=r(t[i]),n)),{})}if("object"==typeof t){const e=n.breakpoints||Pr;return Object.keys(t).reduce(((o,i)=>{if(a=e.keys,"@"===(s=i)||s.startsWith("@")&&(a.some((e=>s.startsWith(`@${e}`)))||s.match(/^@\d/))){const e=function(e,t){const r=t.match(/^@([^/]+)?\/?(.+)?$/);if(!r)return null;const[,n,o]=r,i=Number.isNaN(+n)?n||0:+n;return e.containerQueries(o).up(i)}(n.containerQueries?n:Rr,i);e&&(o[e]=r(t[i],i))}else if(Object.keys(e.values||_r).includes(i))o[e.up(i)]=r(t[i],i);else{const e=i;o[e]=t[e]}var a,s;return o}),{})}return r(t)}function Mr(e,t,r=!0){if(!t||"string"!=typeof t)return null;if(e&&e.vars&&r){const r=`vars.${t}`.split(".").reduce(((e,t)=>e&&e[t]?e[t]:null),e);if(null!=r)return r}return t.split(".").reduce(((e,t)=>e&&null!=e[t]?e[t]:null),e)}function Nr(e,t,r,n=r){let o;return o="function"==typeof e?e(r):Array.isArray(e)?e[r]||n:Mr(e,r)||n,t&&(o=t(o,n,e)),o}var Br=function(e){const{prop:t,cssProperty:r=e.prop,themeKey:n,transform:o}=e,i=e=>{if(null==e[t])return null;const i=e[t],a=Mr(e.theme,n)||{};return Or(e,i,(e=>{let n=Nr(a,o,e);return e===n&&"string"==typeof e&&(n=Nr(a,o,`${t}${"default"===e?"":kr(e)}`,e)),!1===r?n:{[r]:n}}))};return i.propTypes={},i.filterProps=[t],i};const Lr={m:"margin",p:"padding"},qr={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},Hr={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},$r=function(){const e={};return t=>(void 0===e[t]&&(e[t]=(e=>{if(e.length>2){if(!Hr[e])return[e];e=Hr[e]}const[t,r]=e.split(""),n=Lr[t],o=qr[r]||"";return Array.isArray(o)?o.map((e=>n+e)):[n+o]})(t)),e[t])}(),Dr=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],Fr=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"],Ur=[...Dr,...Fr];function jr(e,t,r,n){const o=Mr(e,t,!0)??r;return"number"==typeof o||"string"==typeof o?e=>"string"==typeof e?e:"string"==typeof o?o.startsWith("var(")&&0===e?0:o.startsWith("var(")&&1===e?o:`calc(${e} * ${o})`:o*e:Array.isArray(o)?e=>{if("string"==typeof e)return e;const t=Math.abs(e),r=o[t];return e>=0?r:"number"==typeof r?-r:"string"==typeof r&&r.startsWith("var(")?`calc(-1 * ${r})`:`-${r}`}:"function"==typeof o?o:()=>{}}function zr(e){return jr(e,"spacing",8)}function Kr(e,t){return"string"==typeof t||null==t?t:e(t)}function Wr(e,t){const r=zr(e.theme);return Object.keys(e).map((n=>function(e,t,r,n){if(!t.includes(r))return null;const o=function(e,t){return r=>e.reduce(((e,n)=>(e[n]=Kr(t,r),e)),{})}($r(r),n);return Or(e,e[r],o)}(e,t,n,r))).reduce(xr,{})}function Gr(e){return Wr(e,Dr)}function Vr(e){return Wr(e,Fr)}function Yr(e){return Wr(e,Ur)}Gr.propTypes={},Gr.filterProps=Dr,Vr.propTypes={},Vr.filterProps=Fr,Yr.propTypes={},Yr.filterProps=Ur;var Qr=function(...e){const t=e.reduce(((e,t)=>(t.filterProps.forEach((r=>{e[r]=t})),e)),{}),r=e=>Object.keys(e).reduce(((r,n)=>t[n]?xr(r,t[n](e)):r),{});return r.propTypes={},r.filterProps=e.reduce(((e,t)=>e.concat(t.filterProps)),[]),r};function Jr(e){return"number"!=typeof e?e:`${e}px solid`}function Xr(e,t){return Br({prop:e,themeKey:"borders",transform:t})}const Zr=Xr("border",Jr),en=Xr("borderTop",Jr),tn=Xr("borderRight",Jr),rn=Xr("borderBottom",Jr),nn=Xr("borderLeft",Jr),on=Xr("borderColor"),an=Xr("borderTopColor"),sn=Xr("borderRightColor"),cn=Xr("borderBottomColor"),ln=Xr("borderLeftColor"),un=Xr("outline",Jr),dn=Xr("outlineColor"),hn=e=>{if(void 0!==e.borderRadius&&null!==e.borderRadius){const t=jr(e.theme,"shape.borderRadius",4),r=e=>({borderRadius:Kr(t,e)});return Or(e,e.borderRadius,r)}return null};hn.propTypes={},hn.filterProps=["borderRadius"],Qr(Zr,en,tn,rn,nn,on,an,sn,cn,ln,hn,un,dn);const pn=e=>{if(void 0!==e.gap&&null!==e.gap){const t=jr(e.theme,"spacing",8),r=e=>({gap:Kr(t,e)});return Or(e,e.gap,r)}return null};pn.propTypes={},pn.filterProps=["gap"];const fn=e=>{if(void 0!==e.columnGap&&null!==e.columnGap){const t=jr(e.theme,"spacing",8),r=e=>({columnGap:Kr(t,e)});return Or(e,e.columnGap,r)}return null};fn.propTypes={},fn.filterProps=["columnGap"];const gn=e=>{if(void 0!==e.rowGap&&null!==e.rowGap){const t=jr(e.theme,"spacing",8),r=e=>({rowGap:Kr(t,e)});return Or(e,e.rowGap,r)}return null};function mn(e,t){return"grey"===t?t:e}function yn(e){return e<=1&&0!==e?100*e+"%":e}gn.propTypes={},gn.filterProps=["rowGap"],Qr(pn,fn,gn,Br({prop:"gridColumn"}),Br({prop:"gridRow"}),Br({prop:"gridAutoFlow"}),Br({prop:"gridAutoColumns"}),Br({prop:"gridAutoRows"}),Br({prop:"gridTemplateColumns"}),Br({prop:"gridTemplateRows"}),Br({prop:"gridTemplateAreas"}),Br({prop:"gridArea"})),Qr(Br({prop:"color",themeKey:"palette",transform:mn}),Br({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:mn}),Br({prop:"backgroundColor",themeKey:"palette",transform:mn}));const vn=Br({prop:"width",transform:yn}),bn=e=>{if(void 0!==e.maxWidth&&null!==e.maxWidth){const t=t=>{const r=e.theme?.breakpoints?.values?.[t]||_r[t];return r?"px"!==e.theme?.breakpoints?.unit?{maxWidth:`${r}${e.theme.breakpoints.unit}`}:{maxWidth:r}:{maxWidth:yn(t)}};return Or(e,e.maxWidth,t)}return null};bn.filterProps=["maxWidth"];const wn=Br({prop:"minWidth",transform:yn}),Cn=Br({prop:"height",transform:yn}),An=Br({prop:"maxHeight",transform:yn}),kn=Br({prop:"minHeight",transform:yn});Br({prop:"size",cssProperty:"width",transform:yn}),Br({prop:"size",cssProperty:"height",transform:yn}),Qr(vn,bn,wn,Cn,An,kn,Br({prop:"boxSizing"}));var Sn={border:{themeKey:"borders",transform:Jr},borderTop:{themeKey:"borders",transform:Jr},borderRight:{themeKey:"borders",transform:Jr},borderBottom:{themeKey:"borders",transform:Jr},borderLeft:{themeKey:"borders",transform:Jr},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:Jr},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:hn},color:{themeKey:"palette",transform:mn},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:mn},backgroundColor:{themeKey:"palette",transform:mn},p:{style:Vr},pt:{style:Vr},pr:{style:Vr},pb:{style:Vr},pl:{style:Vr},px:{style:Vr},py:{style:Vr},padding:{style:Vr},paddingTop:{style:Vr},paddingRight:{style:Vr},paddingBottom:{style:Vr},paddingLeft:{style:Vr},paddingX:{style:Vr},paddingY:{style:Vr},paddingInline:{style:Vr},paddingInlineStart:{style:Vr},paddingInlineEnd:{style:Vr},paddingBlock:{style:Vr},paddingBlockStart:{style:Vr},paddingBlockEnd:{style:Vr},m:{style:Gr},mt:{style:Gr},mr:{style:Gr},mb:{style:Gr},ml:{style:Gr},mx:{style:Gr},my:{style:Gr},margin:{style:Gr},marginTop:{style:Gr},marginRight:{style:Gr},marginBottom:{style:Gr},marginLeft:{style:Gr},marginX:{style:Gr},marginY:{style:Gr},marginInline:{style:Gr},marginInlineStart:{style:Gr},marginInlineEnd:{style:Gr},marginBlock:{style:Gr},marginBlockStart:{style:Gr},marginBlockEnd:{style:Gr},displayPrint:{cssProperty:!1,transform:e=>({"@media print":{display:e}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:pn},rowGap:{style:gn},columnGap:{style:fn},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:yn},maxWidth:{style:bn},minWidth:{transform:yn},height:{transform:yn},maxHeight:{transform:yn},minHeight:{transform:yn},boxSizing:{},font:{themeKey:"font"},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}};const Tn=function(){function e(e,t,r,n){const o={[e]:t,theme:r},i=n[e];if(!i)return{[e]:t};const{cssProperty:a=e,themeKey:s,transform:c,style:l}=i;if(null==t)return null;if("typography"===s&&"inherit"===t)return{[e]:t};const u=Mr(r,s)||{};return l?l(o):Or(o,t,(t=>{let r=Nr(u,c,t);return t===r&&"string"==typeof t&&(r=Nr(u,c,`${e}${"default"===t?"":kr(t)}`,t)),!1===a?r:{[a]:r}}))}return function t(r){const{sx:n,theme:o={}}=r||{};if(!n)return null;const i=o.unstable_sxConfig??Sn;function a(r){let n=r;if("function"==typeof r)n=r(o);else if("object"!=typeof r)return r;if(!n)return null;const a=function(e={}){const t=e.keys?.reduce(((t,r)=>(t[e.up(r)]={},t)),{});return t||{}}(o.breakpoints),s=Object.keys(a);let c=a;return Object.keys(n).forEach((r=>{const a=function(e,t){return"function"==typeof e?e(t):e}(n[r],o);if(null!=a)if("object"==typeof a)if(i[r])c=xr(c,e(r,a,o,i));else{const e=Or({theme:o},a,(e=>({[r]:e})));!function(...e){const t=e.reduce(((e,t)=>e.concat(Object.keys(t))),[]),r=new Set(t);return e.every((e=>r.size===Object.keys(e).length))}(e,a)?c=xr(c,e):c[r]=t({sx:a,theme:o})}else c=xr(c,e(r,a,o,i))})),function(e,t){if(!e.containerQueries)return t;const r=Object.keys(t).filter((e=>e.startsWith("@container"))).sort(((e,t)=>{const r=/min-width:\s*([0-9.]+)/;return+(e.match(r)?.[1]||0)-+(t.match(r)?.[1]||0)}));return r.length?r.reduce(((e,r)=>{const n=t[r];return delete e[r],e[r]=n,e}),{...t}):t}(o,(l=c,s.reduce(((e,t)=>{const r=e[t];return(!r||0===Object.keys(r).length)&&delete e[t],e}),l)));var l}return Array.isArray(n)?n.map(a):a(n)}}();Tn.filterProps=["sx"];var In=Tn;function En(e){const{sx:t,...r}=e,{systemProps:n,otherProps:o}=(e=>{const t={systemProps:{},otherProps:{}},r=e?.theme?.unstable_sxConfig??Sn;return Object.keys(e).forEach((n=>{r[n]?t.systemProps[n]=e[n]:t.otherProps[n]=e[n]})),t})(r);let i;return i=Array.isArray(t)?[n,...t]:"function"==typeof t?(...e)=>{const r=t(...e);return Tr(r)?{...n,...r}:n}:{...n,...t},{...o,sx:i}}function xn(e){const{values:t={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:r="px",step:n=5,...o}=e,i=(e=>{const t=Object.keys(e).map((t=>({key:t,val:e[t]})))||[];return t.sort(((e,t)=>e.val-t.val)),t.reduce(((e,t)=>({...e,[t.key]:t.val})),{})})(t),a=Object.keys(i);function s(e){return`@media (min-width:${"number"==typeof t[e]?t[e]:e}${r})`}function c(e){return`@media (max-width:${("number"==typeof t[e]?t[e]:e)-n/100}${r})`}function l(e,o){const i=a.indexOf(o);return`@media (min-width:${"number"==typeof t[e]?t[e]:e}${r}) and (max-width:${(-1!==i&&"number"==typeof t[a[i]]?t[a[i]]:o)-n/100}${r})`}return{keys:a,values:i,up:s,down:c,between:l,only:function(e){return a.indexOf(e)+1<a.length?l(e,a[a.indexOf(e)+1]):s(e)},not:function(e){const t=a.indexOf(e);return 0===t?s(a[1]):t===a.length-1?c(a[t]):l(e,a[a.indexOf(e)+1]).replace("@media","@media not all and")},unit:r,...o}}var _n={borderRadius:4};function Pn(e=8,t=zr({spacing:e})){if(e.mui)return e;const r=(...e)=>(0===e.length?[1]:e).map((e=>{const r=t(e);return"number"==typeof r?`${r}px`:r})).join(" ");return r.mui=!0,r}function Rn(e,t){const r=this;if(r.vars){if(!r.colorSchemes?.[e]||"function"!=typeof r.getColorSchemeSelector)return{};let n=r.getColorSchemeSelector(e);return"&"===n?t:((n.includes("data-")||n.includes("."))&&(n=`*:where(${n.replace(/\s*&$/,"")}) &`),{[n]:t})}return r.palette.mode===e?t:{}}var On=function(e={},...t){const{breakpoints:r={},palette:n={},spacing:o,shape:i={},...a}=e;let s=Er({breakpoints:xn(r),direction:"ltr",components:{},palette:{mode:"light",...n},spacing:Pn(o),shape:{..._n,...i}},a);return s=function(e){const t=(e,t)=>e.replace("@media",t?`@container ${t}`:"@container");function r(r,n){r.up=(...r)=>t(e.breakpoints.up(...r),n),r.down=(...r)=>t(e.breakpoints.down(...r),n),r.between=(...r)=>t(e.breakpoints.between(...r),n),r.only=(...r)=>t(e.breakpoints.only(...r),n),r.not=(...r)=>{const o=t(e.breakpoints.not(...r),n);return o.includes("not all and")?o.replace("not all and ","").replace("min-width:","width<").replace("max-width:","width>").replace("and","or"):o}}const n={},o=e=>(r(n,e),n);return r(o),{...e,containerQueries:o}}(s),s.applyStyles=Rn,s=t.reduce(((e,t)=>Er(e,t)),s),s.unstable_sxConfig={...Sn,...a?.unstable_sxConfig},s.unstable_sx=function(e){return In({sx:e,theme:this})},s};const Mn=On();var Nn=function(e=Mn){return function(e=null){const t=n.useContext(sr);return t&&(r=t,0!==Object.keys(r).length)?t:e;var r}(e)},Bn=r(74848),Ln=r.t(Bn,2);const qn=e=>e;var Hn=(()=>{let e=qn;return{configure(t){e=t},generate(t){return e(t)},reset(){e=qn}}})();function $n(e,t=0,r=1){return function(e,t=Number.MIN_SAFE_INTEGER,r=Number.MAX_SAFE_INTEGER){return Math.max(t,Math.min(e,r))}(e,t,r)}function Dn(e){if(e.type)return e;if("#"===e.charAt(0))return Dn(function(e){e=e.slice(1);const t=new RegExp(`.{1,${e.length>=6?2:1}}`,"g");let r=e.match(t);return r&&1===r[0].length&&(r=r.map((e=>e+e))),r?`rgb${4===r.length?"a":""}(${r.map(((e,t)=>t<3?parseInt(e,16):Math.round(parseInt(e,16)/255*1e3)/1e3)).join(", ")})`:""}(e));const t=e.indexOf("("),r=e.substring(0,t);if(!["rgb","rgba","hsl","hsla","color"].includes(r))throw new Error(Ar(9,e));let n,o=e.substring(t+1,e.length-1);if("color"===r){if(o=o.split(" "),n=o.shift(),4===o.length&&"/"===o[3].charAt(0)&&(o[3]=o[3].slice(1)),!["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].includes(n))throw new Error(Ar(10,n))}else o=o.split(",");return o=o.map((e=>parseFloat(e))),{type:r,values:o,colorSpace:n}}const Fn=(e,t)=>{try{return(e=>{const t=Dn(e);return t.values.slice(0,3).map(((e,r)=>t.type.includes("hsl")&&0!==r?`${e}%`:e)).join(" ")})(e)}catch(t){return e}};function Un(e){const{type:t,colorSpace:r}=e;let{values:n}=e;return t.includes("rgb")?n=n.map(((e,t)=>t<3?parseInt(e,10):e)):t.includes("hsl")&&(n[1]=`${n[1]}%`,n[2]=`${n[2]}%`),n=t.includes("color")?`${r} ${n.join(" ")}`:`${n.join(", ")}`,`${t}(${n})`}function jn(e){e=Dn(e);const{values:t}=e,r=t[0],n=t[1]/100,o=t[2]/100,i=n*Math.min(o,1-o),a=(e,t=(e+r/30)%12)=>o-i*Math.max(Math.min(t-3,9-t,1),-1);let s="rgb";const c=[Math.round(255*a(0)),Math.round(255*a(8)),Math.round(255*a(4))];return"hsla"===e.type&&(s+="a",c.push(t[3])),Un({type:s,values:c})}function zn(e){let t="hsl"===(e=Dn(e)).type||"hsla"===e.type?Dn(jn(e)).values:e.values;return t=t.map((t=>("color"!==e.type&&(t/=255),t<=.03928?t/12.92:((t+.055)/1.055)**2.4))),Number((.2126*t[0]+.7152*t[1]+.0722*t[2]).toFixed(3))}function Kn(e,t){return e=Dn(e),t=$n(t),"rgb"!==e.type&&"hsl"!==e.type||(e.type+="a"),"color"===e.type?e.values[3]=`/${t}`:e.values[3]=t,Un(e)}function Wn(e,t,r){try{return Kn(e,t)}catch(t){return e}}function Gn(e,t){if(e=Dn(e),t=$n(t),e.type.includes("hsl"))e.values[2]*=1-t;else if(e.type.includes("rgb")||e.type.includes("color"))for(let r=0;r<3;r+=1)e.values[r]*=1-t;return Un(e)}function Vn(e,t,r){try{return Gn(e,t)}catch(t){return e}}function Yn(e,t){if(e=Dn(e),t=$n(t),e.type.includes("hsl"))e.values[2]+=(100-e.values[2])*t;else if(e.type.includes("rgb"))for(let r=0;r<3;r+=1)e.values[r]+=(255-e.values[r])*t;else if(e.type.includes("color"))for(let r=0;r<3;r+=1)e.values[r]+=(1-e.values[r])*t;return Un(e)}function Qn(e,t,r){try{return Yn(e,t)}catch(t){return e}}function Jn(e,t,r){try{return function(e,t=.15){return zn(e)>.5?Gn(e,t):Yn(e,t)}(e,t)}catch(t){return e}}var Xn={black:"#000",white:"#fff"},Zn={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},eo="#f3e5f5",to="#ce93d8",ro="#ba68c8",no="#ab47bc",oo="#9c27b0",io="#7b1fa2",ao="#e57373",so="#ef5350",co="#f44336",lo="#d32f2f",uo="#c62828",ho="#ffb74d",po="#ffa726",fo="#ff9800",go="#f57c00",mo="#e65100",yo="#e3f2fd",vo="#90caf9",bo="#42a5f5",wo="#1976d2",Co="#1565c0",Ao="#4fc3f7",ko="#29b6f6",So="#03a9f4",To="#0288d1",Io="#01579b",Eo="#81c784",xo="#66bb6a",_o="#4caf50",Po="#388e3c",Ro="#2e7d32",Oo="#1b5e20";function Mo(){return{text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:Xn.white,default:Xn.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}}}const No=Mo();function Bo(){return{text:{primary:Xn.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:Xn.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}}}const Lo=Bo();function qo(e,t,r,n){const o=n.light||n,i=n.dark||1.5*n;e[t]||(e.hasOwnProperty(r)?e[t]=e[r]:"light"===t?e.light=Yn(e.main,o):"dark"===t&&(e.dark=Gn(e.main,i)))}function Ho(e){const{mode:t="light",contrastThreshold:r=3,tonalOffset:n=.2,...o}=e,i=e.primary||function(e="light"){return"dark"===e?{main:vo,light:yo,dark:bo}:{main:wo,light:bo,dark:Co}}(t),a=e.secondary||function(e="light"){return"dark"===e?{main:to,light:eo,dark:no}:{main:oo,light:ro,dark:io}}(t),s=e.error||function(e="light"){return"dark"===e?{main:co,light:ao,dark:lo}:{main:lo,light:so,dark:uo}}(t),c=e.info||function(e="light"){return"dark"===e?{main:ko,light:Ao,dark:To}:{main:To,light:So,dark:Io}}(t),l=e.success||function(e="light"){return"dark"===e?{main:xo,light:Eo,dark:Po}:{main:Ro,light:_o,dark:Oo}}(t),u=e.warning||function(e="light"){return"dark"===e?{main:po,light:ho,dark:go}:{main:"#ed6c02",light:fo,dark:mo}}(t);function d(e){const t=function(e,t){const r=zn(e),n=zn(t);return(Math.max(r,n)+.05)/(Math.min(r,n)+.05)}(e,Lo.text.primary)>=r?Lo.text.primary:No.text.primary;return t}const h=({color:e,name:t,mainShade:r=500,lightShade:o=300,darkShade:i=700})=>{if(!(e={...e}).main&&e[r]&&(e.main=e[r]),!e.hasOwnProperty("main"))throw new Error(Ar(11,t?` (${t})`:"",r));if("string"!=typeof e.main)throw new Error(Ar(12,t?` (${t})`:"",JSON.stringify(e.main)));return qo(e,"light",o,n),qo(e,"dark",i,n),e.contrastText||(e.contrastText=d(e.main)),e};let p;return"light"===t?p=Mo():"dark"===t&&(p=Bo()),Er({common:{...Xn},mode:t,primary:h({color:i,name:"primary"}),secondary:h({color:a,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:h({color:s,name:"error"}),warning:h({color:u,name:"warning"}),info:h({color:c,name:"info"}),success:h({color:l,name:"success"}),grey:Zn,contrastThreshold:r,getContrastText:d,augmentColor:h,tonalOffset:n,...p},o)}function $o(e=""){function t(...r){if(!r.length)return"";const n=r[0];return"string"!=typeof n||n.match(/(#|\(|\)|(-?(\d*\.)?\d+)(px|em|%|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc))|^(-?(\d*\.)?\d+)$|(\d+ \d+ \d+)/)?`, ${n}`:`, var(--${e?`${e}-`:""}${n}${t(...r.slice(1))})`}return(r,...n)=>`var(--${e?`${e}-`:""}${r}${t(...n)})`}function Do(e){const t={};return Object.entries(e).forEach((e=>{const[r,n]=e;"object"==typeof n&&(t[r]=`${n.fontStyle?`${n.fontStyle} `:""}${n.fontVariant?`${n.fontVariant} `:""}${n.fontWeight?`${n.fontWeight} `:""}${n.fontStretch?`${n.fontStretch} `:""}${n.fontSize||""}${n.lineHeight?`/${n.lineHeight} `:""}${n.fontFamily||""}`)})),t}const Fo=(e,t,r,n=[])=>{let o=e;t.forEach(((e,i)=>{i===t.length-1?Array.isArray(o)?o[Number(e)]=r:o&&"object"==typeof o&&(o[e]=r):o&&"object"==typeof o&&(o[e]||(o[e]=n.includes(e)?[]:{}),o=o[e])}))};function Uo(e,t){const{prefix:r,shouldSkipGeneratingVar:n}=t||{},o={},i={},a={};var s,c;return s=(e,t,s)=>{if(!("string"!=typeof t&&"number"!=typeof t||n&&n(e,t))){const n=`--${r?`${r}-`:""}${e.join("-")}`,c=((e,t)=>"number"==typeof t?["lineHeight","fontWeight","opacity","zIndex"].some((t=>e.includes(t)))||e[e.length-1].toLowerCase().includes("opacity")?t:`${t}px`:t)(e,t);Object.assign(o,{[n]:c}),Fo(i,e,`var(${n})`,s),Fo(a,e,`var(${n}, ${c})`,s)}},c=e=>"vars"===e[0],function e(t,r=[],n=[]){Object.entries(t).forEach((([t,o])=>{(!c||c&&!c([...r,t]))&&null!=o&&("object"==typeof o&&Object.keys(o).length>0?e(o,[...r,t],Array.isArray(o)?[...n,t]:n):s([...r,t],o,n))}))}(e),{css:o,vars:i,varsWithDefaults:a}}const jo={textTransform:"uppercase"},zo='"Roboto", "Helvetica", "Arial", sans-serif';function Ko(e,t){const{fontFamily:r=zo,fontSize:n=14,fontWeightLight:o=300,fontWeightRegular:i=400,fontWeightMedium:a=500,fontWeightBold:s=700,htmlFontSize:c=16,allVariants:l,pxToRem:u,...d}="function"==typeof t?t(e):t,h=n/14,p=u||(e=>e/c*h+"rem"),f=(e,t,n,o,i)=>{return{fontFamily:r,fontWeight:e,fontSize:p(t),lineHeight:n,...r===zo?{letterSpacing:(a=o/t,Math.round(1e5*a)/1e5+"em")}:{},...i,...l};var a},g={h1:f(o,96,1.167,-1.5),h2:f(o,60,1.2,-.5),h3:f(i,48,1.167,0),h4:f(i,34,1.235,.25),h5:f(i,24,1.334,0),h6:f(a,20,1.6,.15),subtitle1:f(i,16,1.75,.15),subtitle2:f(a,14,1.57,.1),body1:f(i,16,1.5,.15),body2:f(i,14,1.43,.15),button:f(a,14,1.75,.4,jo),caption:f(i,12,1.66,.4),overline:f(i,12,2.66,1,jo),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return Er({htmlFontSize:c,pxToRem:p,fontFamily:r,fontSize:n,fontWeightLight:o,fontWeightRegular:i,fontWeightMedium:a,fontWeightBold:s,...g},d,{clone:!1})}function Wo(...e){return[`${e[0]}px ${e[1]}px ${e[2]}px ${e[3]}px rgba(0,0,0,0.2)`,`${e[4]}px ${e[5]}px ${e[6]}px ${e[7]}px rgba(0,0,0,0.14)`,`${e[8]}px ${e[9]}px ${e[10]}px ${e[11]}px rgba(0,0,0,0.12)`].join(",")}var Go=["none",Wo(0,2,1,-1,0,1,1,0,0,1,3,0),Wo(0,3,1,-2,0,2,2,0,0,1,5,0),Wo(0,3,3,-2,0,3,4,0,0,1,8,0),Wo(0,2,4,-1,0,4,5,0,0,1,10,0),Wo(0,3,5,-1,0,5,8,0,0,1,14,0),Wo(0,3,5,-1,0,6,10,0,0,1,18,0),Wo(0,4,5,-2,0,7,10,1,0,2,16,1),Wo(0,5,5,-3,0,8,10,1,0,3,14,2),Wo(0,5,6,-3,0,9,12,1,0,3,16,2),Wo(0,6,6,-3,0,10,14,1,0,4,18,3),Wo(0,6,7,-4,0,11,15,1,0,4,20,3),Wo(0,7,8,-4,0,12,17,2,0,5,22,4),Wo(0,7,8,-4,0,13,19,2,0,5,24,4),Wo(0,7,9,-4,0,14,21,2,0,5,26,4),Wo(0,8,9,-5,0,15,22,2,0,6,28,5),Wo(0,8,10,-5,0,16,24,2,0,6,30,5),Wo(0,8,11,-5,0,17,26,2,0,6,32,5),Wo(0,9,11,-5,0,18,28,2,0,7,34,6),Wo(0,9,12,-6,0,19,29,2,0,7,36,6),Wo(0,10,13,-6,0,20,31,3,0,8,38,7),Wo(0,10,13,-6,0,21,33,3,0,8,40,7),Wo(0,10,14,-6,0,22,35,3,0,8,42,7),Wo(0,11,14,-7,0,23,36,3,0,9,44,8),Wo(0,11,15,-7,0,24,38,3,0,9,46,8)];const Vo={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},Yo={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function Qo(e){return`${Math.round(e)}ms`}function Jo(e){if(!e)return 0;const t=e/36;return Math.min(Math.round(10*(4+15*t**.25+t/5)),3e3)}function Xo(e){const t={...Vo,...e.easing},r={...Yo,...e.duration};return{getAutoHeightDuration:Jo,create:(e=["all"],n={})=>{const{duration:o=r.standard,easing:i=t.easeInOut,delay:a=0,...s}=n;return(Array.isArray(e)?e:[e]).map((e=>`${e} ${"string"==typeof o?o:Qo(o)} ${i} ${"string"==typeof a?a:Qo(a)}`)).join(",")},...e,easing:t,duration:r}}var Zo={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500};function ei(e={}){const t={...e};return function e(t){const r=Object.entries(t);for(let o=0;o<r.length;o++){const[i,a]=r[o];!Tr(n=a)&&void 0!==n&&"string"!=typeof n&&"boolean"!=typeof n&&"number"!=typeof n&&!Array.isArray(n)||i.startsWith("unstable_")?delete t[i]:Tr(a)&&(t[i]={...a},e(t[i]))}var n}(t),`import { unstable_createBreakpoints as createBreakpoints, createTransitions } from '@mui/material/styles';\n\nconst theme = ${JSON.stringify(t,null,2)};\n\ntheme.breakpoints = createBreakpoints(theme.breakpoints || {});\ntheme.transitions = createTransitions(theme.transitions || {});\n\nexport default theme;`}var ti=function(e={},...t){const{breakpoints:r,mixins:n={},spacing:o,palette:i={},transitions:a={},typography:s={},shape:c,...l}=e;if(e.vars&&void 0===e.generateThemeVars)throw new Error(Ar(20));const u=Ho(i),d=On(e);let h=Er(d,{mixins:(p=d.breakpoints,f=n,{toolbar:{minHeight:56,[p.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[p.up("sm")]:{minHeight:64}},...f}),palette:u,shadows:Go.slice(),typography:Ko(u,s),transitions:Xo(a),zIndex:{...Zo}});var p,f;return h=Er(h,l),h=t.reduce(((e,t)=>Er(e,t)),h),h.unstable_sxConfig={...Sn,...l?.unstable_sxConfig},h.unstable_sx=function(e){return In({sx:e,theme:this})},h.toRuntimeSource=ei,h};function ri(e){let t;return t=e<1?5.11916*e**2:4.5*Math.log(e+1)+2,Math.round(10*t)/1e3}const ni=[...Array(25)].map(((e,t)=>{if(0===t)return"none";const r=ri(t);return`linear-gradient(rgba(255 255 255 / ${r}), rgba(255 255 255 / ${r}))`}));function oi(e){return{inputPlaceholder:"dark"===e?.5:.42,inputUnderline:"dark"===e?.7:.42,switchTrackDisabled:"dark"===e?.2:.12,switchTrack:"dark"===e?.3:.38}}function ii(e){return"dark"===e?ni:[]}function ai(e){return!!e[0].match(/(cssVarPrefix|colorSchemeSelector|rootSelector|typography|mixins|breakpoints|direction|transitions)/)||!!e[0].match(/sxConfig$/)||"palette"===e[0]&&!!e[1]?.match(/(mode|contrastThreshold|tonalOffset)/)}var si=e=>(t,r)=>{const n=e.rootSelector||":root",o=e.colorSchemeSelector;let i=o;if("class"===o&&(i=".%s"),"data"===o&&(i="[data-%s]"),o?.startsWith("data-")&&!o.includes("%s")&&(i=`[${o}="%s"]`),e.defaultColorScheme===t){if("dark"===t){const o={};return(a=e.cssVarPrefix,[...[...Array(25)].map(((e,t)=>`--${a?`${a}-`:""}overlays-${t}`)),`--${a?`${a}-`:""}palette-AppBar-darkBg`,`--${a?`${a}-`:""}palette-AppBar-darkColor`]).forEach((e=>{o[e]=r[e],delete r[e]})),"media"===i?{[n]:r,"@media (prefers-color-scheme: dark)":{[n]:o}}:i?{[i.replace("%s",t)]:o,[`${n}, ${i.replace("%s",t)}`]:r}:{[n]:{...r,...o}}}if(i&&"media"!==i)return`${n}, ${i.replace("%s",String(t))}`}else if(t){if("media"===i)return{[`@media (prefers-color-scheme: ${String(t)})`]:{[n]:r}};if(i)return i.replace("%s",String(t))}var a;return n};function ci(e,t,r){!e[t]&&r&&(e[t]=r)}function li(e){return"string"==typeof e&&e.startsWith("hsl")?jn(e):e}function ui(e,t){`${t}Channel`in e||(e[`${t}Channel`]=Fn(li(e[t])))}const di=e=>{try{return e()}catch(e){}};function hi(e,t,r,n){if(!t)return;t=!0===t?{}:t;const o="dark"===n?"dark":"light";if(!r)return void(e[n]=function(e){const{palette:t={mode:"light"},opacity:r,overlays:n,...o}=e,i=Ho(t);return{palette:i,opacity:{...oi(i.mode),...r},overlays:n||ii(i.mode),...o}}({...t,palette:{mode:o,...t?.palette}}));const{palette:i,...a}=ti({...r,palette:{mode:o,...t?.palette}});return e[n]={...t,palette:i,opacity:{...oi(o),...t?.opacity},overlays:t?.overlays||ii(o)},a}function pi(e={},...t){const{colorSchemes:r={light:!0},defaultColorScheme:n,disableCssColorScheme:o=!1,cssVarPrefix:i="mui",shouldSkipGeneratingVar:a=ai,colorSchemeSelector:s=(r.light&&r.dark?"media":void 0),rootSelector:c=":root",...l}=e,u=Object.keys(r)[0],d=n||(r.light&&"light"!==u?"light":u),h=((e="mui")=>$o(e))(i),{[d]:p,light:f,dark:g,...m}=r,y={...m};let v=p;if(("dark"===d&&!("dark"in r)||"light"===d&&!("light"in r))&&(v=!0),!v)throw new Error(Ar(21,d));const b=hi(y,v,l,d);f&&!y.light&&hi(y,f,void 0,"light"),g&&!y.dark&&hi(y,g,void 0,"dark");let w={defaultColorScheme:d,...b,cssVarPrefix:i,colorSchemeSelector:s,rootSelector:c,getCssVar:h,colorSchemes:y,font:{...Do(b.typography),...b.font},spacing:(C=l.spacing,"number"==typeof C?`${C}px`:"string"==typeof C||"function"==typeof C||Array.isArray(C)?C:"8px")};var C;Object.keys(w.colorSchemes).forEach((e=>{const t=w.colorSchemes[e].palette,r=e=>{const r=e.split("-"),n=r[1],o=r[2];return h(e,t[n][o])};var n;if("light"===t.mode&&(ci(t.common,"background","#fff"),ci(t.common,"onBackground","#000")),"dark"===t.mode&&(ci(t.common,"background","#000"),ci(t.common,"onBackground","#fff")),n=t,["Alert","AppBar","Avatar","Button","Chip","FilledInput","LinearProgress","Skeleton","Slider","SnackbarContent","SpeedDialAction","StepConnector","StepContent","Switch","TableCell","Tooltip"].forEach((e=>{n[e]||(n[e]={})})),"light"===t.mode){ci(t.Alert,"errorColor",Vn(t.error.light,.6)),ci(t.Alert,"infoColor",Vn(t.info.light,.6)),ci(t.Alert,"successColor",Vn(t.success.light,.6)),ci(t.Alert,"warningColor",Vn(t.warning.light,.6)),ci(t.Alert,"errorFilledBg",r("palette-error-main")),ci(t.Alert,"infoFilledBg",r("palette-info-main")),ci(t.Alert,"successFilledBg",r("palette-success-main")),ci(t.Alert,"warningFilledBg",r("palette-warning-main")),ci(t.Alert,"errorFilledColor",di((()=>t.getContrastText(t.error.main)))),ci(t.Alert,"infoFilledColor",di((()=>t.getContrastText(t.info.main)))),ci(t.Alert,"successFilledColor",di((()=>t.getContrastText(t.success.main)))),ci(t.Alert,"warningFilledColor",di((()=>t.getContrastText(t.warning.main)))),ci(t.Alert,"errorStandardBg",Qn(t.error.light,.9)),ci(t.Alert,"infoStandardBg",Qn(t.info.light,.9)),ci(t.Alert,"successStandardBg",Qn(t.success.light,.9)),ci(t.Alert,"warningStandardBg",Qn(t.warning.light,.9)),ci(t.Alert,"errorIconColor",r("palette-error-main")),ci(t.Alert,"infoIconColor",r("palette-info-main")),ci(t.Alert,"successIconColor",r("palette-success-main")),ci(t.Alert,"warningIconColor",r("palette-warning-main")),ci(t.AppBar,"defaultBg",r("palette-grey-100")),ci(t.Avatar,"defaultBg",r("palette-grey-400")),ci(t.Button,"inheritContainedBg",r("palette-grey-300")),ci(t.Button,"inheritContainedHoverBg",r("palette-grey-A100")),ci(t.Chip,"defaultBorder",r("palette-grey-400")),ci(t.Chip,"defaultAvatarColor",r("palette-grey-700")),ci(t.Chip,"defaultIconColor",r("palette-grey-700")),ci(t.FilledInput,"bg","rgba(0, 0, 0, 0.06)"),ci(t.FilledInput,"hoverBg","rgba(0, 0, 0, 0.09)"),ci(t.FilledInput,"disabledBg","rgba(0, 0, 0, 0.12)"),ci(t.LinearProgress,"primaryBg",Qn(t.primary.main,.62)),ci(t.LinearProgress,"secondaryBg",Qn(t.secondary.main,.62)),ci(t.LinearProgress,"errorBg",Qn(t.error.main,.62)),ci(t.LinearProgress,"infoBg",Qn(t.info.main,.62)),ci(t.LinearProgress,"successBg",Qn(t.success.main,.62)),ci(t.LinearProgress,"warningBg",Qn(t.warning.main,.62)),ci(t.Skeleton,"bg",`rgba(${r("palette-text-primaryChannel")} / 0.11)`),ci(t.Slider,"primaryTrack",Qn(t.primary.main,.62)),ci(t.Slider,"secondaryTrack",Qn(t.secondary.main,.62)),ci(t.Slider,"errorTrack",Qn(t.error.main,.62)),ci(t.Slider,"infoTrack",Qn(t.info.main,.62)),ci(t.Slider,"successTrack",Qn(t.success.main,.62)),ci(t.Slider,"warningTrack",Qn(t.warning.main,.62));const e=Jn(t.background.default,.8);ci(t.SnackbarContent,"bg",e),ci(t.SnackbarContent,"color",di((()=>t.getContrastText(e)))),ci(t.SpeedDialAction,"fabHoverBg",Jn(t.background.paper,.15)),ci(t.StepConnector,"border",r("palette-grey-400")),ci(t.StepContent,"border",r("palette-grey-400")),ci(t.Switch,"defaultColor",r("palette-common-white")),ci(t.Switch,"defaultDisabledColor",r("palette-grey-100")),ci(t.Switch,"primaryDisabledColor",Qn(t.primary.main,.62)),ci(t.Switch,"secondaryDisabledColor",Qn(t.secondary.main,.62)),ci(t.Switch,"errorDisabledColor",Qn(t.error.main,.62)),ci(t.Switch,"infoDisabledColor",Qn(t.info.main,.62)),ci(t.Switch,"successDisabledColor",Qn(t.success.main,.62)),ci(t.Switch,"warningDisabledColor",Qn(t.warning.main,.62)),ci(t.TableCell,"border",Qn(Wn(t.divider,1),.88)),ci(t.Tooltip,"bg",Wn(t.grey[700],.92))}if("dark"===t.mode){ci(t.Alert,"errorColor",Qn(t.error.light,.6)),ci(t.Alert,"infoColor",Qn(t.info.light,.6)),ci(t.Alert,"successColor",Qn(t.success.light,.6)),ci(t.Alert,"warningColor",Qn(t.warning.light,.6)),ci(t.Alert,"errorFilledBg",r("palette-error-dark")),ci(t.Alert,"infoFilledBg",r("palette-info-dark")),ci(t.Alert,"successFilledBg",r("palette-success-dark")),ci(t.Alert,"warningFilledBg",r("palette-warning-dark")),ci(t.Alert,"errorFilledColor",di((()=>t.getContrastText(t.error.dark)))),ci(t.Alert,"infoFilledColor",di((()=>t.getContrastText(t.info.dark)))),ci(t.Alert,"successFilledColor",di((()=>t.getContrastText(t.success.dark)))),ci(t.Alert,"warningFilledColor",di((()=>t.getContrastText(t.warning.dark)))),ci(t.Alert,"errorStandardBg",Vn(t.error.light,.9)),ci(t.Alert,"infoStandardBg",Vn(t.info.light,.9)),ci(t.Alert,"successStandardBg",Vn(t.success.light,.9)),ci(t.Alert,"warningStandardBg",Vn(t.warning.light,.9)),ci(t.Alert,"errorIconColor",r("palette-error-main")),ci(t.Alert,"infoIconColor",r("palette-info-main")),ci(t.Alert,"successIconColor",r("palette-success-main")),ci(t.Alert,"warningIconColor",r("palette-warning-main")),ci(t.AppBar,"defaultBg",r("palette-grey-900")),ci(t.AppBar,"darkBg",r("palette-background-paper")),ci(t.AppBar,"darkColor",r("palette-text-primary")),ci(t.Avatar,"defaultBg",r("palette-grey-600")),ci(t.Button,"inheritContainedBg",r("palette-grey-800")),ci(t.Button,"inheritContainedHoverBg",r("palette-grey-700")),ci(t.Chip,"defaultBorder",r("palette-grey-700")),ci(t.Chip,"defaultAvatarColor",r("palette-grey-300")),ci(t.Chip,"defaultIconColor",r("palette-grey-300")),ci(t.FilledInput,"bg","rgba(255, 255, 255, 0.09)"),ci(t.FilledInput,"hoverBg","rgba(255, 255, 255, 0.13)"),ci(t.FilledInput,"disabledBg","rgba(255, 255, 255, 0.12)"),ci(t.LinearProgress,"primaryBg",Vn(t.primary.main,.5)),ci(t.LinearProgress,"secondaryBg",Vn(t.secondary.main,.5)),ci(t.LinearProgress,"errorBg",Vn(t.error.main,.5)),ci(t.LinearProgress,"infoBg",Vn(t.info.main,.5)),ci(t.LinearProgress,"successBg",Vn(t.success.main,.5)),ci(t.LinearProgress,"warningBg",Vn(t.warning.main,.5)),ci(t.Skeleton,"bg",`rgba(${r("palette-text-primaryChannel")} / 0.13)`),ci(t.Slider,"primaryTrack",Vn(t.primary.main,.5)),ci(t.Slider,"secondaryTrack",Vn(t.secondary.main,.5)),ci(t.Slider,"errorTrack",Vn(t.error.main,.5)),ci(t.Slider,"infoTrack",Vn(t.info.main,.5)),ci(t.Slider,"successTrack",Vn(t.success.main,.5)),ci(t.Slider,"warningTrack",Vn(t.warning.main,.5));const e=Jn(t.background.default,.98);ci(t.SnackbarContent,"bg",e),ci(t.SnackbarContent,"color",di((()=>t.getContrastText(e)))),ci(t.SpeedDialAction,"fabHoverBg",Jn(t.background.paper,.15)),ci(t.StepConnector,"border",r("palette-grey-600")),ci(t.StepContent,"border",r("palette-grey-600")),ci(t.Switch,"defaultColor",r("palette-grey-300")),ci(t.Switch,"defaultDisabledColor",r("palette-grey-600")),ci(t.Switch,"primaryDisabledColor",Vn(t.primary.main,.55)),ci(t.Switch,"secondaryDisabledColor",Vn(t.secondary.main,.55)),ci(t.Switch,"errorDisabledColor",Vn(t.error.main,.55)),ci(t.Switch,"infoDisabledColor",Vn(t.info.main,.55)),ci(t.Switch,"successDisabledColor",Vn(t.success.main,.55)),ci(t.Switch,"warningDisabledColor",Vn(t.warning.main,.55)),ci(t.TableCell,"border",Vn(Wn(t.divider,1),.68)),ci(t.Tooltip,"bg",Wn(t.grey[700],.92))}ui(t.background,"default"),ui(t.background,"paper"),ui(t.common,"background"),ui(t.common,"onBackground"),ui(t,"divider"),Object.keys(t).forEach((e=>{const r=t[e];"tonalOffset"!==e&&r&&"object"==typeof r&&(r.main&&ci(t[e],"mainChannel",Fn(li(r.main))),r.light&&ci(t[e],"lightChannel",Fn(li(r.light))),r.dark&&ci(t[e],"darkChannel",Fn(li(r.dark))),r.contrastText&&ci(t[e],"contrastTextChannel",Fn(li(r.contrastText))),"text"===e&&(ui(t[e],"primary"),ui(t[e],"secondary")),"action"===e&&(r.active&&ui(t[e],"active"),r.selected&&ui(t[e],"selected")))}))})),w=t.reduce(((e,t)=>Er(e,t)),w);const A={prefix:i,disableCssColorScheme:o,shouldSkipGeneratingVar:a,getSelector:si(w)},{vars:k,generateThemeVars:S,generateStyleSheets:T}=function(e,t={}){const{getSelector:r=m,disableCssColorScheme:n,colorSchemeSelector:o}=t,{colorSchemes:i={},components:a,defaultColorScheme:s="light",...c}=e,{vars:l,css:u,varsWithDefaults:d}=Uo(c,t);let h=d;const p={},{[s]:f,...g}=i;if(Object.entries(g||{}).forEach((([e,r])=>{const{vars:n,css:o,varsWithDefaults:i}=Uo(r,t);h=Er(h,i),p[e]={css:o,vars:n}})),f){const{css:e,vars:r,varsWithDefaults:n}=Uo(f,t);h=Er(h,n),p[s]={css:e,vars:r}}function m(t,r){let n=o;if("class"===o&&(n=".%s"),"data"===o&&(n="[data-%s]"),o?.startsWith("data-")&&!o.includes("%s")&&(n=`[${o}="%s"]`),t){if("media"===n){if(e.defaultColorScheme===t)return":root";const n=i[t]?.palette?.mode||t;return{[`@media (prefers-color-scheme: ${n})`]:{":root":r}}}if(n)return e.defaultColorScheme===t?`:root, ${n.replace("%s",String(t))}`:n.replace("%s",String(t))}return":root"}return{vars:h,generateThemeVars:()=>{let e={...l};return Object.entries(p).forEach((([,{vars:t}])=>{e=Er(e,t)})),e},generateStyleSheets:()=>{const t=[],o=e.defaultColorScheme||"light";function a(e,r){Object.keys(r).length&&t.push("string"==typeof e?{[e]:{...r}}:e)}a(r(void 0,{...u}),u);const{[o]:s,...c}=p;if(s){const{css:e}=s,t=i[o]?.palette?.mode,c=!n&&t?{colorScheme:t,...e}:{...e};a(r(o,{...c}),c)}return Object.entries(c).forEach((([e,{css:t}])=>{const o=i[e]?.palette?.mode,s=!n&&o?{colorScheme:o,...t}:{...t};a(r(e,{...s}),s)})),t}}}(w,A);return w.vars=k,Object.entries(w.colorSchemes[w.defaultColorScheme]).forEach((([e,t])=>{w[e]=t})),w.generateThemeVars=S,w.generateStyleSheets=T,w.generateSpacing=function(){return Pn(l.spacing,zr(this))},w.getColorSchemeSelector=function(e){return function(t){return"media"===e?`@media (prefers-color-scheme: ${t})`:e?e.startsWith("data-")&&!e.includes("%s")?`[${e}="${t}"] &`:"class"===e?`.${t} &`:"data"===e?`[data-${t}] &`:`${e.replace("%s",t)} &`:"&"}}(s),w.spacing=w.generateSpacing(),w.shouldSkipGeneratingVar=a,w.unstable_sxConfig={...Sn,...l?.unstable_sxConfig},w.unstable_sx=function(e){return In({sx:e,theme:this})},w.toRuntimeSource=ei,w}function fi(e,t,r){e.colorSchemes&&r&&(e.colorSchemes[t]={...!0!==r&&r,palette:Ho({...!0===r?{}:r.palette,mode:t})})}function gi(e={},...t){const{palette:r,cssVariables:n=!1,colorSchemes:o=(r?void 0:{light:!0}),defaultColorScheme:i=r?.mode,...a}=e,s=i||"light",c=o?.[s],l={...o,...r?{[s]:{..."boolean"!=typeof c&&c,palette:r}}:void 0};if(!1===n){if(!("colorSchemes"in e))return ti(e,...t);let n=r;"palette"in e||l[s]&&(!0!==l[s]?n=l[s].palette:"dark"===s&&(n={mode:"dark"}));const o=ti({...e,palette:n},...t);return o.defaultColorScheme=s,o.colorSchemes=l,"light"===o.palette.mode&&(o.colorSchemes.light={...!0!==l.light&&l.light,palette:o.palette},fi(o,"dark",l.dark)),"dark"===o.palette.mode&&(o.colorSchemes.dark={...!0!==l.dark&&l.dark,palette:o.palette},fi(o,"light",l.light)),o}return r||"light"in l||"light"!==s||(l.light=!0),pi({...a,colorSchemes:l,defaultColorScheme:s,..."boolean"!=typeof n&&n},...t)}var mi="$$material";const yi={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function vi(e,t,r="Mui"){const n=yi[t];return n?`${r}-${n}`:`${Hn.generate(e)}-${t}`}function bi(e,t,r="Mui"){const n={};return t.forEach((t=>{n[t]=vi(e,t,r)})),n}var wi=bi("MuiBox",["root"]);const Ci=gi(),Ai=function(e={}){const{themeId:t,defaultTheme:r,defaultClassName:o="MuiBox-root",generateClassName:i}=e,a=br("div",{shouldForwardProp:e=>"theme"!==e&&"sx"!==e&&"as"!==e})(In);return n.forwardRef((function(e,n){const s=Nn(r),{className:c,component:l="div",...u}=En(e);return(0,Bn.jsx)(a,{as:l,ref:n,className:He(c,i?i(o):o),theme:t&&s[t]||s,...u})}))}({themeId:mi,defaultTheme:Ci,defaultClassName:wi.root,generateClassName:Hn.generate});var ki=Ai;function Si(e,t,r=void 0){const n={};for(const o in e){const i=e[o];let a="",s=!0;for(let e=0;e<i.length;e+=1){const n=i[e];n&&(a+=(!0===s?"":" ")+t(n),s=!1,r&&r[n]&&(a+=" "+r[n]))}n[o]=a}return n}function Ti(e){const{variants:t,...r}=e,n={variants:t,style:Cr(r),isProcessed:!0};return n.style===r||t&&t.forEach((e=>{"function"!=typeof e.style&&(e.style=Cr(e.style))})),n}const Ii=On();function Ei(e){return"ownerState"!==e&&"theme"!==e&&"sx"!==e&&"as"!==e}function xi(e){return e?(t,r)=>r[e]:null}function _i(e,t){const r="function"==typeof t?t(e):t;if(Array.isArray(r))return r.flatMap((t=>_i(e,t)));if(Array.isArray(r?.variants)){let t;if(r.isProcessed)t=r.style;else{const{variants:e,...n}=r;t=n}return Pi(e,r.variants,[t])}return r?.isProcessed?r.style:r}function Pi(e,t,r=[]){let n;e:for(let o=0;o<t.length;o+=1){const i=t[o];if("function"==typeof i.props){if(n??={...e,...e.ownerState,ownerState:e.ownerState},!i.props(n))continue}else for(const t in i.props)if(e[t]!==i.props[t]&&e.ownerState?.[t]!==i.props[t])continue e;"function"==typeof i.style?(n??={...e,...e.ownerState,ownerState:e.ownerState},r.push(i.style(n))):r.push(i.style)}return r}function Ri(e){return e?e.charAt(0).toLowerCase()+e.slice(1):e}var Oi=gi(),Mi=e=>function(e){return"ownerState"!==e&&"theme"!==e&&"sx"!==e&&"as"!==e}(e)&&"classes"!==e;const Ni=function(e={}){const{themeId:t,defaultTheme:r=Ii,rootShouldForwardProp:n=Ei,slotShouldForwardProp:o=Ei}=e;function i(e){!function(e,t,r){e.theme=function(e){for(const t in e)return!1;return!0}(e.theme)?r:e.theme[t]||e.theme}(e,t,r)}return(e,t={})=>{!function(e){Array.isArray(e.__emotion_styles)&&(e.__emotion_styles=(e=>e.filter((e=>e!==In)))(e.__emotion_styles))}(e);const{name:r,slot:a,skipVariantsResolver:s,skipSx:c,overridesResolver:l=xi(Ri(a)),...u}=t,d=void 0!==s?s:a&&"Root"!==a&&"root"!==a||!1,h=c||!1;let p=Ei;"Root"===a||"root"===a?p=n:a?p=o:function(e){return"string"==typeof e&&e.charCodeAt(0)>96}(e)&&(p=void 0);const f=br(e,{shouldForwardProp:p,label:void 0,...u}),g=e=>{if("function"==typeof e&&e.__emotion_real!==e)return function(t){return _i(t,e)};if(Tr(e)){const t=Ti(e);return t.variants?function(e){return _i(e,t)}:t.style}return e},m=(...t)=>{const n=[],o=t.map(g),a=[];if(n.push(i),r&&l&&a.push((function(e){const t=e.theme,n=t.components?.[r]?.styleOverrides;if(!n)return null;const o={};for(const t in n)o[t]=_i(e,n[t]);return l(e,o)})),r&&!d&&a.push((function(e){const t=e.theme,n=t?.components?.[r]?.variants;return n?Pi(e,n):null})),h||a.push(In),Array.isArray(o[0])){const e=o.shift(),t=new Array(n.length).fill(""),r=new Array(a.length).fill("");let i;i=[...t,...e,...r],i.raw=[...t,...e.raw,...r],n.unshift(i)}const s=[...n,...o,...a],c=f(...s);return e.muiName&&(c.muiName=e.muiName),c};return f.withConfig&&(m.withConfig=f.withConfig),m}}({themeId:mi,defaultTheme:Oi,rootShouldForwardProp:Mi});var Bi=Ni;function Li(e,t){const r={...t};for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)){const o=n;if("components"===o||"slots"===o)r[o]={...e[o],...r[o]};else if("componentsProps"===o||"slotProps"===o){const n=e[o],i=t[o];if(i)if(n){r[o]={...i};for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e)){const t=e;r[o][t]=Li(n[t],i[t])}}else r[o]=i;else r[o]=n||{}}else void 0===r[o]&&(r[o]=e[o])}return r}const qi=n.createContext(void 0);function Hi(e){return function({props:e,name:t}){return function(e){const{theme:t,name:r,props:n}=e;if(!t||!t.components||!t.components[r])return n;const o=t.components[r];return o.defaultProps?Li(o.defaultProps,n):o.styleOverrides||o.variants?n:Li(o,n)}({props:e,name:t,theme:{components:n.useContext(qi)}})}(e)}function $i(){const e=Nn(Oi);return e[mi]||e}const Di={theme:void 0};var Fi=function(e){let t,r;return function(n){let o=t;return void 0!==o&&n.theme===r||(Di.theme=n.theme,o=Ti(e(Di)),t=o,r=n.theme),o}};function Ui(e){return vi("MuiPaper",e)}bi("MuiPaper",["root","rounded","outlined","elevation","elevation0","elevation1","elevation2","elevation3","elevation4","elevation5","elevation6","elevation7","elevation8","elevation9","elevation10","elevation11","elevation12","elevation13","elevation14","elevation15","elevation16","elevation17","elevation18","elevation19","elevation20","elevation21","elevation22","elevation23","elevation24"]);const ji=Bi("div",{name:"MuiPaper",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,t[r.variant],!r.square&&t.rounded,"elevation"===r.variant&&t[`elevation${r.elevation}`]]}})(Fi((({theme:e})=>({backgroundColor:(e.vars||e).palette.background.paper,color:(e.vars||e).palette.text.primary,transition:e.transitions.create("box-shadow"),variants:[{props:({ownerState:e})=>!e.square,style:{borderRadius:e.shape.borderRadius}},{props:{variant:"outlined"},style:{border:`1px solid ${(e.vars||e).palette.divider}`}},{props:{variant:"elevation"},style:{boxShadow:"var(--Paper-shadow)",backgroundImage:"var(--Paper-overlay)"}}]}))));var zi=n.forwardRef((function(e,t){const r=Hi({props:e,name:"MuiPaper"}),n=$i(),{className:o,component:i="div",elevation:a=1,square:s=!1,variant:c="elevation",...l}=r,u={...r,component:i,elevation:a,square:s,variant:c},d=(e=>{const{square:t,elevation:r,variant:n,classes:o}=e;return Si({root:["root",n,!t&&"rounded","elevation"===n&&`elevation${r}`]},Ui,o)})(u);return(0,Bn.jsx)(ji,{as:i,ownerState:u,className:He(d.root,o),ref:t,...l,style:{..."elevation"===c&&{"--Paper-shadow":(n.vars||n).shadows[a],...n.vars&&{"--Paper-overlay":n.vars.overlays?.[a]},...!n.vars&&"dark"===n.palette.mode&&{"--Paper-overlay":`linear-gradient(${Kn("#fff",ri(a))}, ${Kn("#fff",ri(a))})`}},...l.style}})}));function Ki(e){return vi("MuiCard",e)}bi("MuiCard",["root"]);const Wi=Bi(zi,{name:"MuiCard",slot:"Root"})({overflow:"hidden"});var Gi=n.forwardRef((function(e,t){const r=Hi({props:e,name:"MuiCard"}),{className:n,raised:o=!1,...i}=r,a={...r,raised:o},s=(e=>{const{classes:t}=e;return Si({root:["root"]},Ki,t)})(a);return(0,Bn.jsx)(Wi,{className:He(s.root,n),elevation:o?8:void 0,ref:t,ownerState:a,...i})}));function Vi(e){return vi("MuiCardContent",e)}bi("MuiCardContent",["root"]);const Yi=Bi("div",{name:"MuiCardContent",slot:"Root"})({padding:16,"&:last-child":{paddingBottom:24}});var Qi=n.forwardRef((function(e,t){const r=Hi({props:e,name:"MuiCardContent"}),{className:n,component:o="div",...i}=r,a={...r,component:o},s=(e=>{const{classes:t}=e;return Si({root:["root"]},Vi,t)})(a);return(0,Bn.jsx)(Yi,{as:o,className:He(s.root,n),ownerState:a,ref:t,...i})})),Ji=kr;function Xi(e=[]){return([,t])=>t&&function(e,t=[]){if(!function(e){return"string"==typeof e.main}(e))return!1;for(const r of t)if(!e.hasOwnProperty(r)||"string"!=typeof e[r])return!1;return!0}(t,e)}function Zi(e){return vi("MuiTypography",e)}bi("MuiTypography",["root","h1","h2","h3","h4","h5","h6","subtitle1","subtitle2","body1","body2","inherit","button","caption","overline","alignLeft","alignRight","alignCenter","alignJustify","noWrap","gutterBottom","paragraph"]);const ea={primary:!0,secondary:!0,error:!0,info:!0,success:!0,warning:!0,textPrimary:!0,textSecondary:!0,textDisabled:!0},ta=En,ra=Bi("span",{name:"MuiTypography",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,r.variant&&t[r.variant],"inherit"!==r.align&&t[`align${Ji(r.align)}`],r.noWrap&&t.noWrap,r.gutterBottom&&t.gutterBottom,r.paragraph&&t.paragraph]}})(Fi((({theme:e})=>({margin:0,variants:[{props:{variant:"inherit"},style:{font:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}},...Object.entries(e.typography).filter((([e,t])=>"inherit"!==e&&t&&"object"==typeof t)).map((([e,t])=>({props:{variant:e},style:t}))),...Object.entries(e.palette).filter(Xi()).map((([t])=>({props:{color:t},style:{color:(e.vars||e).palette[t].main}}))),...Object.entries(e.palette?.text||{}).filter((([,e])=>"string"==typeof e)).map((([t])=>({props:{color:`text${Ji(t)}`},style:{color:(e.vars||e).palette.text[t]}}))),{props:({ownerState:e})=>"inherit"!==e.align,style:{textAlign:"var(--Typography-textAlign)"}},{props:({ownerState:e})=>e.noWrap,style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}},{props:({ownerState:e})=>e.gutterBottom,style:{marginBottom:"0.35em"}},{props:({ownerState:e})=>e.paragraph,style:{marginBottom:16}}]})))),na={h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",subtitle1:"h6",subtitle2:"h6",body1:"p",body2:"p",inherit:"p"};var oa=n.forwardRef((function(e,t){const{color:r,...n}=Hi({props:e,name:"MuiTypography"}),o=ta({...n,...!ea[r]&&{color:r}}),{align:i="inherit",className:a,component:s,gutterBottom:c=!1,noWrap:l=!1,paragraph:u=!1,variant:d="body1",variantMapping:h=na,...p}=o,f={...o,align:i,color:r,className:a,component:s,gutterBottom:c,noWrap:l,paragraph:u,variant:d,variantMapping:h},g=s||(u?"p":h[d]||na[d])||"span",m=(e=>{const{align:t,gutterBottom:r,noWrap:n,paragraph:o,variant:i,classes:a}=e;return Si({root:["root",i,"inherit"!==e.align&&`align${Ji(t)}`,r&&"gutterBottom",n&&"noWrap",o&&"paragraph"]},Zi,a)})(f);return(0,Bn.jsx)(ra,{as:g,ref:t,className:He(m.root,a),...p,ownerState:f,style:{..."inherit"!==i&&{"--Typography-textAlign":i},...p.style}})}));let ia=0;const aa={...o}.useId;var sa=function(e){if(void 0!==aa){const t=aa();return e??t}return function(e){const[t,r]=n.useState(e),o=e||t;return n.useEffect((()=>{null==t&&(ia+=1,r(`mui-${ia}`))}),[t]),o}(e)};function ca(e){try{return e.matches(":focus-visible")}catch(e){}return!1}function la(...e){const t=n.useRef(void 0),r=n.useCallback((t=>{const r=e.map((e=>{if(null==e)return null;if("function"==typeof e){const r=e,n=r(t);return"function"==typeof n?n:()=>{r(null)}}return e.current=t,()=>{e.current=null}}));return()=>{r.forEach((e=>e?.()))}}),e);return n.useMemo((()=>e.every((e=>null==e))?null:e=>{t.current&&(t.current(),t.current=void 0),null!=e&&(t.current=r(e))}),e)}var ua=la,da="undefined"!=typeof window?n.useLayoutEffect:n.useEffect,ha=function(e){const t=n.useRef(e);return da((()=>{t.current=e})),n.useRef(((...e)=>(0,t.current)(...e))).current};const pa={};function fa(e,t){const r=n.useRef(pa);return r.current===pa&&(r.current=e(t)),r}var ga=r(64583).Promise;class ma{static create(){return new ma}static use(){const e=fa(ma.create).current,[t,r]=n.useState(!1);return e.shouldMount=t,e.setShouldMount=r,n.useEffect(e.mountEffect,[t]),e}constructor(){this.ref={current:null},this.mounted=null,this.didMount=!1,this.shouldMount=!1,this.setShouldMount=null}mount(){return this.mounted||(this.mounted=function(){let e,t;const r=new ga(((r,n)=>{e=r,t=n}));return r.resolve=e,r.reject=t,r}(),this.shouldMount=!0,this.setShouldMount(this.shouldMount)),this.mounted}mountEffect=()=>{this.shouldMount&&!this.didMount&&null!==this.ref.current&&(this.didMount=!0,this.mounted.resolve())};start(...e){this.mount().then((()=>this.ref.current?.start(...e)))}stop(...e){this.mount().then((()=>this.ref.current?.stop(...e)))}pulsate(...e){this.mount().then((()=>this.ref.current?.pulsate(...e)))}}function ya(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}function va(e,t){return va=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},va(e,t)}function ba(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,va(e,t)}var wa=n.createContext(null);function Ca(e,t){var r=Object.create(null);return e&&n.Children.map(e,(function(e){return e})).forEach((function(e){r[e.key]=function(e){return t&&(0,n.isValidElement)(e)?t(e):e}(e)})),r}function Aa(e,t,r){return null!=r[t]?r[t]:e.props[t]}function ka(e,t,r){var o=Ca(e.children),i=function(e,t){function r(r){return r in t?t[r]:e[r]}e=e||{},t=t||{};var n,o=Object.create(null),i=[];for(var a in e)a in t?i.length&&(o[a]=i,i=[]):i.push(a);var s={};for(var c in t){if(o[c])for(n=0;n<o[c].length;n++){var l=o[c][n];s[o[c][n]]=r(l)}s[c]=r(c)}for(n=0;n<i.length;n++)s[i[n]]=r(i[n]);return s}(t,o);return Object.keys(i).forEach((function(a){var s=i[a];if((0,n.isValidElement)(s)){var c=a in t,l=a in o,u=t[a],d=(0,n.isValidElement)(u)&&!u.props.in;!l||c&&!d?l||!c||d?l&&c&&(0,n.isValidElement)(u)&&(i[a]=(0,n.cloneElement)(s,{onExited:r.bind(null,s),in:u.props.in,exit:Aa(s,"exit",e),enter:Aa(s,"enter",e)})):i[a]=(0,n.cloneElement)(s,{in:!1}):i[a]=(0,n.cloneElement)(s,{onExited:r.bind(null,s),in:!0,exit:Aa(s,"exit",e),enter:Aa(s,"enter",e)})}})),i}var Sa=Object.values||function(e){return Object.keys(e).map((function(t){return e[t]}))},Ta=function(e){function t(t,r){var n,o=(n=e.call(this,t,r)||this).handleExited.bind(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(n));return n.state={contextValue:{isMounting:!0},handleExited:o,firstRender:!0},n}ba(t,e);var r=t.prototype;return r.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},r.componentWillUnmount=function(){this.mounted=!1},t.getDerivedStateFromProps=function(e,t){var r,o,i=t.children,a=t.handleExited;return{children:t.firstRender?(r=e,o=a,Ca(r.children,(function(e){return(0,n.cloneElement)(e,{onExited:o.bind(null,e),in:!0,appear:Aa(e,"appear",r),enter:Aa(e,"enter",r),exit:Aa(e,"exit",r)})}))):ka(e,i,a),firstRender:!1}},r.handleExited=function(e,t){var r=Ca(this.props.children);e.key in r||(e.props.onExited&&e.props.onExited(t),this.mounted&&this.setState((function(t){var r=$e({},t.children);return delete r[e.key],{children:r}})))},r.render=function(){var e=this.props,t=e.component,r=e.childFactory,o=ya(e,["component","childFactory"]),i=this.state.contextValue,a=Sa(this.state.children).map(r);return delete o.appear,delete o.enter,delete o.exit,null===t?n.createElement(wa.Provider,{value:i},a):n.createElement(wa.Provider,{value:i},n.createElement(t,o,a))},t}(n.Component);Ta.propTypes={},Ta.defaultProps={component:"div",childFactory:function(e){return e}};var Ia=Ta;const Ea=[];class xa{static create(){return new xa}currentId=null;start(e,t){this.clear(),this.currentId=setTimeout((()=>{this.currentId=null,t()}),e)}clear=()=>{null!==this.currentId&&(clearTimeout(this.currentId),this.currentId=null)};disposeEffect=()=>this.clear}function _a(){const e=fa(xa.create).current;var t;return t=e.disposeEffect,n.useEffect(t,Ea),e}r(4146);var Pa,Ra,Oa=function(e,t){var r=arguments;if(null==t||!cr.call(t,"css"))return n.createElement.apply(void 0,r);var o=r.length,i=new Array(o);i[0]=dr,i[1]=function(e,t){var r={};for(var n in t)cr.call(t,n)&&(r[n]=t[n]);return r[lr]=e,r}(e,t);for(var a=2;a<o;a++)i[a]=r[a];return n.createElement.apply(null,i)};function Ma(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return rr(t)}function Na(){var e=Ma.apply(void 0,arguments),t="animation-"+e.name;return{name:t,styles:"@keyframes "+t+"{"+e.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}Pa=Oa||(Oa={}),Ra||(Ra=Pa.JSX||(Pa.JSX={}));var Ba=bi("MuiTouchRipple",["root","ripple","rippleVisible","ripplePulsate","child","childLeaving","childPulsate"]);const La=Na`
  0% {
    transform: scale(0);
    opacity: 0.1;
  }

  100% {
    transform: scale(1);
    opacity: 0.3;
  }
`,qa=Na`
  0% {
    opacity: 1;
  }

  100% {
    opacity: 0;
  }
`,Ha=Na`
  0% {
    transform: scale(1);
  }

  50% {
    transform: scale(0.92);
  }

  100% {
    transform: scale(1);
  }
`,$a=Bi("span",{name:"MuiTouchRipple",slot:"Root"})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"}),Da=Bi((function(e){const{className:t,classes:r,pulsate:o=!1,rippleX:i,rippleY:a,rippleSize:s,in:c,onExited:l,timeout:u}=e,[d,h]=n.useState(!1),p=He(t,r.ripple,r.rippleVisible,o&&r.ripplePulsate),f={width:s,height:s,top:-s/2+a,left:-s/2+i},g=He(r.child,d&&r.childLeaving,o&&r.childPulsate);return c||d||h(!0),n.useEffect((()=>{if(!c&&null!=l){const e=setTimeout(l,u);return()=>{clearTimeout(e)}}}),[l,c,u]),(0,Bn.jsx)("span",{className:p,style:f,children:(0,Bn.jsx)("span",{className:g})})}),{name:"MuiTouchRipple",slot:"Ripple"})`
  opacity: 0;
  position: absolute;

  &.${Ba.rippleVisible} {
    opacity: 0.3;
    transform: scale(1);
    animation-name: ${La};
    animation-duration: ${550}ms;
    animation-timing-function: ${({theme:e})=>e.transitions.easing.easeInOut};
  }

  &.${Ba.ripplePulsate} {
    animation-duration: ${({theme:e})=>e.transitions.duration.shorter}ms;
  }

  & .${Ba.child} {
    opacity: 1;
    display: block;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background-color: currentColor;
  }

  & .${Ba.childLeaving} {
    opacity: 0;
    animation-name: ${qa};
    animation-duration: ${550}ms;
    animation-timing-function: ${({theme:e})=>e.transitions.easing.easeInOut};
  }

  & .${Ba.childPulsate} {
    position: absolute;
    /* @noflip */
    left: 0px;
    top: 0;
    animation-name: ${Ha};
    animation-duration: 2500ms;
    animation-timing-function: ${({theme:e})=>e.transitions.easing.easeInOut};
    animation-iteration-count: infinite;
    animation-delay: 200ms;
  }
`,Fa=n.forwardRef((function(e,t){const r=Hi({props:e,name:"MuiTouchRipple"}),{center:o=!1,classes:i={},className:a,...s}=r,[c,l]=n.useState([]),u=n.useRef(0),d=n.useRef(null);n.useEffect((()=>{d.current&&(d.current(),d.current=null)}),[c]);const h=n.useRef(!1),p=_a(),f=n.useRef(null),g=n.useRef(null),m=n.useCallback((e=>{const{pulsate:t,rippleX:r,rippleY:n,rippleSize:o,cb:a}=e;l((e=>[...e,(0,Bn.jsx)(Da,{classes:{ripple:He(i.ripple,Ba.ripple),rippleVisible:He(i.rippleVisible,Ba.rippleVisible),ripplePulsate:He(i.ripplePulsate,Ba.ripplePulsate),child:He(i.child,Ba.child),childLeaving:He(i.childLeaving,Ba.childLeaving),childPulsate:He(i.childPulsate,Ba.childPulsate)},timeout:550,pulsate:t,rippleX:r,rippleY:n,rippleSize:o},u.current)])),u.current+=1,d.current=a}),[i]),y=n.useCallback(((e={},t={},r=()=>{})=>{const{pulsate:n=!1,center:i=o||t.pulsate,fakeElement:a=!1}=t;if("mousedown"===e?.type&&h.current)return void(h.current=!1);"touchstart"===e?.type&&(h.current=!0);const s=a?null:g.current,c=s?s.getBoundingClientRect():{width:0,height:0,left:0,top:0};let l,u,d;if(i||void 0===e||0===e.clientX&&0===e.clientY||!e.clientX&&!e.touches)l=Math.round(c.width/2),u=Math.round(c.height/2);else{const{clientX:t,clientY:r}=e.touches&&e.touches.length>0?e.touches[0]:e;l=Math.round(t-c.left),u=Math.round(r-c.top)}if(i)d=Math.sqrt((2*c.width**2+c.height**2)/3),d%2==0&&(d+=1);else{const e=2*Math.max(Math.abs((s?s.clientWidth:0)-l),l)+2,t=2*Math.max(Math.abs((s?s.clientHeight:0)-u),u)+2;d=Math.sqrt(e**2+t**2)}e?.touches?null===f.current&&(f.current=()=>{m({pulsate:n,rippleX:l,rippleY:u,rippleSize:d,cb:r})},p.start(80,(()=>{f.current&&(f.current(),f.current=null)}))):m({pulsate:n,rippleX:l,rippleY:u,rippleSize:d,cb:r})}),[o,m,p]),v=n.useCallback((()=>{y({},{pulsate:!0})}),[y]),b=n.useCallback(((e,t)=>{if(p.clear(),"touchend"===e?.type&&f.current)return f.current(),f.current=null,void p.start(0,(()=>{b(e,t)}));f.current=null,l((e=>e.length>0?e.slice(1):e)),d.current=t}),[p]);return n.useImperativeHandle(t,(()=>({pulsate:v,start:y,stop:b})),[v,y,b]),(0,Bn.jsx)($a,{className:He(Ba.root,i.root,a),ref:g,...s,children:(0,Bn.jsx)(Ia,{component:null,exit:!0,children:c})})}));var Ua=Fa;function ja(e){return vi("MuiButtonBase",e)}var za=bi("MuiButtonBase",["root","disabled","focusVisible"]);const Ka=Bi("button",{name:"MuiButtonBase",slot:"Root"})({display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"},[`&.${za.disabled}`]:{pointerEvents:"none",cursor:"default"},"@media print":{colorAdjust:"exact"}});function Wa(e,t,r,n=!1){return ha((o=>(r&&r(o),n||e[t](o),!0)))}var Ga=n.forwardRef((function(e,t){const r=Hi({props:e,name:"MuiButtonBase"}),{action:o,centerRipple:i=!1,children:a,className:s,component:c="button",disabled:l=!1,disableRipple:u=!1,disableTouchRipple:d=!1,focusRipple:h=!1,focusVisibleClassName:p,LinkComponent:f="a",onBlur:g,onClick:m,onContextMenu:y,onDragLeave:v,onFocus:b,onFocusVisible:w,onKeyDown:C,onKeyUp:A,onMouseDown:k,onMouseLeave:S,onMouseUp:T,onTouchEnd:I,onTouchMove:E,onTouchStart:x,tabIndex:_=0,TouchRippleProps:P,touchRippleRef:R,type:O,...M}=r,N=n.useRef(null),B=ma.use(),L=ua(B.ref,R),[q,H]=n.useState(!1);l&&q&&H(!1),n.useImperativeHandle(o,(()=>({focusVisible:()=>{H(!0),N.current.focus()}})),[]);const $=B.shouldMount&&!u&&!l;n.useEffect((()=>{q&&h&&!u&&B.pulsate()}),[u,h,q,B]);const D=Wa(B,"start",k,d),F=Wa(B,"stop",y,d),U=Wa(B,"stop",v,d),j=Wa(B,"stop",T,d),z=Wa(B,"stop",(e=>{q&&e.preventDefault(),S&&S(e)}),d),K=Wa(B,"start",x,d),W=Wa(B,"stop",I,d),G=Wa(B,"stop",E,d),V=Wa(B,"stop",(e=>{ca(e.target)||H(!1),g&&g(e)}),!1),Y=ha((e=>{N.current||(N.current=e.currentTarget),ca(e.target)&&(H(!0),w&&w(e)),b&&b(e)})),Q=()=>{const e=N.current;return c&&"button"!==c&&!("A"===e.tagName&&e.href)},J=ha((e=>{h&&!e.repeat&&q&&" "===e.key&&B.stop(e,(()=>{B.start(e)})),e.target===e.currentTarget&&Q()&&" "===e.key&&e.preventDefault(),C&&C(e),e.target===e.currentTarget&&Q()&&"Enter"===e.key&&!l&&(e.preventDefault(),m&&m(e))})),X=ha((e=>{h&&" "===e.key&&q&&!e.defaultPrevented&&B.stop(e,(()=>{B.pulsate(e)})),A&&A(e),m&&e.target===e.currentTarget&&Q()&&" "===e.key&&!e.defaultPrevented&&m(e)}));let Z=c;"button"===Z&&(M.href||M.to)&&(Z=f);const ee={};"button"===Z?(ee.type=void 0===O?"button":O,ee.disabled=l):(M.href||M.to||(ee.role="button"),l&&(ee["aria-disabled"]=l));const te=ua(t,N),re={...r,centerRipple:i,component:c,disabled:l,disableRipple:u,disableTouchRipple:d,focusRipple:h,tabIndex:_,focusVisible:q},ne=(e=>{const{disabled:t,focusVisible:r,focusVisibleClassName:n,classes:o}=e,i=Si({root:["root",t&&"disabled",r&&"focusVisible"]},ja,o);return r&&n&&(i.root+=` ${n}`),i})(re);return(0,Bn.jsxs)(Ka,{as:Z,className:He(ne.root,s),ownerState:re,onBlur:V,onClick:m,onContextMenu:F,onFocus:Y,onKeyDown:J,onKeyUp:X,onMouseDown:D,onMouseLeave:z,onMouseUp:j,onDragLeave:U,onTouchEnd:W,onTouchMove:G,onTouchStart:K,ref:te,tabIndex:l?-1:_,type:O,...ee,...M,children:[a,$?(0,Bn.jsx)(Ua,{ref:L,center:i,...P}):null]})}));function Va(e){return vi("MuiCircularProgress",e)}bi("MuiCircularProgress",["root","determinate","indeterminate","colorPrimary","colorSecondary","svg","circle","circleDeterminate","circleIndeterminate","circleDisableShrink"]);const Ya=Na`
  0% {
    transform: rotate(0deg);
  }

  100% {
    transform: rotate(360deg);
  }
`,Qa=Na`
  0% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: 0;
  }

  50% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -15px;
  }

  100% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: -126px;
  }
`,Ja="string"!=typeof Ya?Ma`
        animation: ${Ya} 1.4s linear infinite;
      `:null,Xa="string"!=typeof Qa?Ma`
        animation: ${Qa} 1.4s ease-in-out infinite;
      `:null,Za=Bi("span",{name:"MuiCircularProgress",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,t[r.variant],t[`color${Ji(r.color)}`]]}})(Fi((({theme:e})=>({display:"inline-block",variants:[{props:{variant:"determinate"},style:{transition:e.transitions.create("transform")}},{props:{variant:"indeterminate"},style:Ja||{animation:`${Ya} 1.4s linear infinite`}},...Object.entries(e.palette).filter(Xi()).map((([t])=>({props:{color:t},style:{color:(e.vars||e).palette[t].main}})))]})))),es=Bi("svg",{name:"MuiCircularProgress",slot:"Svg"})({display:"block"}),ts=Bi("circle",{name:"MuiCircularProgress",slot:"Circle",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.circle,t[`circle${Ji(r.variant)}`],r.disableShrink&&t.circleDisableShrink]}})(Fi((({theme:e})=>({stroke:"currentColor",variants:[{props:{variant:"determinate"},style:{transition:e.transitions.create("stroke-dashoffset")}},{props:{variant:"indeterminate"},style:{strokeDasharray:"80px, 200px",strokeDashoffset:0}},{props:({ownerState:e})=>"indeterminate"===e.variant&&!e.disableShrink,style:Xa||{animation:`${Qa} 1.4s ease-in-out infinite`}}]}))));var rs=n.forwardRef((function(e,t){const r=Hi({props:e,name:"MuiCircularProgress"}),{className:n,color:o="primary",disableShrink:i=!1,size:a=40,style:s,thickness:c=3.6,value:l=0,variant:u="indeterminate",...d}=r,h={...r,color:o,disableShrink:i,size:a,thickness:c,value:l,variant:u},p=(e=>{const{classes:t,variant:r,color:n,disableShrink:o}=e;return Si({root:["root",r,`color${Ji(n)}`],svg:["svg"],circle:["circle",`circle${Ji(r)}`,o&&"circleDisableShrink"]},Va,t)})(h),f={},g={},m={};if("determinate"===u){const e=2*Math.PI*((44-c)/2);f.strokeDasharray=e.toFixed(3),m["aria-valuenow"]=Math.round(l),f.strokeDashoffset=`${((100-l)/100*e).toFixed(3)}px`,g.transform="rotate(-90deg)"}return(0,Bn.jsx)(Za,{className:He(p.root,n),style:{width:a,height:a,...g,...s},ownerState:h,ref:t,role:"progressbar",...m,...d,children:(0,Bn.jsx)(es,{className:p.svg,ownerState:h,viewBox:"22 22 44 44",children:(0,Bn.jsx)(ts,{className:p.circle,style:f,ownerState:h,cx:44,cy:44,r:(44-c)/2,fill:"none",strokeWidth:c})})})}));function ns(e){return vi("MuiButton",e)}var os=bi("MuiButton",["root","text","textInherit","textPrimary","textSecondary","textSuccess","textError","textInfo","textWarning","outlined","outlinedInherit","outlinedPrimary","outlinedSecondary","outlinedSuccess","outlinedError","outlinedInfo","outlinedWarning","contained","containedInherit","containedPrimary","containedSecondary","containedSuccess","containedError","containedInfo","containedWarning","disableElevation","focusVisible","disabled","colorInherit","colorPrimary","colorSecondary","colorSuccess","colorError","colorInfo","colorWarning","textSizeSmall","textSizeMedium","textSizeLarge","outlinedSizeSmall","outlinedSizeMedium","outlinedSizeLarge","containedSizeSmall","containedSizeMedium","containedSizeLarge","sizeMedium","sizeSmall","sizeLarge","fullWidth","startIcon","endIcon","icon","iconSizeSmall","iconSizeMedium","iconSizeLarge","loading","loadingWrapper","loadingIconPlaceholder","loadingIndicator","loadingPositionCenter","loadingPositionStart","loadingPositionEnd"]),is=n.createContext({}),as=n.createContext(void 0);const ss=[{props:{size:"small"},style:{"& > *:nth-of-type(1)":{fontSize:18}}},{props:{size:"medium"},style:{"& > *:nth-of-type(1)":{fontSize:20}}},{props:{size:"large"},style:{"& > *:nth-of-type(1)":{fontSize:22}}}],cs=Bi(Ga,{shouldForwardProp:e=>Mi(e)||"classes"===e,name:"MuiButton",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,t[r.variant],t[`${r.variant}${Ji(r.color)}`],t[`size${Ji(r.size)}`],t[`${r.variant}Size${Ji(r.size)}`],"inherit"===r.color&&t.colorInherit,r.disableElevation&&t.disableElevation,r.fullWidth&&t.fullWidth,r.loading&&t.loading]}})(Fi((({theme:e})=>{const t="light"===e.palette.mode?e.palette.grey[300]:e.palette.grey[800],r="light"===e.palette.mode?e.palette.grey.A100:e.palette.grey[700];return{...e.typography.button,minWidth:64,padding:"6px 16px",border:0,borderRadius:(e.vars||e).shape.borderRadius,transition:e.transitions.create(["background-color","box-shadow","border-color","color"],{duration:e.transitions.duration.short}),"&:hover":{textDecoration:"none"},[`&.${os.disabled}`]:{color:(e.vars||e).palette.action.disabled},variants:[{props:{variant:"contained"},style:{color:"var(--variant-containedColor)",backgroundColor:"var(--variant-containedBg)",boxShadow:(e.vars||e).shadows[2],"&:hover":{boxShadow:(e.vars||e).shadows[4],"@media (hover: none)":{boxShadow:(e.vars||e).shadows[2]}},"&:active":{boxShadow:(e.vars||e).shadows[8]},[`&.${os.focusVisible}`]:{boxShadow:(e.vars||e).shadows[6]},[`&.${os.disabled}`]:{color:(e.vars||e).palette.action.disabled,boxShadow:(e.vars||e).shadows[0],backgroundColor:(e.vars||e).palette.action.disabledBackground}}},{props:{variant:"outlined"},style:{padding:"5px 15px",border:"1px solid currentColor",borderColor:"var(--variant-outlinedBorder, currentColor)",backgroundColor:"var(--variant-outlinedBg)",color:"var(--variant-outlinedColor)",[`&.${os.disabled}`]:{border:`1px solid ${(e.vars||e).palette.action.disabledBackground}`}}},{props:{variant:"text"},style:{padding:"6px 8px",color:"var(--variant-textColor)",backgroundColor:"var(--variant-textBg)"}},...Object.entries(e.palette).filter(Xi()).map((([t])=>({props:{color:t},style:{"--variant-textColor":(e.vars||e).palette[t].main,"--variant-outlinedColor":(e.vars||e).palette[t].main,"--variant-outlinedBorder":e.vars?`rgba(${e.vars.palette[t].mainChannel} / 0.5)`:Kn(e.palette[t].main,.5),"--variant-containedColor":(e.vars||e).palette[t].contrastText,"--variant-containedBg":(e.vars||e).palette[t].main,"@media (hover: hover)":{"&:hover":{"--variant-containedBg":(e.vars||e).palette[t].dark,"--variant-textBg":e.vars?`rgba(${e.vars.palette[t].mainChannel} / ${e.vars.palette.action.hoverOpacity})`:Kn(e.palette[t].main,e.palette.action.hoverOpacity),"--variant-outlinedBorder":(e.vars||e).palette[t].main,"--variant-outlinedBg":e.vars?`rgba(${e.vars.palette[t].mainChannel} / ${e.vars.palette.action.hoverOpacity})`:Kn(e.palette[t].main,e.palette.action.hoverOpacity)}}}}))),{props:{color:"inherit"},style:{color:"inherit",borderColor:"currentColor","--variant-containedBg":e.vars?e.vars.palette.Button.inheritContainedBg:t,"@media (hover: hover)":{"&:hover":{"--variant-containedBg":e.vars?e.vars.palette.Button.inheritContainedHoverBg:r,"--variant-textBg":e.vars?`rgba(${e.vars.palette.text.primaryChannel} / ${e.vars.palette.action.hoverOpacity})`:Kn(e.palette.text.primary,e.palette.action.hoverOpacity),"--variant-outlinedBg":e.vars?`rgba(${e.vars.palette.text.primaryChannel} / ${e.vars.palette.action.hoverOpacity})`:Kn(e.palette.text.primary,e.palette.action.hoverOpacity)}}}},{props:{size:"small",variant:"text"},style:{padding:"4px 5px",fontSize:e.typography.pxToRem(13)}},{props:{size:"large",variant:"text"},style:{padding:"8px 11px",fontSize:e.typography.pxToRem(15)}},{props:{size:"small",variant:"outlined"},style:{padding:"3px 9px",fontSize:e.typography.pxToRem(13)}},{props:{size:"large",variant:"outlined"},style:{padding:"7px 21px",fontSize:e.typography.pxToRem(15)}},{props:{size:"small",variant:"contained"},style:{padding:"4px 10px",fontSize:e.typography.pxToRem(13)}},{props:{size:"large",variant:"contained"},style:{padding:"8px 22px",fontSize:e.typography.pxToRem(15)}},{props:{disableElevation:!0},style:{boxShadow:"none","&:hover":{boxShadow:"none"},[`&.${os.focusVisible}`]:{boxShadow:"none"},"&:active":{boxShadow:"none"},[`&.${os.disabled}`]:{boxShadow:"none"}}},{props:{fullWidth:!0},style:{width:"100%"}},{props:{loadingPosition:"center"},style:{transition:e.transitions.create(["background-color","box-shadow","border-color"],{duration:e.transitions.duration.short}),[`&.${os.loading}`]:{color:"transparent"}}}]}}))),ls=Bi("span",{name:"MuiButton",slot:"StartIcon",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.startIcon,r.loading&&t.startIconLoadingStart,t[`iconSize${Ji(r.size)}`]]}})((({theme:e})=>({display:"inherit",marginRight:8,marginLeft:-4,variants:[{props:{size:"small"},style:{marginLeft:-2}},{props:{loadingPosition:"start",loading:!0},style:{transition:e.transitions.create(["opacity"],{duration:e.transitions.duration.short}),opacity:0}},{props:{loadingPosition:"start",loading:!0,fullWidth:!0},style:{marginRight:-8}},...ss]}))),us=Bi("span",{name:"MuiButton",slot:"EndIcon",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.endIcon,r.loading&&t.endIconLoadingEnd,t[`iconSize${Ji(r.size)}`]]}})((({theme:e})=>({display:"inherit",marginRight:-4,marginLeft:8,variants:[{props:{size:"small"},style:{marginRight:-2}},{props:{loadingPosition:"end",loading:!0},style:{transition:e.transitions.create(["opacity"],{duration:e.transitions.duration.short}),opacity:0}},{props:{loadingPosition:"end",loading:!0,fullWidth:!0},style:{marginLeft:-8}},...ss]}))),ds=Bi("span",{name:"MuiButton",slot:"LoadingIndicator"})((({theme:e})=>({display:"none",position:"absolute",visibility:"visible",variants:[{props:{loading:!0},style:{display:"flex"}},{props:{loadingPosition:"start"},style:{left:14}},{props:{loadingPosition:"start",size:"small"},style:{left:10}},{props:{variant:"text",loadingPosition:"start"},style:{left:6}},{props:{loadingPosition:"center"},style:{left:"50%",transform:"translate(-50%)",color:(e.vars||e).palette.action.disabled}},{props:{loadingPosition:"end"},style:{right:14}},{props:{loadingPosition:"end",size:"small"},style:{right:10}},{props:{variant:"text",loadingPosition:"end"},style:{right:6}},{props:{loadingPosition:"start",fullWidth:!0},style:{position:"relative",left:-10}},{props:{loadingPosition:"end",fullWidth:!0},style:{position:"relative",right:-10}}]}))),hs=Bi("span",{name:"MuiButton",slot:"LoadingIconPlaceholder"})({display:"inline-block",width:"1em",height:"1em"});var ps,fs=n.forwardRef((function(e,t){const r=n.useContext(is),o=n.useContext(as),i=Hi({props:Li(r,e),name:"MuiButton"}),{children:a,color:s="primary",component:c="button",className:l,disabled:u=!1,disableElevation:d=!1,disableFocusRipple:h=!1,endIcon:p,focusVisibleClassName:f,fullWidth:g=!1,id:m,loading:y=null,loadingIndicator:v,loadingPosition:b="center",size:w="medium",startIcon:C,type:A,variant:k="text",...S}=i,T=sa(m),I=v??(0,Bn.jsx)(rs,{"aria-labelledby":T,color:"inherit",size:16}),E={...i,color:s,component:c,disabled:u,disableElevation:d,disableFocusRipple:h,fullWidth:g,loading:y,loadingIndicator:I,loadingPosition:b,size:w,type:A,variant:k},x=(e=>{const{color:t,disableElevation:r,fullWidth:n,size:o,variant:i,loading:a,loadingPosition:s,classes:c}=e,l=Si({root:["root",a&&"loading",i,`${i}${Ji(t)}`,`size${Ji(o)}`,`${i}Size${Ji(o)}`,`color${Ji(t)}`,r&&"disableElevation",n&&"fullWidth",a&&`loadingPosition${Ji(s)}`],startIcon:["icon","startIcon",`iconSize${Ji(o)}`],endIcon:["icon","endIcon",`iconSize${Ji(o)}`],loadingIndicator:["loadingIndicator"],loadingWrapper:["loadingWrapper"]},ns,c);return{...c,...l}})(E),_=(C||y&&"start"===b)&&(0,Bn.jsx)(ls,{className:x.startIcon,ownerState:E,children:C||(0,Bn.jsx)(hs,{className:x.loadingIconPlaceholder,ownerState:E})}),P=(p||y&&"end"===b)&&(0,Bn.jsx)(us,{className:x.endIcon,ownerState:E,children:p||(0,Bn.jsx)(hs,{className:x.loadingIconPlaceholder,ownerState:E})}),R=o||"",O="boolean"==typeof y?(0,Bn.jsx)("span",{className:x.loadingWrapper,style:{display:"contents"},children:y&&(0,Bn.jsx)(ds,{className:x.loadingIndicator,ownerState:E,children:I})}):null;return(0,Bn.jsxs)(cs,{ownerState:E,className:He(r.className,x.root,l,R),component:c,disabled:u||y,focusRipple:!h,focusVisibleClassName:He(x.focusVisible,f),ref:t,type:A,id:y?T:m,...S,classes:x,children:[_,"end"!==b&&O,a,"end"===b&&O,P]})})),gs={title:"Report Phishing Email",description:"You are about to report the following email as suspicious:",from:"From:",subject:"Subject:",received:"Received:",report_email:"Are you sure you want to report this as a phishing email?",button:"Report as Phishing",success:{title:"Suspected Phishing Attempt",loading:{title:"Processing Report...",description:"Please wait while we process your report."},success_msg:"Thank you for reporting this email.",description:"The email will automatically include the correct email address to report this to. It will also attach the reported email and include the email headers for analysis. After sending, the email will be reviewed and actioned accordingly.",buttons:{done:"Done",deleting:"Deleting..."}}},ms={companyId:"",OtherPhishingTargetEmails:"",OtherPhishingSubject:"Phishing Report: {subject}",OtherPhishingBody:"User Email: {userEmail}\nDate: {date}\nSubject: {subject}\nSender: {sender}"},ys=function(){return ys=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},ys.apply(this,arguments)},vs=function(){function e(e){this.options=e,this.listeners={}}return e.prototype.on=function(e,t){var r=this.listeners[e]||[];this.listeners[e]=r.concat([t])},e.prototype.triggerEvent=function(e,t){var r=this;(this.listeners[e]||[]).forEach((function(e){return e({target:r,event:t})}))},e}();!function(e){e[e.Add=0]="Add",e[e.Remove=1]="Remove"}(ps||(ps={}));var bs,ws=function(){function e(){this.notifications=[]}return e.prototype.push=function(e){this.notifications.push(e),this.updateFn(e,ps.Add,this.notifications)},e.prototype.splice=function(e,t){var r=this.notifications.splice(e,t)[0];return this.updateFn(r,ps.Remove,this.notifications),r},e.prototype.indexOf=function(e){return this.notifications.indexOf(e)},e.prototype.onUpdate=function(e){this.updateFn=e},e}();!function(e){e.Dismiss="dismiss",e.Click="click"}(bs||(bs={}));var Cs={types:[{type:"success",className:"notyf__toast--success",backgroundColor:"#3dc763",icon:{className:"notyf__icon--success",tagName:"i"}},{type:"error",className:"notyf__toast--error",backgroundColor:"#ed3d3d",icon:{className:"notyf__icon--error",tagName:"i"}}],duration:2e3,ripple:!0,position:{x:"right",y:"bottom"},dismissible:!1},As=function(){function e(){this.notifications=[],this.events={},this.X_POSITION_FLEX_MAP={left:"flex-start",center:"center",right:"flex-end"},this.Y_POSITION_FLEX_MAP={top:"flex-start",center:"center",bottom:"flex-end"};var e=document.createDocumentFragment(),t=this._createHTMLElement({tagName:"div",className:"notyf"});e.appendChild(t),document.body.appendChild(e),this.container=t,this.animationEndEventName=this._getAnimationEndEventName(),this._createA11yContainer()}return e.prototype.on=function(e,t){var r;this.events=ys(ys({},this.events),((r={})[e]=t,r))},e.prototype.update=function(e,t){t===ps.Add?this.addNotification(e):t===ps.Remove&&this.removeNotification(e)},e.prototype.removeNotification=function(e){var t,r,n=this,o=this._popRenderedNotification(e);o&&((t=o.node).classList.add("notyf__toast--disappear"),t.addEventListener(this.animationEndEventName,r=function(e){e.target===t&&(t.removeEventListener(n.animationEndEventName,r),n.container.removeChild(t))}))},e.prototype.addNotification=function(e){var t=this._renderNotification(e);this.notifications.push({notification:e,node:t}),this._announce(e.options.message||"Notification")},e.prototype._renderNotification=function(e){var t,r=this._buildNotificationCard(e),n=e.options.className;return n&&(t=r.classList).add.apply(t,n.split(" ")),this.container.appendChild(r),r},e.prototype._popRenderedNotification=function(e){for(var t=-1,r=0;r<this.notifications.length&&t<0;r++)this.notifications[r].notification===e&&(t=r);if(-1!==t)return this.notifications.splice(t,1)[0]},e.prototype.getXPosition=function(e){var t;return(null===(t=null==e?void 0:e.position)||void 0===t?void 0:t.x)||"right"},e.prototype.getYPosition=function(e){var t;return(null===(t=null==e?void 0:e.position)||void 0===t?void 0:t.y)||"bottom"},e.prototype.adjustContainerAlignment=function(e){var t=this.X_POSITION_FLEX_MAP[this.getXPosition(e)],r=this.Y_POSITION_FLEX_MAP[this.getYPosition(e)],n=this.container.style;n.setProperty("justify-content",r),n.setProperty("align-items",t)},e.prototype._buildNotificationCard=function(e){var t=this,r=e.options,n=r.icon;this.adjustContainerAlignment(r);var o=this._createHTMLElement({tagName:"div",className:"notyf__toast"}),i=this._createHTMLElement({tagName:"div",className:"notyf__ripple"}),a=this._createHTMLElement({tagName:"div",className:"notyf__wrapper"}),s=this._createHTMLElement({tagName:"div",className:"notyf__message"});s.innerHTML=r.message||"";var c=r.background||r.backgroundColor;if(n){var l=this._createHTMLElement({tagName:"div",className:"notyf__icon"});if(("string"==typeof n||n instanceof String)&&(l.innerHTML=new String(n).valueOf()),"object"==typeof n){var u=n.tagName,d=void 0===u?"i":u,h=n.className,p=n.text,f=n.color,g=void 0===f?c:f,m=this._createHTMLElement({tagName:d,className:h,text:p});g&&(m.style.color=g),l.appendChild(m)}a.appendChild(l)}if(a.appendChild(s),o.appendChild(a),c&&(r.ripple?(i.style.background=c,o.appendChild(i)):o.style.background=c),r.dismissible){var y=this._createHTMLElement({tagName:"div",className:"notyf__dismiss"}),v=this._createHTMLElement({tagName:"button",className:"notyf__dismiss-btn"});y.appendChild(v),a.appendChild(y),o.classList.add("notyf__toast--dismissible"),v.addEventListener("click",(function(r){var n,o;null===(o=(n=t.events)[bs.Dismiss])||void 0===o||o.call(n,{target:e,event:r}),r.stopPropagation()}))}o.addEventListener("click",(function(r){var n,o;return null===(o=(n=t.events)[bs.Click])||void 0===o?void 0:o.call(n,{target:e,event:r})}));var b="top"===this.getYPosition(r)?"upper":"lower";return o.classList.add("notyf__toast--"+b),o},e.prototype._createHTMLElement=function(e){var t=e.tagName,r=e.className,n=e.text,o=document.createElement(t);return r&&(o.className=r),o.textContent=n||null,o},e.prototype._createA11yContainer=function(){var e=this._createHTMLElement({tagName:"div",className:"notyf-announcer"});e.setAttribute("aria-atomic","true"),e.setAttribute("aria-live","polite"),e.style.border="0",e.style.clip="rect(0 0 0 0)",e.style.height="1px",e.style.margin="-1px",e.style.overflow="hidden",e.style.padding="0",e.style.position="absolute",e.style.width="1px",e.style.outline="0",document.body.appendChild(e),this.a11yContainer=e},e.prototype._announce=function(e){var t=this;this.a11yContainer.textContent="",setTimeout((function(){t.a11yContainer.textContent=e}),100)},e.prototype._getAnimationEndEventName=function(){var e,t=document.createElement("_fake"),r={MozTransition:"animationend",OTransition:"oAnimationEnd",WebkitTransition:"webkitAnimationEnd",transition:"animationend"};for(e in r)if(void 0!==t.style[e])return r[e];return"animationend"},e}(),ks=function(){function e(e){var t=this;this.dismiss=this._removeNotification,this.notifications=new ws,this.view=new As;var r=this.registerTypes(e);this.options=ys(ys({},Cs),e),this.options.types=r,this.notifications.onUpdate((function(e,r){return t.view.update(e,r)})),this.view.on(bs.Dismiss,(function(e){var r=e.target,n=e.event;t._removeNotification(r),r.triggerEvent(bs.Dismiss,n)})),this.view.on(bs.Click,(function(e){var t=e.target,r=e.event;return t.triggerEvent(bs.Click,r)}))}return e.prototype.error=function(e){var t=this.normalizeOptions("error",e);return this.open(t)},e.prototype.success=function(e){var t=this.normalizeOptions("success",e);return this.open(t)},e.prototype.open=function(e){var t=this.options.types.find((function(t){return t.type===e.type}))||{},r=ys(ys({},t),e);this.assignProps(["ripple","position","dismissible"],r);var n=new vs(r);return this._pushNotification(n),n},e.prototype.dismissAll=function(){for(;this.notifications.splice(0,1););},e.prototype.assignProps=function(e,t){var r=this;e.forEach((function(e){t[e]=null==t[e]?r.options[e]:t[e]}))},e.prototype._pushNotification=function(e){var t=this;this.notifications.push(e);var r=void 0!==e.options.duration?e.options.duration:this.options.duration;r&&setTimeout((function(){return t._removeNotification(e)}),r)},e.prototype._removeNotification=function(e){var t=this.notifications.indexOf(e);-1!==t&&this.notifications.splice(t,1)},e.prototype.normalizeOptions=function(e,t){var r={type:e};return"string"==typeof t?r.message=t:"object"==typeof t&&(r=ys(ys({},r),t)),r},e.prototype.registerTypes=function(e){var t=(e&&e.types||[]).slice();return Cs.types.map((function(e){var r=-1;t.forEach((function(t,n){t.type===e.type&&(r=n)}));var n=-1!==r?t.splice(r,1)[0]:{};return ys(ys({},e),n)})).concat(t)},e}(),Ss=r(85072),Ts=r.n(Ss),Is=r(97825),Es=r.n(Is),xs=r(77659),_s=r.n(xs),Ps=r(55056),Rs=r.n(Ps),Os=r(10540),Ms=r.n(Os),Ns=r(41113),Bs=r.n(Ns),Ls=r(96674),qs={};qs.styleTagTransform=Bs(),qs.setAttributes=Rs(),qs.insert=_s().bind(null,"head"),qs.domAPI=Es(),qs.insertStyleElement=Ms(),Ts()(Ls.A,qs),Ls.A&&Ls.A.locals&&Ls.A.locals;var Hs=new ks({duration:3e3,position:{x:"right",y:"bottom"},types:[{type:"success",background:"#0D9D58"},{type:"error",background:"#dc2626"}]});const $s={LIBRARY_NAME:"MSAL.JS",SKU:"msal.js.common",CACHE_PREFIX:"msal",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",DEFAULT_COMMON_TENANT:"common",ADFS:"adfs",DSTS:"dstsv2",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",CIAM_AUTH_URL:".ciamlogin.com",AAD_TENANT_DOMAIN_SUFFIX:".onmicrosoft.com",RESOURCE_DELIM:"|",NO_ACCOUNT:"NO_ACCOUNT",CLAIMS:"claims",CONSUMER_UTID:"9188040d-6c67-4c5b-b112-36a304b66dad",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",EMAIL_SCOPE:"email",CODE_GRANT_TYPE:"authorization_code",RT_GRANT_TYPE:"refresh_token",S256_CODE_CHALLENGE_METHOD:"S256",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",AUTHORIZATION_PENDING:"authorization_pending",NOT_DEFINED:"not_defined",EMPTY_STRING:"",NOT_APPLICABLE:"N/A",NOT_AVAILABLE:"Not Available",FORWARD_SLASH:"/",IMDS_ENDPOINT:"http://169.254.169.254/metadata/instance/compute/location",IMDS_VERSION:"2020-06-01",IMDS_TIMEOUT:2e3,AZURE_REGION_AUTO_DISCOVER_FLAG:"TryAutoDetect",REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX:"login.microsoft.com",KNOWN_PUBLIC_CLOUDS:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"],SHR_NONCE_VALIDITY:240,INVALID_INSTANCE:"invalid_instance"},Ds=[$s.OPENID_SCOPE,$s.PROFILE_SCOPE,$s.OFFLINE_ACCESS_SCOPE],Fs=[...Ds,$s.EMAIL_SCOPE],Us="Content-Type",js="Retry-After",zs="X-AnchorMailbox",Ks="x-ms-request-id",Ws="x-ms-httpver",Gs="active-account-filters",Vs="common",Ys="organizations",Qs="consumers",Js="access_token",Xs={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none",CREATE:"create",NO_SESSION:"no_session"},Zs={PLAIN:"plain",S256:"S256"},ec="query",tc="Generic",rc="-",nc={ID_TOKEN:"IdToken",ACCESS_TOKEN:"AccessToken",ACCESS_TOKEN_WITH_AUTH_SCHEME:"AccessToken_With_AuthScheme",REFRESH_TOKEN:"RefreshToken"},oc="appmetadata",ic="1",ac="authority-metadata",sc="config",cc="cache",lc="network",uc="hardcoded_values",dc={SCHEMA_VERSION:5,MAX_CUR_HEADER_BYTES:80,MAX_LAST_HEADER_BYTES:330,MAX_CACHED_ERRORS:50,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"},hc={BEARER:"Bearer",POP:"pop",SSH:"ssh-cert"},pc="throttling";var fc;!function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose",e[e.Trace=4]="Trace"}(fc||(fc={}));class gc{constructor(e,t,r){this.level=fc.Info;const n=e||gc.createDefaultLoggerOptions();this.localCallback=n.loggerCallback||(()=>{}),this.piiLoggingEnabled=n.piiLoggingEnabled||!1,this.level="number"==typeof n.logLevel?n.logLevel:fc.Info,this.correlationId=n.correlationId||$s.EMPTY_STRING,this.packageName=t||$s.EMPTY_STRING,this.packageVersion=r||$s.EMPTY_STRING}static createDefaultLoggerOptions(){return{loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:fc.Info}}clone(e,t,r){return new gc({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level,correlationId:r||this.correlationId},e,t)}logMessage(e,t){if(t.logLevel>this.level||!this.piiLoggingEnabled&&t.containsPii)return;const r=`[${(new Date).toUTCString()}] : [${t.correlationId||this.correlationId||""}] : ${this.packageName}@${this.packageVersion} : ${fc[t.logLevel]} - ${e}`;this.executeCallback(t.logLevel,r,t.containsPii||!1)}executeCallback(e,t,r){this.localCallback&&this.localCallback(e,t,r)}error(e,t){this.logMessage(e,{logLevel:fc.Error,containsPii:!1,correlationId:t||$s.EMPTY_STRING})}errorPii(e,t){this.logMessage(e,{logLevel:fc.Error,containsPii:!0,correlationId:t||$s.EMPTY_STRING})}warning(e,t){this.logMessage(e,{logLevel:fc.Warning,containsPii:!1,correlationId:t||$s.EMPTY_STRING})}warningPii(e,t){this.logMessage(e,{logLevel:fc.Warning,containsPii:!0,correlationId:t||$s.EMPTY_STRING})}info(e,t){this.logMessage(e,{logLevel:fc.Info,containsPii:!1,correlationId:t||$s.EMPTY_STRING})}infoPii(e,t){this.logMessage(e,{logLevel:fc.Info,containsPii:!0,correlationId:t||$s.EMPTY_STRING})}verbose(e,t){this.logMessage(e,{logLevel:fc.Verbose,containsPii:!1,correlationId:t||$s.EMPTY_STRING})}verbosePii(e,t){this.logMessage(e,{logLevel:fc.Verbose,containsPii:!0,correlationId:t||$s.EMPTY_STRING})}trace(e,t){this.logMessage(e,{logLevel:fc.Trace,containsPii:!1,correlationId:t||$s.EMPTY_STRING})}tracePii(e,t){this.logMessage(e,{logLevel:fc.Trace,containsPii:!0,correlationId:t||$s.EMPTY_STRING})}isPiiLoggingEnabled(){return this.piiLoggingEnabled||!1}}const mc="OIDC",yc="EAR",vc="none",bc="unexpected_error",wc="post_request_failed",Cc={[bc]:"Unexpected error in authentication.",[wc]:"Post request failed from the network, could be a 4xx/5xx or a network unavailability. Please check the exact error code for details."};class Ac extends Error{constructor(e,t,r){super(t?`${e}: ${t}`:e),Object.setPrototypeOf(this,Ac.prototype),this.errorCode=e||$s.EMPTY_STRING,this.errorMessage=t||$s.EMPTY_STRING,this.subError=r||$s.EMPTY_STRING,this.name="AuthError"}setCorrelationId(e){this.correlationId=e}}function kc(e,t){return new Ac(e,t?`${Cc[e]} ${t}`:Cc[e])}const Sc="client_info_decoding_error",Tc="client_info_empty_error",Ic="token_parsing_error",Ec="null_or_empty_token",xc="endpoints_resolution_error",_c="network_error",Pc="openid_config_error",Rc="hash_not_deserialized",Oc="invalid_state",Mc="state_mismatch",Nc="state_not_found",Bc="nonce_mismatch",Lc="auth_time_not_found",qc="max_age_transpired",Hc="multiple_matching_tokens",$c="multiple_matching_accounts",Dc="multiple_matching_appMetadata",Fc="request_cannot_be_made",Uc="cannot_remove_empty_scope",jc="cannot_append_scopeset",zc="empty_input_scopeset",Kc="device_code_polling_cancelled",Wc="device_code_expired",Gc="device_code_unknown_error",Vc="no_account_in_silent_request",Yc="invalid_cache_record",Qc="invalid_cache_environment",Jc="no_account_found",Xc="no_crypto_object",Zc="unexpected_credential_type",el="invalid_assertion",tl="invalid_client_credential",rl="token_refresh_required",nl="user_timeout_reached",ol="token_claims_cnf_required_for_signedjwt",il="authorization_code_missing_from_server_response",al="binding_key_not_removed",sl="end_session_endpoint_not_supported",cl="key_id_missing",ll="no_network_connectivity",ul="user_canceled",dl="missing_tenant_id_error",hl="method_not_implemented",pl="nested_app_auth_bridge_disabled",fl={[Sc]:"The client info could not be parsed/decoded correctly",[Tc]:"The client info was empty",[Ic]:"Token cannot be parsed",[Ec]:"The token is null or empty",[xc]:"Endpoints cannot be resolved",[_c]:"Network request failed",[Pc]:"Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints.",[Rc]:"The hash parameters could not be deserialized",[Oc]:"State was not the expected format",[Mc]:"State mismatch error",[Nc]:"State not found",[Bc]:"Nonce mismatch error",[Lc]:"Max Age was requested and the ID token is missing the auth_time variable. auth_time is an optional claim and is not enabled by default - it must be enabled. See https://aka.ms/msaljs/optional-claims for more information.",[qc]:"Max Age is set to 0, or too much time has elapsed since the last end-user authentication.",[Hc]:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account.",[$c]:"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account",[Dc]:"The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata",[Fc]:"Token request cannot be made without authorization code or refresh token.",[Uc]:"Cannot remove null or empty scope from ScopeSet",[jc]:"Cannot append ScopeSet",[zc]:"Empty input ScopeSet cannot be processed",[Kc]:"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true.",[Wc]:"Device code is expired.",[Gc]:"Device code stopped polling for unknown reasons.",[Vc]:"Please pass an account object, silent flow is not supported without account information",[Yc]:"Cache record object was null or undefined.",[Qc]:"Invalid environment when attempting to create cache entry",[Jc]:"No account found in cache for given key.",[Xc]:"No crypto object detected.",[Zc]:"Unexpected credential type.",[el]:"Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515",[tl]:"Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential",[rl]:"Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired.",[nl]:"User defined timeout for device code polling reached",[ol]:"Cannot generate a POP jwt if the token_claims are not populated",[il]:"Server response does not contain an authorization code to proceed",[al]:"Could not remove the credential's binding key from storage.",[sl]:"The provided authority does not support logout",[cl]:"A keyId value is missing from the requested bound token's cache record and is required to match the token to it's stored binding key.",[ll]:"No network connectivity. Check your internet connection.",[ul]:"User cancelled the flow.",[dl]:"A tenant id - not common, organizations, or consumers - must be specified when using the client_credentials flow.",[hl]:"This method has not been implemented",[pl]:"The nested app auth bridge is disabled"};class gl extends Ac{constructor(e,t){super(e,t?`${fl[e]}: ${t}`:fl[e]),this.name="ClientAuthError",Object.setPrototypeOf(this,gl.prototype)}}function ml(e,t){return new gl(e,t)}const yl={createNewGuid:()=>{throw ml(hl)},base64Decode:()=>{throw ml(hl)},base64Encode:()=>{throw ml(hl)},base64UrlEncode:()=>{throw ml(hl)},encodeKid:()=>{throw ml(hl)},async getPublicKeyThumbprint(){throw ml(hl)},async removeTokenBindingKey(){throw ml(hl)},async clearKeystore(){throw ml(hl)},async signJwt(){throw ml(hl)},async hashString(){throw ml(hl)}},vl="@azure/msal-common",bl="15.6.0";function wl(e,t){const r=function(e){if(!e)throw ml(Ec);const t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(e);if(!t||t.length<4)throw ml(Ic);return t[2]}(e);try{const e=t(r);return JSON.parse(e)}catch(e){throw ml(Ic)}}function Cl(e,t){if(0===t||Date.now()-3e5>e+t)throw ml(qc)}function Al(){return Math.round((new Date).getTime()/1e3)}function kl(e){return e.getTime()/1e3}function Sl(e){return e?new Date(1e3*Number(e)):new Date}function Tl(e,t){const r=Number(e)||0;return Al()+t>r}function Il(e){return Number(e)>Al()}function El(e){return[Ol(e),Ml(e),Nl(e),Bl(e),Ll(e)].join(rc).toLowerCase()}function xl(e,t,r,n,o){return{credentialType:nc.ID_TOKEN,homeAccountId:e,environment:t,clientId:n,secret:r,realm:o}}function _l(e,t,r,n,o,i,a,s,c,l,u,d,h,p,f){const g={homeAccountId:e,credentialType:nc.ACCESS_TOKEN,secret:r,cachedAt:Al().toString(),expiresOn:a.toString(),extendedExpiresOn:s.toString(),environment:t,clientId:n,realm:o,target:i,tokenType:u||hc.BEARER};if(d&&(g.userAssertionHash=d),l&&(g.refreshOn=l.toString()),p&&(g.requestedClaims=p,g.requestedClaimsHash=f),g.tokenType?.toLowerCase()!==hc.BEARER.toLowerCase())switch(g.credentialType=nc.ACCESS_TOKEN_WITH_AUTH_SCHEME,g.tokenType){case hc.POP:const e=wl(r,c);if(!e?.cnf?.kid)throw ml(ol);g.keyId=e.cnf.kid;break;case hc.SSH:g.keyId=h}return g}function Pl(e,t,r,n,o,i,a){const s={credentialType:nc.REFRESH_TOKEN,homeAccountId:e,environment:t,clientId:n,secret:r};return i&&(s.userAssertionHash=i),o&&(s.familyId=o),a&&(s.expiresOn=a.toString()),s}function Rl(e){return e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")}function Ol(e){return[e.homeAccountId,e.environment].join(rc).toLowerCase()}function Ml(e){const t=e.credentialType===nc.REFRESH_TOKEN&&e.familyId||e.clientId;return[e.credentialType,t,e.realm||""].join(rc).toLowerCase()}function Nl(e){return(e.target||"").toLowerCase()}function Bl(e){return(e.requestedClaimsHash||"").toLowerCase()}function Ll(e){return e.tokenType&&e.tokenType.toLowerCase()!==hc.BEARER.toLowerCase()?e.tokenType.toLowerCase():""}function ql(){return Al()+86400}function Hl(e,t,r){e.authorization_endpoint=t.authorization_endpoint,e.token_endpoint=t.token_endpoint,e.end_session_endpoint=t.end_session_endpoint,e.issuer=t.issuer,e.endpointsFromNetwork=r,e.jwks_uri=t.jwks_uri}function $l(e,t,r){e.aliases=t.aliases,e.preferred_cache=t.preferred_cache,e.preferred_network=t.preferred_network,e.aliasesFromNetwork=r}function Dl(e){return e.expiresAt<=Al()}r(64583).Promise;const Fl="redirect_uri_empty",Ul="claims_request_parsing_error",jl="authority_uri_insecure",zl="url_parse_error",Kl="empty_url_error",Wl="empty_input_scopes_error",Gl="invalid_prompt_value",Vl="invalid_claims",Yl="token_request_empty",Ql="logout_request_empty",Jl="invalid_code_challenge_method",Xl="pkce_params_missing",Zl="invalid_cloud_discovery_metadata",eu="invalid_authority_metadata",tu="untrusted_authority",ru="missing_ssh_jwk",nu="missing_ssh_kid",ou="missing_nonce_authentication_header",iu="invalid_authentication_header",au="cannot_set_OIDCOptions",su="cannot_allow_platform_broker",cu="authority_mismatch",lu={[Fl]:"A redirect URI is required for all calls, and none has been set.",[Ul]:"Could not parse the given claims request object.",[jl]:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options",[zl]:"URL could not be parsed into appropriate segments.",[Kl]:"URL was empty or null.",[Wl]:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token.",[Gl]:"Please see here for valid configuration options: https://azuread.github.io/microsoft-authentication-library-for-js/ref/modules/_azure_msal_common.html#commonauthorizationurlrequest",[Vl]:"Given claims parameter must be a stringified JSON object.",[Yl]:"Token request was empty and not found in cache.",[Ql]:"The logout request was null or undefined.",[Jl]:'code_challenge_method passed is invalid. Valid values are "plain" and "S256".',[Xl]:"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request",[Zl]:"Invalid cloudDiscoveryMetadata provided. Must be a stringified JSON object containing tenant_discovery_endpoint and metadata fields",[eu]:"Invalid authorityMetadata provided. Must by a stringified JSON object containing authorization_endpoint, token_endpoint, issuer fields.",[tu]:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter.",[ru]:"Missing sshJwk in SSH certificate request. A stringified JSON Web Key is required when using the SSH authentication scheme.",[nu]:"Missing sshKid in SSH certificate request. A string that uniquely identifies the public SSH key is required when using the SSH authentication scheme.",[ou]:"Unable to find an authentication header containing server nonce. Either the Authentication-Info or WWW-Authenticate headers must be present in order to obtain a server nonce.",[iu]:"Invalid authentication header provided",[au]:"Cannot set OIDCOptions parameter. Please change the protocol mode to OIDC or use a non-Microsoft authority.",[su]:"Cannot set allowPlatformBroker parameter to true when not in AAD protocol mode.",[cu]:"Authority mismatch error. Authority provided in login request or PublicClientApplication config does not match the environment of the provided account. Please use a matching account or make an interactive request to login to this authority."};class uu extends Ac{constructor(e){super(e,lu[e]),this.name="ClientConfigurationError",Object.setPrototypeOf(this,uu.prototype)}}function du(e){return new uu(e)}class hu{static isEmptyObj(e){if(e)try{const t=JSON.parse(e);return 0===Object.keys(t).length}catch(e){}return!0}static startsWith(e,t){return 0===e.indexOf(t)}static endsWith(e,t){return e.length>=t.length&&e.lastIndexOf(t)===e.length-t.length}static queryStringToObject(e){const t={},r=e.split("&"),n=e=>decodeURIComponent(e.replace(/\+/g," "));return r.forEach((e=>{if(e.trim()){const[r,o]=e.split(/=(.+)/g,2);r&&o&&(t[n(r)]=n(o))}})),t}static trimArrayEntries(e){return e.map((e=>e.trim()))}static removeEmptyStringsFromArray(e){return e.filter((e=>!!e))}static jsonParseHelper(e){try{return JSON.parse(e)}catch(e){return null}}static matchPattern(e,t){return new RegExp(e.replace(/\\/g,"\\\\").replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?")).test(t)}}class pu{constructor(e){const t=e?hu.trimArrayEntries([...e]):[],r=t?hu.removeEmptyStringsFromArray(t):[];if(!r||!r.length)throw du(Wl);this.scopes=new Set,r.forEach((e=>this.scopes.add(e)))}static fromString(e){const t=(e||$s.EMPTY_STRING).split(" ");return new pu(t)}static createSearchScopes(e){const t=new pu(e);return t.containsOnlyOIDCScopes()?t.removeScope($s.OFFLINE_ACCESS_SCOPE):t.removeOIDCScopes(),t}containsScope(e){const t=this.printScopesLowerCase().split(" "),r=new pu(t);return!!e&&r.scopes.has(e.toLowerCase())}containsScopeSet(e){return!(!e||e.scopes.size<=0)&&this.scopes.size>=e.scopes.size&&e.asArray().every((e=>this.containsScope(e)))}containsOnlyOIDCScopes(){let e=0;return Fs.forEach((t=>{this.containsScope(t)&&(e+=1)})),this.scopes.size===e}appendScope(e){e&&this.scopes.add(e.trim())}appendScopes(e){try{e.forEach((e=>this.appendScope(e)))}catch(e){throw ml(jc)}}removeScope(e){if(!e)throw ml(Uc);this.scopes.delete(e.trim())}removeOIDCScopes(){Fs.forEach((e=>{this.scopes.delete(e)}))}unionScopeSets(e){if(!e)throw ml(zc);const t=new Set;return e.scopes.forEach((e=>t.add(e.toLowerCase()))),this.scopes.forEach((e=>t.add(e.toLowerCase()))),t}intersectingScopeSets(e){if(!e)throw ml(zc);e.containsOnlyOIDCScopes()||e.removeOIDCScopes();const t=this.unionScopeSets(e),r=e.getScopeCount(),n=this.getScopeCount();return t.size<n+r}getScopeCount(){return this.scopes.size}asArray(){const e=[];return this.scopes.forEach((t=>e.push(t))),e}printScopes(){return this.scopes?this.asArray().join(" "):$s.EMPTY_STRING}printScopesLowerCase(){return this.printScopes().toLowerCase()}}function fu(e,t){if(!e)throw ml(Tc);try{const r=t(e);return JSON.parse(r)}catch(e){throw ml(Sc)}}function gu(e){if(!e)throw ml(Sc);const t=e.split(".",2);return{uid:t[0],utid:t.length<2?$s.EMPTY_STRING:t[1]}}function mu(e,t){return!!e&&!!t&&e===t.split(".")[1]}function yu(e,t,r,n){if(n){const{oid:t,sub:r,tid:o,name:i,tfp:a,acr:s}=n,c=o||a||s||"";return{tenantId:c,localAccountId:t||r||"",name:i,isHomeTenant:mu(c,e)}}return{tenantId:r,localAccountId:t,isHomeTenant:mu(r,e)}}function vu(e,t,r,n){let o=e;if(t){const{isHomeTenant:r,...n}=t;o={...e,...n}}if(r){const{isHomeTenant:t,...i}=yu(e.homeAccountId,e.localAccountId,e.tenantId,r);return o={...o,...i,idTokenClaims:r,idToken:n},o}return o}function bu(e){return e&&(e.tid||e.tfp||e.acr)||null}class wu{generateAccountId(){return[this.homeAccountId,this.environment].join(rc).toLowerCase()}generateAccountKey(){return wu.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId})}getAccountInfo(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,name:this.name,nativeAccountId:this.nativeAccountId,authorityType:this.authorityType,tenantProfiles:new Map((this.tenantProfiles||[]).map((e=>[e.tenantId,e])))}}isSingleTenant(){return!this.tenantProfiles}static generateAccountCacheKey(e){const t=e.homeAccountId.split(".")[1];return[e.homeAccountId,e.environment||"",t||e.tenantId||""].join(rc).toLowerCase()}static createAccount(e,t,r){const n=new wu;let o;1===t.authorityType?n.authorityType="ADFS":t.protocolMode===mc?n.authorityType=tc:n.authorityType="MSSTS",e.clientInfo&&r&&(o=fu(e.clientInfo,r)),n.clientInfo=e.clientInfo,n.homeAccountId=e.homeAccountId,n.nativeAccountId=e.nativeAccountId;const i=e.environment||t&&t.getPreferredCache();if(!i)throw ml(Qc);n.environment=i,n.realm=o?.utid||bu(e.idTokenClaims)||"",n.localAccountId=o?.uid||e.idTokenClaims?.oid||e.idTokenClaims?.sub||"";const a=e.idTokenClaims?.preferred_username||e.idTokenClaims?.upn,s=e.idTokenClaims?.emails?e.idTokenClaims.emails[0]:null;if(n.username=a||s||"",n.name=e.idTokenClaims?.name||"",n.cloudGraphHostName=e.cloudGraphHostName,n.msGraphHost=e.msGraphHost,e.tenantProfiles)n.tenantProfiles=e.tenantProfiles;else{const t=yu(e.homeAccountId,n.localAccountId,n.realm,e.idTokenClaims);n.tenantProfiles=[t]}return n}static createFromAccountInfo(e,t,r){const n=new wu;return n.authorityType=e.authorityType||tc,n.homeAccountId=e.homeAccountId,n.localAccountId=e.localAccountId,n.nativeAccountId=e.nativeAccountId,n.realm=e.tenantId,n.environment=e.environment,n.username=e.username,n.name=e.name,n.cloudGraphHostName=t,n.msGraphHost=r,n.tenantProfiles=Array.from(e.tenantProfiles?.values()||[]),n}static generateHomeAccountId(e,t,r,n,o){if(1!==t&&2!==t){if(e)try{const t=fu(e,n.base64Decode);if(t.uid&&t.utid)return`${t.uid}.${t.utid}`}catch(e){}r.warning("No client info in response")}return o?.sub||""}static isAccountEntity(e){return!!e&&e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("localAccountId")&&e.hasOwnProperty("username")&&e.hasOwnProperty("authorityType")}static accountInfoIsEqual(e,t,r){if(!e||!t)return!1;let n=!0;if(r){const r=e.idTokenClaims||{},o=t.idTokenClaims||{};n=r.iat===o.iat&&r.nonce===o.nonce}return e.homeAccountId===t.homeAccountId&&e.localAccountId===t.localAccountId&&e.username===t.username&&e.tenantId===t.tenantId&&e.environment===t.environment&&e.nativeAccountId===t.nativeAccountId&&n}}function Cu(e){return e.startsWith("#/")?e.substring(2):e.startsWith("#")||e.startsWith("?")?e.substring(1):e}function Au(e){if(!e||e.indexOf("=")<0)return null;try{const t=Cu(e),r=Object.fromEntries(new URLSearchParams(t));if(r.code||r.ear_jwe||r.error||r.error_description||r.state)return r}catch(e){throw ml(Rc)}return null}function ku(e,t=!0,r){const n=new Array;return e.forEach(((e,o)=>{!t&&r&&o in r?n.push(`${o}=${e}`):n.push(`${o}=${encodeURIComponent(e)}`)})),n.join("&")}class Su{get urlString(){return this._urlString}constructor(e){if(this._urlString=e,!this._urlString)throw du(Kl);e.includes("#")||(this._urlString=Su.canonicalizeUri(e))}static canonicalizeUri(e){if(e){let t=e.toLowerCase();return hu.endsWith(t,"?")?t=t.slice(0,-1):hu.endsWith(t,"?/")&&(t=t.slice(0,-2)),hu.endsWith(t,"/")||(t+="/"),t}return e}validateAsUri(){let e;try{e=this.getUrlComponents()}catch(e){throw du(zl)}if(!e.HostNameAndPort||!e.PathSegments)throw du(zl);if(!e.Protocol||"https:"!==e.Protocol.toLowerCase())throw du(jl)}static appendQueryString(e,t){return t?e.indexOf("?")<0?`${e}?${t}`:`${e}&${t}`:e}static removeHashFromUrl(e){return Su.canonicalizeUri(e.split("#")[0])}replaceTenantPath(e){const t=this.getUrlComponents(),r=t.PathSegments;return!e||0===r.length||r[0]!==Vs&&r[0]!==Ys||(r[0]=e),Su.constructAuthorityUriFromObject(t)}getUrlComponents(){const e=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),t=this.urlString.match(e);if(!t)throw du(zl);const r={Protocol:t[1],HostNameAndPort:t[4],AbsolutePath:t[5],QueryString:t[7]};let n=r.AbsolutePath.split("/");return n=n.filter((e=>e&&e.length>0)),r.PathSegments=n,r.QueryString&&r.QueryString.endsWith("/")&&(r.QueryString=r.QueryString.substring(0,r.QueryString.length-1)),r}static getDomainFromUrl(e){const t=RegExp("^([^:/?#]+://)?([^/?#]*)"),r=e.match(t);if(!r)throw du(zl);return r[2]}static getAbsoluteUrl(e,t){if(e[0]===$s.FORWARD_SLASH){const r=new Su(t).getUrlComponents();return r.Protocol+"//"+r.HostNameAndPort+e}return e}static constructAuthorityUriFromObject(e){return new Su(e.Protocol+"//"+e.HostNameAndPort+"/"+e.PathSegments.join("/"))}static hashContainsKnownProperties(e){return!!Au(e)}}const Tu={"login.microsoftonline.com":{token_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.com/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/logout"},"login.chinacloudapi.cn":{token_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.chinacloudapi.cn/{tenantid}/discovery/v2.0/keys",issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",authorization_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/logout"},"login.microsoftonline.us":{token_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.us/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/logout"}},Iu={tenant_discovery_endpoint:"https://{canonicalAuthority}/v2.0/.well-known/openid-configuration",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},Eu=new Set;function xu(e,t,r,n){if(n?.trace(`getAliasesFromMetadata called with source: ${r}`),e&&t){const o=_u(t,e);if(o)return n?.trace(`getAliasesFromMetadata: found cloud discovery metadata in ${r}, returning aliases`),o.aliases;n?.trace(`getAliasesFromMetadata: did not find cloud discovery metadata in ${r}`)}return null}function _u(e,t){for(let r=0;r<e.length;r++){const n=e[r];if(n.aliases.includes(t))return n}return null}Iu.metadata.forEach((e=>{e.aliases.forEach((e=>{Eu.add(e)}))}));const Pu="cache_quota_exceeded",Ru="cache_error_unknown",Ou={[Pu]:"Exceeded cache storage capacity.",[Ru]:"Unexpected error occurred when using cache storage."};class Mu extends Error{constructor(e,t){const r=t||(Ou[e]?Ou[e]:Ou[Ru]);super(`${e}: ${r}`),Object.setPrototypeOf(this,Mu.prototype),this.name="CacheError",this.errorCode=e,this.errorMessage=r}}var Nu=r(64583).Promise;class Bu{constructor(e,t,r,n){this.clientId=e,this.cryptoImpl=t,this.commonLogger=r.clone(vl,bl),this.staticAuthorityOptions=n}getAllAccounts(e){return this.buildTenantProfiles(this.getAccountsFilteredBy(e||{}),e)}getAccountInfoFilteredBy(e){const t=this.getAllAccounts(e);return t.length>1?t.sort((e=>e.idTokenClaims?-1:1))[0]:1===t.length?t[0]:null}getBaseAccountInfo(e){const t=this.getAccountsFilteredBy(e);return t.length>0?t[0].getAccountInfo():null}buildTenantProfiles(e,t){return e.flatMap((e=>this.getTenantProfilesFromAccountEntity(e,t?.tenantId,t)))}getTenantedAccountInfoByFilter(e,t,r,n){let o,i=null;if(n&&!this.tenantProfileMatchesFilter(r,n))return null;const a=this.getIdToken(e,t,r.tenantId);return a&&(o=wl(a.secret,this.cryptoImpl.base64Decode),!this.idTokenClaimsMatchTenantProfileFilter(o,n))?null:(i=vu(e,r,o,a?.secret),i)}getTenantProfilesFromAccountEntity(e,t,r){const n=e.getAccountInfo();let o=n.tenantProfiles||new Map;const i=this.getTokenKeys();if(t){const e=o.get(t);if(!e)return[];o=new Map([[t,e]])}const a=[];return o.forEach((e=>{const t=this.getTenantedAccountInfoByFilter(n,i,e,r);t&&a.push(t)})),a}tenantProfileMatchesFilter(e,t){return!(t.localAccountId&&!this.matchLocalAccountIdFromTenantProfile(e,t.localAccountId)||t.name&&e.name!==t.name||void 0!==t.isHomeTenant&&e.isHomeTenant!==t.isHomeTenant)}idTokenClaimsMatchTenantProfileFilter(e,t){if(t){if(t.localAccountId&&!this.matchLocalAccountIdFromTokenClaims(e,t.localAccountId))return!1;if(t.loginHint&&!this.matchLoginHintFromTokenClaims(e,t.loginHint))return!1;if(t.username&&!this.matchUsername(e.preferred_username,t.username))return!1;if(t.name&&!this.matchName(e,t.name))return!1;if(t.sid&&!this.matchSid(e,t.sid))return!1}return!0}async saveCacheRecord(e,t,r){if(!e)throw ml(Yc);try{e.account&&await this.setAccount(e.account,t),e.idToken&&!1!==r?.idToken&&await this.setIdTokenCredential(e.idToken,t),e.accessToken&&!1!==r?.accessToken&&await this.saveAccessToken(e.accessToken,t),e.refreshToken&&!1!==r?.refreshToken&&await this.setRefreshTokenCredential(e.refreshToken,t),e.appMetadata&&this.setAppMetadata(e.appMetadata)}catch(e){throw this.commonLogger?.error("CacheManager.saveCacheRecord: failed"),e instanceof Error?(this.commonLogger?.errorPii(`CacheManager.saveCacheRecord: ${e.message}`,t),"QuotaExceededError"===e.name||"NS_ERROR_DOM_QUOTA_REACHED"===e.name||e.message.includes("exceeded the quota")?(this.commonLogger?.error("CacheManager.saveCacheRecord: exceeded storage quota",t),new Mu(Pu)):new Mu(e.name,e.message)):(this.commonLogger?.errorPii(`CacheManager.saveCacheRecord: ${e}`,t),new Mu(Ru))}}async saveAccessToken(e,t){const r={clientId:e.clientId,credentialType:e.credentialType,environment:e.environment,homeAccountId:e.homeAccountId,realm:e.realm,tokenType:e.tokenType,requestedClaimsHash:e.requestedClaimsHash},n=this.getTokenKeys(),o=pu.fromString(e.target),i=[];n.accessToken.forEach((e=>{if(!this.accessTokenKeyMatchesFilter(e,r,!1))return;const t=this.getAccessTokenCredential(e);t&&this.credentialMatchesFilter(t,r)&&pu.fromString(t.target).intersectingScopeSets(o)&&i.push(this.removeAccessToken(e))})),await Nu.all(i),await this.setAccessTokenCredential(e,t)}getAccountsFilteredBy(e){const t=this.getAccountKeys(),r=[];return t.forEach((t=>{if(!this.isAccountKey(t,e.homeAccountId))return;const n=this.getAccount(t,this.commonLogger);if(!n)return;if(e.homeAccountId&&!this.matchHomeAccountId(n,e.homeAccountId))return;if(e.username&&!this.matchUsername(n.username,e.username))return;if(e.environment&&!this.matchEnvironment(n,e.environment))return;if(e.realm&&!this.matchRealm(n,e.realm))return;if(e.nativeAccountId&&!this.matchNativeAccountId(n,e.nativeAccountId))return;if(e.authorityType&&!this.matchAuthorityType(n,e.authorityType))return;const o={localAccountId:e?.localAccountId,name:e?.name},i=n.tenantProfiles?.filter((e=>this.tenantProfileMatchesFilter(e,o)));i&&0===i.length||r.push(n)})),r}isAccountKey(e,t,r){return!(e.split(rc).length<3||t&&!e.toLowerCase().includes(t.toLowerCase())||r&&!e.toLowerCase().includes(r.toLowerCase()))}isCredentialKey(e){if(e.split(rc).length<6)return!1;const t=e.toLowerCase();if(-1===t.indexOf(nc.ID_TOKEN.toLowerCase())&&-1===t.indexOf(nc.ACCESS_TOKEN.toLowerCase())&&-1===t.indexOf(nc.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())&&-1===t.indexOf(nc.REFRESH_TOKEN.toLowerCase()))return!1;if(t.indexOf(nc.REFRESH_TOKEN.toLowerCase())>-1){const e=`${nc.REFRESH_TOKEN}${rc}${this.clientId}${rc}`,r=`${nc.REFRESH_TOKEN}${rc}${ic}${rc}`;if(-1===t.indexOf(e.toLowerCase())&&-1===t.indexOf(r.toLowerCase()))return!1}else if(-1===t.indexOf(this.clientId.toLowerCase()))return!1;return!0}credentialMatchesFilter(e,t){if(t.clientId&&!this.matchClientId(e,t.clientId))return!1;if(t.userAssertionHash&&!this.matchUserAssertionHash(e,t.userAssertionHash))return!1;if("string"==typeof t.homeAccountId&&!this.matchHomeAccountId(e,t.homeAccountId))return!1;if(t.environment&&!this.matchEnvironment(e,t.environment))return!1;if(t.realm&&!this.matchRealm(e,t.realm))return!1;if(t.credentialType&&!this.matchCredentialType(e,t.credentialType))return!1;if(t.familyId&&!this.matchFamilyId(e,t.familyId))return!1;if(t.target&&!this.matchTarget(e,t.target))return!1;if((t.requestedClaimsHash||e.requestedClaimsHash)&&e.requestedClaimsHash!==t.requestedClaimsHash)return!1;if(e.credentialType===nc.ACCESS_TOKEN_WITH_AUTH_SCHEME){if(t.tokenType&&!this.matchTokenType(e,t.tokenType))return!1;if(t.tokenType===hc.SSH&&t.keyId&&!this.matchKeyId(e,t.keyId))return!1}return!0}getAppMetadataFilteredBy(e){const t=this.getKeys(),r={};return t.forEach((t=>{if(!this.isAppMetadata(t))return;const n=this.getAppMetadata(t);n&&(e.environment&&!this.matchEnvironment(n,e.environment)||e.clientId&&!this.matchClientId(n,e.clientId)||(r[t]=n))})),r}getAuthorityMetadataByAlias(e){const t=this.getAuthorityMetadataKeys();let r=null;return t.forEach((t=>{if(!this.isAuthorityMetadata(t)||-1===t.indexOf(this.clientId))return;const n=this.getAuthorityMetadata(t);n&&-1!==n.aliases.indexOf(e)&&(r=n)})),r}async removeAllAccounts(){const e=this.getAccountKeys(),t=[];e.forEach((e=>{t.push(this.removeAccount(e))})),await Nu.all(t)}async removeAccount(e){const t=this.getAccount(e,this.commonLogger);t&&(await this.removeAccountContext(t),this.removeItem(e))}async removeAccountContext(e){const t=this.getTokenKeys(),r=e.generateAccountId(),n=[];t.idToken.forEach((e=>{0===e.indexOf(r)&&this.removeIdToken(e)})),t.accessToken.forEach((e=>{0===e.indexOf(r)&&n.push(this.removeAccessToken(e))})),t.refreshToken.forEach((e=>{0===e.indexOf(r)&&this.removeRefreshToken(e)})),await Nu.all(n)}async removeAccessToken(e){const t=this.getAccessTokenCredential(e);if(t){if(t.credentialType.toLowerCase()===nc.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase()&&t.tokenType===hc.POP){const e=t.keyId;if(e)try{await this.cryptoImpl.removeTokenBindingKey(e)}catch(e){throw ml(al)}}return this.removeItem(e)}}removeAppMetadata(){return this.getKeys().forEach((e=>{this.isAppMetadata(e)&&this.removeItem(e)})),!0}readAccountFromCache(e){const t=wu.generateAccountCacheKey(e);return this.getAccount(t,this.commonLogger)}getIdToken(e,t,r,n,o){this.commonLogger.trace("CacheManager - getIdToken called");const i={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:nc.ID_TOKEN,clientId:this.clientId,realm:r},a=this.getIdTokensByFilter(i,t),s=a.size;if(s<1)return this.commonLogger.info("CacheManager:getIdToken - No token found"),null;if(s>1){let t=a;if(!r){const r=new Map;a.forEach(((t,n)=>{t.realm===e.tenantId&&r.set(n,t)}));const n=r.size;if(n<1)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account but none match account entity tenant id, returning first result"),a.values().next().value;if(1===n)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account, defaulting to home tenant profile"),r.values().next().value;t=r}return this.commonLogger.info("CacheManager:getIdToken - Multiple matching ID tokens found, clearing them"),t.forEach(((e,t)=>{this.removeIdToken(t)})),n&&o&&n.addFields({multiMatchedID:a.size},o),null}return this.commonLogger.info("CacheManager:getIdToken - Returning ID token"),a.values().next().value}getIdTokensByFilter(e,t){const r=t&&t.idToken||this.getTokenKeys().idToken,n=new Map;return r.forEach((t=>{if(!this.idTokenKeyMatchesFilter(t,{clientId:this.clientId,...e}))return;const r=this.getIdTokenCredential(t);r&&this.credentialMatchesFilter(r,e)&&n.set(t,r)})),n}idTokenKeyMatchesFilter(e,t){const r=e.toLowerCase();return!(t.clientId&&-1===r.indexOf(t.clientId.toLowerCase())||t.homeAccountId&&-1===r.indexOf(t.homeAccountId.toLowerCase()))}removeIdToken(e){this.removeItem(e)}removeRefreshToken(e){this.removeItem(e)}getAccessToken(e,t,r,n,o,i){this.commonLogger.trace("CacheManager - getAccessToken called");const a=pu.createSearchScopes(t.scopes),s=t.authenticationScheme||hc.BEARER,c=s&&s.toLowerCase()!==hc.BEARER.toLowerCase()?nc.ACCESS_TOKEN_WITH_AUTH_SCHEME:nc.ACCESS_TOKEN,l={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:c,clientId:this.clientId,realm:n||e.tenantId,target:a,tokenType:s,keyId:t.sshKid,requestedClaimsHash:t.requestedClaimsHash},u=r&&r.accessToken||this.getTokenKeys().accessToken,d=[];u.forEach((e=>{if(this.accessTokenKeyMatchesFilter(e,l,!0)){const t=this.getAccessTokenCredential(e);t&&this.credentialMatchesFilter(t,l)&&d.push(t)}}));const h=d.length;return h<1?(this.commonLogger.info("CacheManager:getAccessToken - No token found"),null):h>1?(this.commonLogger.info("CacheManager:getAccessToken - Multiple access tokens found, clearing them"),d.forEach((e=>{this.removeAccessToken(El(e))})),o&&i&&o.addFields({multiMatchedAT:d.length},i),null):(this.commonLogger.info("CacheManager:getAccessToken - Returning access token"),d[0])}accessTokenKeyMatchesFilter(e,t,r){const n=e.toLowerCase();if(t.clientId&&-1===n.indexOf(t.clientId.toLowerCase()))return!1;if(t.homeAccountId&&-1===n.indexOf(t.homeAccountId.toLowerCase()))return!1;if(t.realm&&-1===n.indexOf(t.realm.toLowerCase()))return!1;if(t.requestedClaimsHash&&-1===n.indexOf(t.requestedClaimsHash.toLowerCase()))return!1;if(t.target){const e=t.target.asArray();for(let t=0;t<e.length;t++){if(r&&!n.includes(e[t].toLowerCase()))return!1;if(!r&&n.includes(e[t].toLowerCase()))return!0}}return!0}getAccessTokensByFilter(e){const t=this.getTokenKeys(),r=[];return t.accessToken.forEach((t=>{if(!this.accessTokenKeyMatchesFilter(t,e,!0))return;const n=this.getAccessTokenCredential(t);n&&this.credentialMatchesFilter(n,e)&&r.push(n)})),r}getRefreshToken(e,t,r,n,o){this.commonLogger.trace("CacheManager - getRefreshToken called");const i=t?ic:void 0,a={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:nc.REFRESH_TOKEN,clientId:this.clientId,familyId:i},s=r&&r.refreshToken||this.getTokenKeys().refreshToken,c=[];s.forEach((e=>{if(this.refreshTokenKeyMatchesFilter(e,a)){const t=this.getRefreshTokenCredential(e);t&&this.credentialMatchesFilter(t,a)&&c.push(t)}}));const l=c.length;return l<1?(this.commonLogger.info("CacheManager:getRefreshToken - No refresh token found."),null):(l>1&&n&&o&&n.addFields({multiMatchedRT:l},o),this.commonLogger.info("CacheManager:getRefreshToken - returning refresh token"),c[0])}refreshTokenKeyMatchesFilter(e,t){const r=e.toLowerCase();return!(t.familyId&&-1===r.indexOf(t.familyId.toLowerCase())||!t.familyId&&t.clientId&&-1===r.indexOf(t.clientId.toLowerCase())||t.homeAccountId&&-1===r.indexOf(t.homeAccountId.toLowerCase()))}readAppMetadataFromCache(e){const t={environment:e,clientId:this.clientId},r=this.getAppMetadataFilteredBy(t),n=Object.keys(r).map((e=>r[e])),o=n.length;if(o<1)return null;if(o>1)throw ml(Dc);return n[0]}isAppMetadataFOCI(e){const t=this.readAppMetadataFromCache(e);return!(!t||t.familyId!==ic)}matchHomeAccountId(e,t){return!("string"!=typeof e.homeAccountId||t!==e.homeAccountId)}matchLocalAccountIdFromTokenClaims(e,t){return t===(e.oid||e.sub)}matchLocalAccountIdFromTenantProfile(e,t){return e.localAccountId===t}matchName(e,t){return!(t.toLowerCase()!==e.name?.toLowerCase())}matchUsername(e,t){return!(!e||"string"!=typeof e||t?.toLowerCase()!==e.toLowerCase())}matchUserAssertionHash(e,t){return!(!e.userAssertionHash||t!==e.userAssertionHash)}matchEnvironment(e,t){if(this.staticAuthorityOptions){const r=function(e,t){let r;const n=e.canonicalAuthority;if(n){const o=new Su(n).getUrlComponents().HostNameAndPort;r=xu(o,e.cloudDiscoveryMetadata?.metadata,sc,t)||xu(o,Iu.metadata,uc,t)||e.knownAuthorities}return r||[]}(this.staticAuthorityOptions,this.commonLogger);if(r.includes(t)&&r.includes(e.environment))return!0}const r=this.getAuthorityMetadataByAlias(t);return!!(r&&r.aliases.indexOf(e.environment)>-1)}matchCredentialType(e,t){return e.credentialType&&t.toLowerCase()===e.credentialType.toLowerCase()}matchClientId(e,t){return!(!e.clientId||t!==e.clientId)}matchFamilyId(e,t){return!(!e.familyId||t!==e.familyId)}matchRealm(e,t){return!(e.realm?.toLowerCase()!==t.toLowerCase())}matchNativeAccountId(e,t){return!(!e.nativeAccountId||t!==e.nativeAccountId)}matchLoginHintFromTokenClaims(e,t){return e.login_hint===t||e.preferred_username===t||e.upn===t}matchSid(e,t){return e.sid===t}matchAuthorityType(e,t){return!(!e.authorityType||t.toLowerCase()!==e.authorityType.toLowerCase())}matchTarget(e,t){return!(e.credentialType!==nc.ACCESS_TOKEN&&e.credentialType!==nc.ACCESS_TOKEN_WITH_AUTH_SCHEME||!e.target)&&pu.fromString(e.target).containsScopeSet(t)}matchTokenType(e,t){return!(!e.tokenType||e.tokenType!==t)}matchKeyId(e,t){return!(!e.keyId||e.keyId!==t)}isAppMetadata(e){return-1!==e.indexOf(oc)}isAuthorityMetadata(e){return-1!==e.indexOf(ac)}generateAuthorityMetadataCacheKey(e){return`${ac}-${this.clientId}-${e}`}static toObject(e,t){for(const r in t)e[r]=t[r];return e}}class Lu extends Bu{async setAccount(){throw ml(hl)}getAccount(){throw ml(hl)}async setIdTokenCredential(){throw ml(hl)}getIdTokenCredential(){throw ml(hl)}async setAccessTokenCredential(){throw ml(hl)}getAccessTokenCredential(){throw ml(hl)}async setRefreshTokenCredential(){throw ml(hl)}getRefreshTokenCredential(){throw ml(hl)}setAppMetadata(){throw ml(hl)}getAppMetadata(){throw ml(hl)}setServerTelemetry(){throw ml(hl)}getServerTelemetry(){throw ml(hl)}setAuthorityMetadata(){throw ml(hl)}getAuthorityMetadata(){throw ml(hl)}getAuthorityMetadataKeys(){throw ml(hl)}setThrottlingCache(){throw ml(hl)}getThrottlingCache(){throw ml(hl)}removeItem(){throw ml(hl)}getKeys(){throw ml(hl)}getAccountKeys(){throw ml(hl)}getTokenKeys(){throw ml(hl)}}const qu={tokenRenewalOffsetSeconds:300,preventCorsPreflight:!1},Hu={loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:fc.Info,correlationId:$s.EMPTY_STRING},$u={claimsBasedCachingEnabled:!1},Du={async sendGetRequestAsync(){throw ml(hl)},async sendPostRequestAsync(){throw ml(hl)}},Fu={sku:$s.SKU,version:bl,cpu:$s.EMPTY_STRING,os:$s.EMPTY_STRING},Uu={clientSecret:$s.EMPTY_STRING,clientAssertion:void 0},ju={azureCloudInstance:vc,tenant:`${$s.DEFAULT_COMMON_TENANT}`},zu={application:{appName:"",appVersion:""}};function Ku(e){return e.authOptions.authority.options.protocolMode===mc}var Wu=r(64583).Promise;const Gu={sendGetRequestAsync:()=>Wu.reject(ml(hl)),sendPostRequestAsync:()=>Wu.reject(ml(hl))},Vu="acquireTokenByCode",Yu="acquireTokenByRefreshToken",Qu="acquireTokenSilent",Ju="acquireTokenSilentAsync",Xu="acquireTokenPopup",Zu="acquireTokenRedirect",ed="cryptoOptsGetPublicKeyThumbprint",td="cryptoOptsSignJwt",rd="silentCacheClientAcquireToken",nd="silentIframeClientAcquireToken",od="silentRefreshClientAcquireToken",id="ssoSilent",ad="standardInteractionClientGetDiscoveredAuthority",sd="nativeInteractionClientAcquireToken",cd="networkClientSendPostRequestAsync",ld="refreshTokenClientExecutePostToTokenEndpoint",ud="authorizationCodeClientExecutePostToTokenEndpoint",dd="refreshTokenClientExecuteTokenRequest",hd="refreshTokenClientAcquireToken",pd="refreshTokenClientAcquireTokenWithCachedRefreshToken",fd="refreshTokenClientAcquireTokenByRefreshToken",gd="refreshTokenClientCreateTokenRequestBody",md="acquireTokenFromCache",yd="silentFlowClientAcquireCachedToken",vd="silentFlowClientGenerateResultFromCacheRecord",bd="acquireTokenBySilentIframe",wd="initializeBaseRequest",Cd="initializeSilentRequest",Ad="initializeClientApplication",kd="initializeCache",Sd="silentIframeClientTokenHelper",Td="silentHandlerInitiateAuthRequest",Id="silentHandlerMonitorIframeForHash",Ed="silentHandlerLoadFrame",xd="silentHandlerLoadFrameSync",_d="standardInteractionClientCreateAuthCodeClient",Pd="standardInteractionClientGetClientConfiguration",Rd="standardInteractionClientInitializeAuthorizationRequest",Od="getAuthCodeUrl",Md="handleCodeResponseFromServer",Nd="handleCodeResponse",Bd="handleResponseEar",Ld="handleResponsePlatformBroker",qd="handleResponseCode",Hd="updateTokenEndpointAuthority",$d="authClientAcquireToken",Dd="authClientExecuteTokenRequest",Fd="authClientCreateTokenRequestBody",Ud="popTokenGenerateCnf",jd="popTokenGenerateKid",zd="handleServerTokenResponse",Kd="deserializeResponse",Wd="authorityFactoryCreateDiscoveredInstance",Gd="authorityResolveEndpointsAsync",Vd="authorityGetCloudDiscoveryMetadataFromNetwork",Yd="authorityUpdateCloudDiscoveryMetadata",Qd="authorityGetEndpointMetadataFromNetwork",Jd="authorityUpdateEndpointMetadata",Xd="authorityUpdateMetadataWithRegionalInformation",Zd="regionDiscoveryDetectRegion",eh="regionDiscoveryGetRegionFromIMDS",th="regionDiscoveryGetCurrentVersion",rh="acquireTokenByCodeAsync",nh="handleRedirectPromise",oh="handleNativeRedirectPromise",ih="nativeMessageHandlerHandshake",ah="removeHiddenIframe",sh="clearTokensAndKeysWithClaims",ch="cacheManagerGetRefreshToken",lh="importExistingCache",uh="setUserData",dh="localStorageUpdated",hh="generatePkceCodes",ph="generateCodeVerifier",fh="generateCodeChallengeFromVerifier",gh="sha256Digest",mh="getRandomValues",yh="generateHKDF",vh="generateBaseKey",bh="base64Decode",wh="urlEncodeArr",Ch="encrypt",Ah="decrypt",kh="generateEarKey",Sh="decryptEarResponse",Th=(new Map([[Vu,"ATByCode"],[Yu,"ATByRT"],[Qu,"ATS"],[Ju,"ATSAsync"],[Xu,"ATPopup"],[Zu,"ATRedirect"],[ed,"CryptoGetPKThumb"],[td,"CryptoSignJwt"],[rd,"SltCacheClientAT"],[nd,"SltIframeClientAT"],[od,"SltRClientAT"],[id,"SsoSlt"],[ad,"StdIntClientGetDiscAuth"],["fetchAccountIdWithNativeBroker","FetchAccIdWithNtvBroker"],[sd,"NtvIntClientAT"],["baseClientCreateTokenRequestHeaders","BaseClientCreateTReqHead"],[cd,"NetClientSendPost"],[ld,"RTClientExecPost"],[ud,"AuthCodeClientExecPost"],["brokerHandshake","BrokerHandshake"],["acquireTokenByRefreshTokenInBroker","ATByRTInBroker"],["acquireTokenByBroker","ATByBroker"],[dd,"RTClientExecTReq"],[hd,"RTClientAT"],[pd,"RTClientATWithCachedRT"],[fd,"RTClientATByRT"],[gd,"RTClientCreateTReqBody"],[md,"ATFromCache"],[yd,"SltFlowClientATCached"],[vd,"SltFlowClientGenResFromCache"],[bd,"ATBySltIframe"],[wd,"InitBaseReq"],[Cd,"InitSltReq"],[Ad,"InitClientApplication"],[kd,"InitCache"],[lh,"importCache"],[uh,"setUserData"],[dh,"localStorageUpdated"],[Sd,"SIClientTHelper"],[Td,"SHandlerInitAuthReq"],[Id,"SltHandlerMonitorIframeForHash"],[Ed,"SHandlerLoadFrame"],[xd,"SHandlerLoadFrameSync"],[_d,"StdIntClientCreateAuthCodeClient"],[Pd,"StdIntClientGetClientConf"],[Rd,"StdIntClientInitAuthReq"],[Od,"GetAuthCodeUrl"],[Md,"HandleCodeResFromServer"],[Nd,"HandleCodeResp"],[Bd,"HandleRespEar"],[qd,"HandleRespCode"],[Ld,"HandleRespPlatBroker"],[Hd,"UpdTEndpointAuth"],[$d,"AuthClientAT"],[Dd,"AuthClientExecTReq"],[Fd,"AuthClientCreateTReqBody"],[Ud,"PopTGenCnf"],[jd,"PopTGenKid"],[zd,"HandleServerTRes"],[Kd,"DeserializeRes"],[Wd,"AuthFactCreateDiscInst"],[Gd,"AuthResolveEndpointsAsync"],["authorityResolveEndpointsFromLocalSources","AuthResolveEndpointsFromLocal"],[Vd,"AuthGetCDMetaFromNet"],[Yd,"AuthUpdCDMeta"],[Qd,"AuthUpdCDMetaFromNet"],[Jd,"AuthUpdEndpointMeta"],[Xd,"AuthUpdMetaWithRegInfo"],[Zd,"RegDiscDetectReg"],[eh,"RegDiscGetRegFromIMDS"],[th,"RegDiscGetCurrentVer"],[rh,"ATByCodeAsync"],["getEndpointMetadataFromNetwork","GetEndpointMetaFromNet"],["getCloudDiscoveryMetadataFromNetworkMeasurement","GetCDMetaFromNet"],[nh,"HandleRedirectPromise"],[oh,"HandleNtvRedirectPromise"],["updateCloudDiscoveryMetadataMeasurement","UpdateCDMeta"],["usernamePasswordClientAcquireToken","UserPassClientAT"],[ih,"NtvMsgHandlerHandshake"],["nativeGenerateAuthResult","NtvGenAuthRes"],[ah,"RemoveHiddenIframe"],[sh,"ClearTAndKeysWithClaims"],[ch,"CacheManagerGetRT"],[hh,"GenPkceCodes"],[ph,"GenCodeVerifier"],[fh,"GenCodeChallengeFromVerifier"],[gh,"Sha256Digest"],[mh,"GetRandomValues"],[yh,"genHKDF"],[vh,"genBaseKey"],[bh,"b64Decode"],[wh,"urlEncArr"],[Ch,"encrypt"],[Ah,"decrypt"],[kh,"genEarKey"],[Sh,"decryptEarResp"]]),1);new Set(["accessTokenSize","durationMs","idTokenSize","matsSilentStatus","matsHttpStatus","refreshTokenSize","queuedTimeMs","startTimeMs","status","multiMatchedAT","multiMatchedID","multiMatchedRT","unencryptedCacheCount","encryptedCacheExpiredCount"]);class Ih{startMeasurement(){}endMeasurement(){}flushMeasurement(){return null}}class Eh{generateId(){return"callback-id"}startMeasurement(e,t){return{end:()=>null,discard:()=>{},add:()=>{},increment:()=>{},event:{eventId:this.generateId(),status:Th,authority:"",libraryName:"",libraryVersion:"",clientId:"",name:e,startTimeMs:Date.now(),correlationId:t||""},measurement:new Ih}}startPerformanceMeasurement(){return new Ih}calculateQueuedTime(){return 0}addQueueMeasurement(){}setPreQueueTime(){}endMeasurement(){return null}discardMeasurements(){}removePerformanceCallback(){return!0}addPerformanceCallback(){return""}emitEvents(){}addFields(){}incrementFields(){}cacheEventByCorrelationId(){}}const xh="invalid_grant",_h="msal",Ph="msal.js.browser",Rh="53ee284d-920a-4b59-9d30-a60315b26836",Oh="ppnbnpeolgkicgegkbkbjmhlideopiji",Mh="Handshake",Nh="GetToken",Bh="localStorage",Lh="sessionStorage",qh="memoryStorage",Hh="signin",$h="signout",Dh="request.origin",Fh="urlHash",Uh="request.params",jh="code.verifier",zh="interaction.status",Kh="request.native",Wh="msal.account.keys",Gh="msal.token.keys",Vh="wrapper.sku",Yh="wrapper.version",Qh=861,Jh=862;var Xh;!function(e){e.Redirect="redirect",e.Popup="popup",e.Silent="silent",e.None="none"}(Xh||(Xh={}));const Zh={scopes:Ds},ep="msal.db",tp=`${ep}.keys`,rp=[0,5,4];var np=r(64583).Promise;class op{navigateInternal(e,t){return op.defaultNavigateWindow(e,t)}navigateExternal(e,t){return op.defaultNavigateWindow(e,t)}static defaultNavigateWindow(e,t){return t.noHistory?window.location.replace(e):window.location.assign(e),new np((e=>{setTimeout((()=>{e(!0)}),t.timeout)}))}}class ip extends Ac{constructor(e,t,r){super(e.errorCode,e.errorMessage,e.subError),Object.setPrototypeOf(this,ip.prototype),this.name="NetworkError",this.error=e,this.httpStatus=t,this.responseHeaders=r}}function ap(e,t,r,n){return e.errorMessage=`${e.errorMessage}, additionalErrorInfo: error.name:${n?.name}, error.message:${n?.message}`,new ip(e,t,r)}const sp="pkce_not_created",cp="ear_jwk_empty",lp="ear_jwe_empty",up="crypto_nonexistent",dp="empty_navigate_uri",hp="hash_empty_error",pp="no_state_in_hash",fp="hash_does_not_contain_known_properties",gp="unable_to_parse_state",mp="state_interaction_type_mismatch",yp="interaction_in_progress",vp="popup_window_error",bp="empty_window_error",wp="user_cancelled",Cp="monitor_popup_timeout",Ap="monitor_window_timeout",kp="redirect_in_iframe",Sp="block_iframe_reload",Tp="block_nested_popups",Ip="iframe_closed_prematurely",Ep="silent_logout_unsupported",xp="no_account_error",_p="silent_prompt_value_error",Pp="no_token_request_cache_error",Rp="unable_to_parse_token_request_cache_error",Op="auth_request_not_set_error",Mp="invalid_cache_type",Np="non_browser_environment",Bp="database_not_open",Lp="no_network_connectivity",qp="post_request_failed",Hp="get_request_failed",$p="failed_to_parse_response",Dp="unable_to_load_token",Fp="crypto_key_not_found",Up="auth_code_required",jp="auth_code_or_nativeAccountId_required",zp="spa_code_and_nativeAccountId_present",Kp="database_unavailable",Wp="unable_to_acquire_token_from_native_platform",Gp="native_handshake_timeout",Vp="native_extension_not_installed",Yp="native_connection_not_established",Qp="uninitialized_public_client_application",Jp="native_prompt_not_supported",Xp="invalid_base64_string",Zp="invalid_pop_token_request",ef="failed_to_build_headers",tf="failed_to_parse_headers",rf="failed_to_decrypt_ear_response",nf="For more visit: aka.ms/msaljs/browser-errors",of={[sp]:"The PKCE code challenge and verifier could not be generated.",[cp]:"No EAR encryption key provided. This is unexpected.",[lp]:"Server response does not contain ear_jwe property. This is unexpected.",[up]:"The crypto object or function is not available.",[dp]:"Navigation URI is empty. Please check stack trace for more info.",[hp]:`Hash value cannot be processed because it is empty. Please verify that your redirectUri is not clearing the hash. ${nf}`,[pp]:"Hash does not contain state. Please verify that the request originated from msal.",[fp]:`Hash does not contain known properites. Please verify that your redirectUri is not changing the hash.  ${nf}`,[gp]:"Unable to parse state. Please verify that the request originated from msal.",[mp]:"Hash contains state but the interaction type does not match the caller.",[yp]:`Interaction is currently in progress. Please ensure that this interaction has been completed before calling an interactive API.   ${nf}`,[vp]:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser.",[bp]:"window.open returned null or undefined window object.",[wp]:"User cancelled the flow.",[Cp]:`Token acquisition in popup failed due to timeout.  ${nf}`,[Ap]:`Token acquisition in iframe failed due to timeout.  ${nf}`,[kp]:"Redirects are not supported for iframed or brokered applications. Please ensure you are using MSAL.js in a top frame of the window if using the redirect APIs, or use the popup APIs.",[Sp]:`Request was blocked inside an iframe because MSAL detected an authentication response.  ${nf}`,[Tp]:"Request was blocked inside a popup because MSAL detected it was running in a popup.",[Ip]:"The iframe being monitored was closed prematurely.",[Ep]:"Silent logout not supported. Please call logoutRedirect or logoutPopup instead.",[xp]:"No account object provided to acquireTokenSilent and no active account has been set. Please call setActiveAccount or provide an account on the request.",[_p]:"The value given for the prompt value is not valid for silent requests - must be set to 'none' or 'no_session'.",[Pp]:"No token request found in cache.",[Rp]:"The cached token request could not be parsed.",[Op]:"Auth Request not set. Please ensure initiateAuthRequest was called from the InteractionHandler",[Mp]:"Invalid cache type",[Np]:"Login and token requests are not supported in non-browser environments.",[Bp]:"Database is not open!",[Lp]:"No network connectivity. Check your internet connection.",[qp]:"Network request failed: If the browser threw a CORS error, check that the redirectUri is registered in the Azure App Portal as type 'SPA'",[Hp]:"Network request failed. Please check the network trace to determine root cause.",[$p]:"Failed to parse network response. Check network trace.",[Dp]:"Error loading token to cache.",[Fp]:"Cryptographic Key or Keypair not found in browser storage.",[Up]:"An authorization code must be provided (as the `code` property on the request) to this flow.",[jp]:"An authorization code or nativeAccountId must be provided to this flow.",[zp]:"Request cannot contain both spa code and native account id.",[Kp]:"IndexedDB, which is required for persistent cryptographic key storage, is unavailable. This may be caused by browser privacy features which block persistent storage in third-party contexts.",[Wp]:`Unable to acquire token from native platform.  ${nf}`,[Gp]:"Timed out while attempting to establish connection to browser extension",[Vp]:"Native extension is not installed. If you think this is a mistake call the initialize function.",[Yp]:`Connection to native platform has not been established. Please install a compatible browser extension and run initialize().  ${nf}`,[Qp]:`You must call and await the initialize function before attempting to call any other MSAL API.  ${nf}`,[Jp]:"The provided prompt is not supported by the native platform. This request should be routed to the web based flow.",[Xp]:"Invalid base64 encoded string.",[Zp]:"Invalid PoP token request. The request should not have both a popKid value and signPopToken set to true.",[ef]:"Failed to build request headers object.",[tf]:"Failed to parse response headers",[rf]:"Failed to decrypt ear response"};class af extends Ac{constructor(e,t){super(e,of[e],t),Object.setPrototypeOf(this,af.prototype),this.name="BrowserAuthError"}}function sf(e,t){return new af(e,t)}class cf{async sendGetRequestAsync(e,t){let r,n={},o=0;const i=lf(t);try{r=await fetch(e,{method:"GET",headers:i})}catch(e){throw ap(sf(window.navigator.onLine?Hp:Lp),void 0,void 0,e)}n=uf(r.headers);try{return o=r.status,{headers:n,body:await r.json(),status:o}}catch(e){throw ap(sf($p),o,n,e)}}async sendPostRequestAsync(e,t){const r=t&&t.body||"",n=lf(t);let o,i=0,a={};try{o=await fetch(e,{method:"POST",headers:n,body:r})}catch(e){throw ap(sf(window.navigator.onLine?qp:Lp),void 0,void 0,e)}a=uf(o.headers);try{return i=o.status,{headers:a,body:await o.json(),status:i}}catch(e){throw ap(sf($p),i,a,e)}}}function lf(e){try{const t=new Headers;if(!e||!e.headers)return t;const r=e.headers;return Object.entries(r).forEach((([e,r])=>{t.append(e,r)})),t}catch(e){throw ap(sf(ef),void 0,void 0,e)}}function uf(e){try{const t={};return e.forEach(((e,r)=>{t[r]=e})),t}catch(e){throw sf(tf)}}function df(e){return encodeURIComponent(pf(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"))}function hf(e){return ff(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function pf(e){return ff((new TextEncoder).encode(e))}function ff(e){const t=Array.from(e,(e=>String.fromCodePoint(e))).join("");return btoa(t)}function gf(e){return(new TextDecoder).decode(mf(e))}function mf(e){let t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw sf(Xp)}const r=atob(t);return Uint8Array.from(r,(e=>e.codePointAt(0)||0))}const yf="AES-GCM",vf="HKDF",bf="SHA-256",wf=new Uint8Array([1,0,1]),Cf="0123456789abcdef",Af=new Uint32Array(1),kf="raw",Sf="encrypt",Tf="decrypt",If={name:"RSASSA-PKCS1-v1_5",hash:bf,modulusLength:2048,publicExponent:wf};async function Ef(e,t,r){t?.addQueueMeasurement(gh,r);const n=(new TextEncoder).encode(e);return window.crypto.subtle.digest(bf,n)}function xf(e){return window.crypto.getRandomValues(e)}function _f(){return window.crypto.getRandomValues(Af),Af[0]}function Pf(){const e=Date.now(),t=1024*_f()+(1023&_f()),r=new Uint8Array(16),n=Math.trunc(t/2**30),o=t&2**30-1,i=_f();r[0]=e/2**40,r[1]=e/2**32,r[2]=e/2**24,r[3]=e/65536,r[4]=e/256,r[5]=e,r[6]=112|n>>>8,r[7]=n,r[8]=128|o>>>24,r[9]=o>>>16,r[10]=o>>>8,r[11]=o,r[12]=i>>>24,r[13]=i>>>16,r[14]=i>>>8,r[15]=i;let a="";for(let e=0;e<r.length;e++)a+=Cf.charAt(r[e]>>>4),a+=Cf.charAt(15&r[e]),3!==e&&5!==e&&7!==e&&9!==e||(a+="-");return a}async function Rf(e){return window.crypto.subtle.exportKey("jwk",e)}async function Of(){const e=await Nf(),t={alg:"dir",kty:"oct",k:hf(new Uint8Array(e))};return pf(JSON.stringify(t))}async function Mf(e,t){const r=t.split(".");if(5!==r.length)throw sf(rf,"jwe_length");const n=await async function(e){const t=gf(e),r=mf(JSON.parse(t).k);return window.crypto.subtle.importKey(kf,r,yf,!1,[Tf])}(e).catch((()=>{throw sf(rf,"import_key")}));try{const e=(new TextEncoder).encode(r[0]),t=mf(r[2]),o=mf(r[3]),i=mf(r[4]),a=8*i.byteLength,s=new Uint8Array(o.length+i.length);s.set(o),s.set(i,o.length);const c=await window.crypto.subtle.decrypt({name:yf,iv:t,tagLength:a,additionalData:e},n,s);return(new TextDecoder).decode(c)}catch(e){throw sf(rf,"decrypt")}}async function Nf(){const e=await window.crypto.subtle.generateKey({name:yf,length:256},!0,[Sf,Tf]);return window.crypto.subtle.exportKey(kf,e)}async function Bf(e){return window.crypto.subtle.importKey(kf,e,vf,!1,["deriveKey"])}async function Lf(e,t,r){return window.crypto.subtle.deriveKey({name:vf,salt:t,hash:bf,info:(new TextEncoder).encode(r)},e,{name:yf,length:256},!1,[Sf,Tf])}async function qf(e,t,r){const n=(new TextEncoder).encode(t),o=window.crypto.getRandomValues(new Uint8Array(16)),i=await Lf(e,o,r),a=await window.crypto.subtle.encrypt({name:yf,iv:new Uint8Array(12)},i,n);return{data:hf(new Uint8Array(a)),nonce:hf(o)}}async function Hf(e,t,r,n){const o=mf(n),i=await Lf(e,mf(t),r),a=await window.crypto.subtle.decrypt({name:yf,iv:new Uint8Array(12)},i,o);return(new TextDecoder).decode(a)}async function $f(e){const t=await Ef(e);return hf(new Uint8Array(t))}const Df="storage_not_supported",Ff="stubbed_public_client_application_called",Uf="in_mem_redirect_unavailable",jf={[Df]:"Given storage configuration option was not supported.",[Ff]:"Stub instance of Public Client Application was called. If using msal-react, please ensure context is not used without a provider. For more visit: aka.ms/msaljs/browser-errors",[Uf]:"Redirect cannot be supported. In-memory storage was selected and storeAuthStateInCookie=false, which would cause the library to be unable to handle the incoming hash. If you would like to use the redirect API, please use session/localStorage or set storeAuthStateInCookie=true."};class zf extends Ac{constructor(e,t){super(e,t),this.name="BrowserConfigurationAuthError",Object.setPrototypeOf(this,zf.prototype)}}function Kf(e){return new zf(e,jf[e])}function Wf(e){e.location.hash="","function"==typeof e.history.replaceState&&e.history.replaceState(null,"",`${e.location.origin}${e.location.pathname}${e.location.search}`)}function Gf(){return window.parent!==window}function Vf(){return"undefined"!=typeof window&&window.location?window.location.href.split("?")[0].split("#")[0]:""}function Yf(){if("undefined"==typeof window)throw sf(Np)}function Qf(e){if(!e)throw sf(Qp)}function Jf(e){Yf(),function(){if(Su.hashContainsKnownProperties(window.location.hash)&&Gf())throw sf(Sp)}(),function(){if("undefined"!=typeof window&&window.opener&&window.opener!==window&&"string"==typeof window.name&&0===window.name.indexOf(`${_h}.`))throw sf(Tp)}(),Qf(e)}function Xf(e,t){if(Jf(e),function(e){if(Gf()&&!e)throw sf(kp)}(t.system.allowRedirectInIframe),t.cache.cacheLocation===qh&&!t.cache.storeAuthStateInCookie)throw Kf(Uf)}function Zf(e){const t=document.createElement("link");t.rel="preconnect",t.href=new URL(e).origin,t.crossOrigin="anonymous",document.head.appendChild(t),window.setTimeout((()=>{try{document.head.removeChild(t)}catch{}}),1e4)}const eg="4.12.0";class tg{static loggerCallback(e,t){switch(e){case fc.Error:return void console.error(t);case fc.Info:return void console.info(t);case fc.Verbose:return void console.debug(t);case fc.Warning:return void console.warn(t);default:return void console.log(t)}}constructor(e){let t;this.browserEnvironment="undefined"!=typeof window,this.config=function({auth:e,cache:t,system:r,telemetry:n},o){const i={clientId:$s.EMPTY_STRING,authority:`${$s.DEFAULT_AUTHORITY}`,knownAuthorities:[],cloudDiscoveryMetadata:$s.EMPTY_STRING,authorityMetadata:$s.EMPTY_STRING,redirectUri:"undefined"!=typeof window?Vf():"",postLogoutRedirectUri:$s.EMPTY_STRING,navigateToLoginRequestUrl:!0,clientCapabilities:[],protocolMode:"AAD",OIDCOptions:{serverResponseType:"fragment",defaultScopes:[$s.OPENID_SCOPE,$s.PROFILE_SCOPE,$s.OFFLINE_ACCESS_SCOPE]},azureCloudOptions:{azureCloudInstance:vc,tenant:$s.EMPTY_STRING},skipAuthorityMetadataCache:!1,supportsNestedAppAuth:!1,instanceAware:!1,encodeExtraQueryParams:!1},a={cacheLocation:Lh,temporaryCacheLocation:Lh,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!(!t||t.cacheLocation!==Bh),claimsBasedCachingEnabled:!1},s={loggerCallback:()=>{},logLevel:fc.Info,piiLoggingEnabled:!1},c={...{...qu,loggerOptions:s,networkClient:o?new cf:Gu,navigationClient:new op,loadFrameTimeout:0,windowHashTimeout:r?.loadFrameTimeout||6e4,iframeHashTimeout:r?.loadFrameTimeout||1e4,navigateFrameWait:0,redirectNavigationTimeout:3e4,asyncPopups:!1,allowRedirectInIframe:!1,allowPlatformBroker:!1,nativeBrokerHandshakeTimeout:r?.nativeBrokerHandshakeTimeout||2e3,pollIntervalMilliseconds:30},...r,loggerOptions:r?.loggerOptions||s},l={application:{appName:$s.EMPTY_STRING,appVersion:$s.EMPTY_STRING},client:new Eh};if(e?.protocolMode!==mc&&e?.OIDCOptions&&new gc(c.loggerOptions).warning(JSON.stringify(du(au))),e?.protocolMode&&e.protocolMode===mc&&c?.allowPlatformBroker)throw du(su);return{auth:{...i,...e,OIDCOptions:{...i.OIDCOptions,...e?.OIDCOptions}},cache:{...a,...t},system:c,telemetry:{...l,...n}}}(e,this.browserEnvironment);try{t=window[Lh]}catch(e){}const r=t?.getItem("msal.browser.log.level"),n=t?.getItem("msal.browser.log.pii")?.toLowerCase(),o="true"===n||"false"!==n&&void 0,i={...this.config.system.loggerOptions},a=r&&Object.keys(fc).includes(r)?fc[r]:void 0;a&&(i.loggerCallback=tg.loggerCallback,i.logLevel=a),void 0!==o&&(i.piiLoggingEnabled=o),this.logger=new gc(i,"@azure/msal-browser",eg),this.available=!1}getConfig(){return this.config}getLogger(){return this.logger}isAvailable(){return this.available}isBrowserEnvironment(){return this.browserEnvironment}}class rg extends tg{getModuleName(){return rg.MODULE_NAME}getId(){return rg.ID}async initialize(){return this.available="undefined"!=typeof window,this.available}}rg.MODULE_NAME="",rg.ID="StandardOperatingContext";const ng="missing_kid_error",og="missing_alg_error",ig={[ng]:"The JOSE Header for the requested JWT, JWS or JWK object requires a keyId to be configured as the 'kid' header claim. No 'kid' value was provided.",[og]:"The JOSE Header for the requested JWT, JWS or JWK object requires an algorithm to be specified as the 'alg' header claim. No 'alg' value was provided."};class ag extends Ac{constructor(e,t){super(e,t),this.name="JoseHeaderError",Object.setPrototypeOf(this,ag.prototype)}}function sg(e){return new ag(e,ig[e])}class cg{constructor(e){this.typ=e.typ,this.alg=e.alg,this.kid=e.kid}static getShrHeaderString(e){if(!e.kid)throw sg(ng);if(!e.alg)throw sg(og);const t=new cg({typ:e.typ||"pop",kid:e.kid,alg:e.alg});return JSON.stringify(t)}}var lg=r(64583).Promise;class ug{constructor(){this.dbName=ep,this.version=1,this.tableName=tp,this.dbOpen=!1}async open(){return new lg(((e,t)=>{const r=window.indexedDB.open(this.dbName,this.version);r.addEventListener("upgradeneeded",(e=>{e.target.result.createObjectStore(this.tableName)})),r.addEventListener("success",(t=>{const r=t;this.db=r.target.result,this.dbOpen=!0,e()})),r.addEventListener("error",(()=>t(sf(Kp))))}))}closeConnection(){const e=this.db;e&&this.dbOpen&&(e.close(),this.dbOpen=!1)}async validateDbIsOpen(){if(!this.dbOpen)return this.open()}async getItem(e){return await this.validateDbIsOpen(),new lg(((t,r)=>{if(!this.db)return r(sf(Bp));const n=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).get(e);n.addEventListener("success",(e=>{const r=e;this.closeConnection(),t(r.target.result)})),n.addEventListener("error",(e=>{this.closeConnection(),r(e)}))}))}async setItem(e,t){return await this.validateDbIsOpen(),new lg(((r,n)=>{if(!this.db)return n(sf(Bp));const o=this.db.transaction([this.tableName],"readwrite").objectStore(this.tableName).put(t,e);o.addEventListener("success",(()=>{this.closeConnection(),r()})),o.addEventListener("error",(e=>{this.closeConnection(),n(e)}))}))}async removeItem(e){return await this.validateDbIsOpen(),new lg(((t,r)=>{if(!this.db)return r(sf(Bp));const n=this.db.transaction([this.tableName],"readwrite").objectStore(this.tableName).delete(e);n.addEventListener("success",(()=>{this.closeConnection(),t()})),n.addEventListener("error",(e=>{this.closeConnection(),r(e)}))}))}async getKeys(){return await this.validateDbIsOpen(),new lg(((e,t)=>{if(!this.db)return t(sf(Bp));const r=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).getAllKeys();r.addEventListener("success",(t=>{const r=t;this.closeConnection(),e(r.target.result)})),r.addEventListener("error",(e=>{this.closeConnection(),t(e)}))}))}async containsKey(e){return await this.validateDbIsOpen(),new lg(((t,r)=>{if(!this.db)return r(sf(Bp));const n=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).count(e);n.addEventListener("success",(e=>{const r=e;this.closeConnection(),t(1===r.target.result)})),n.addEventListener("error",(e=>{this.closeConnection(),r(e)}))}))}async deleteDatabase(){return this.db&&this.dbOpen&&this.closeConnection(),new lg(((e,t)=>{const r=window.indexedDB.deleteDatabase(ep),n=setTimeout((()=>t(!1)),200);r.addEventListener("success",(()=>(clearTimeout(n),e(!0)))),r.addEventListener("blocked",(()=>(clearTimeout(n),e(!0)))),r.addEventListener("error",(()=>(clearTimeout(n),t(!1))))}))}}class dg{constructor(){this.cache=new Map}async initialize(){}getItem(e){return this.cache.get(e)||null}getUserData(e){return this.getItem(e)}setItem(e,t){this.cache.set(e,t)}async setUserData(e,t){this.setItem(e,t)}removeItem(e){this.cache.delete(e)}getKeys(){const e=[];return this.cache.forEach(((t,r)=>{e.push(r)})),e}containsKey(e){return this.cache.has(e)}clear(){this.cache.clear()}}class hg{constructor(e){this.inMemoryCache=new dg,this.indexedDBCache=new ug,this.logger=e}handleDatabaseAccessError(e){if(!(e instanceof af&&e.errorCode===Kp))throw e;this.logger.error("Could not access persistent storage. This may be caused by browser privacy features which block persistent storage in third-party contexts.")}async getItem(e){const t=this.inMemoryCache.getItem(e);if(!t)try{return this.logger.verbose("Queried item not found in in-memory cache, now querying persistent storage."),await this.indexedDBCache.getItem(e)}catch(e){this.handleDatabaseAccessError(e)}return t}async setItem(e,t){this.inMemoryCache.setItem(e,t);try{await this.indexedDBCache.setItem(e,t)}catch(e){this.handleDatabaseAccessError(e)}}async removeItem(e){this.inMemoryCache.removeItem(e);try{await this.indexedDBCache.removeItem(e)}catch(e){this.handleDatabaseAccessError(e)}}async getKeys(){const e=this.inMemoryCache.getKeys();if(0===e.length)try{return this.logger.verbose("In-memory cache is empty, now querying persistent storage."),await this.indexedDBCache.getKeys()}catch(e){this.handleDatabaseAccessError(e)}return e}async containsKey(e){const t=this.inMemoryCache.containsKey(e);if(!t)try{return this.logger.verbose("Key not found in in-memory cache, now querying persistent storage."),await this.indexedDBCache.containsKey(e)}catch(e){this.handleDatabaseAccessError(e)}return t}clearInMemory(){this.logger.verbose("Deleting in-memory keystore"),this.inMemoryCache.clear(),this.logger.verbose("In-memory keystore deleted")}async clearPersistent(){try{this.logger.verbose("Deleting persistent keystore");const e=await this.indexedDBCache.deleteDatabase();return e&&this.logger.verbose("Persistent keystore deleted"),e}catch(e){return this.handleDatabaseAccessError(e),!1}}}class pg{constructor(e,t,r){this.logger=e,function(e){if(!window)throw sf(Np);if(!window.crypto)throw sf(up);if(!e&&!window.crypto.subtle)throw sf(up,"crypto_subtle_undefined")}(r??!1),this.cache=new hg(this.logger),this.performanceClient=t}createNewGuid(){return Pf()}base64Encode(e){return pf(e)}base64Decode(e){return gf(e)}base64UrlEncode(e){return df(e)}encodeKid(e){return this.base64UrlEncode(JSON.stringify({kid:e}))}async getPublicKeyThumbprint(e){const t=this.performanceClient?.startMeasurement(ed,e.correlationId),r=await async function(e,t){return window.crypto.subtle.generateKey(If,e,t)}(pg.EXTRACTABLE,pg.POP_KEY_USAGES),n=await Rf(r.publicKey),o=fg({e:n.e,kty:n.kty,n:n.n}),i=await this.hashString(o),a=await Rf(r.privateKey),s=await async function(e){return window.crypto.subtle.importKey("jwk",e,If,!1,["sign"])}(a);return await this.cache.setItem(i,{privateKey:s,publicKey:r.publicKey,requestMethod:e.resourceRequestMethod,requestUri:e.resourceRequestUri}),t&&t.end({success:!0}),i}async removeTokenBindingKey(e){return await this.cache.removeItem(e),!await this.cache.containsKey(e)}async clearKeystore(){this.cache.clearInMemory();try{return await this.cache.clearPersistent(),!0}catch(e){return e instanceof Error?this.logger.error(`Clearing keystore failed with error: ${e.message}`):this.logger.error("Clearing keystore failed with unknown error"),!1}}async signJwt(e,t,r,n){const o=this.performanceClient?.startMeasurement(td,n),i=await this.cache.getItem(t);if(!i)throw sf(Fp);const a=await Rf(i.publicKey),s=fg(a),c=df(JSON.stringify({kid:t})),l=df(cg.getShrHeaderString({...r?.header,alg:a.alg,kid:c}));e.cnf={jwk:JSON.parse(s)};const u=`${l}.${df(JSON.stringify(e))}`,d=(new TextEncoder).encode(u),h=await async function(e,t){return window.crypto.subtle.sign(If,e,t)}(i.privateKey,d),p=`${u}.${hf(new Uint8Array(h))}`;return o&&o.end({success:!0}),p}async hashString(e){return $f(e)}}function fg(e){return JSON.stringify(e,Object.keys(e).sort())}pg.POP_KEY_USAGES=["sign","verify"],pg.EXTRACTABLE=!0;const gg=(e,t,r,n,o)=>(...i)=>{r.trace(`Executing function ${t}`);const a=n?.startMeasurement(t,o);if(o){const e=t+"CallCount";n?.incrementFields({[e]:1},o)}try{const n=e(...i);return a?.end({success:!0}),r.trace(`Returning result from ${t}`),n}catch(e){r.trace(`Error occurred in ${t}`);try{r.trace(JSON.stringify(e))}catch(e){r.trace("Unable to print error message.")}throw a?.end({success:!1},e),e}},mg=(e,t,r,n,o)=>(...i)=>{r.trace(`Executing function ${t}`);const a=n?.startMeasurement(t,o);if(o){const e=t+"CallCount";n?.incrementFields({[e]:1},o)}return n?.setPreQueueTime(t,o),e(...i).then((e=>(r.trace(`Returning result from ${t}`),a?.end({success:!0}),e))).catch((e=>{r.trace(`Error occurred in ${t}`);try{r.trace(JSON.stringify(e))}catch(e){r.trace("Unable to print error message.")}throw a?.end({success:!1},e),e}))};class yg{constructor(e,t,r,n){this.networkInterface=e,this.logger=t,this.performanceClient=r,this.correlationId=n}async detectRegion(e,t){this.performanceClient?.addQueueMeasurement(Zd,this.correlationId);let r=e;if(r)t.region_source="3";else{const e=yg.IMDS_OPTIONS;try{const n=await mg(this.getRegionFromIMDS.bind(this),eh,this.logger,this.performanceClient,this.correlationId)($s.IMDS_VERSION,e);if(200===n.status&&(r=n.body,t.region_source="4"),400===n.status){const n=await mg(this.getCurrentVersion.bind(this),th,this.logger,this.performanceClient,this.correlationId)(e);if(!n)return t.region_source="1",null;const o=await mg(this.getRegionFromIMDS.bind(this),eh,this.logger,this.performanceClient,this.correlationId)(n,e);200===o.status&&(r=o.body,t.region_source="4")}}catch(e){return t.region_source="1",null}}return r||(t.region_source="1"),r||null}async getRegionFromIMDS(e,t){return this.performanceClient?.addQueueMeasurement(eh,this.correlationId),this.networkInterface.sendGetRequestAsync(`${$s.IMDS_ENDPOINT}?api-version=${e}&format=text`,t,$s.IMDS_TIMEOUT)}async getCurrentVersion(e){this.performanceClient?.addQueueMeasurement(th,this.correlationId);try{const t=await this.networkInterface.sendGetRequestAsync(`${$s.IMDS_ENDPOINT}?format=json`,e);return 400===t.status&&t.body&&t.body["newest-versions"]&&t.body["newest-versions"].length>0?t.body["newest-versions"][0]:null}catch(e){return null}}}yg.IMDS_OPTIONS={headers:{Metadata:"true"}};class vg{constructor(e,t,r,n,o,i,a,s){this.canonicalAuthority=e,this._canonicalAuthority.validateAsUri(),this.networkInterface=t,this.cacheManager=r,this.authorityOptions=n,this.regionDiscoveryMetadata={region_used:void 0,region_source:void 0,region_outcome:void 0},this.logger=o,this.performanceClient=a,this.correlationId=i,this.managedIdentity=s||!1,this.regionDiscovery=new yg(t,this.logger,this.performanceClient,this.correlationId)}getAuthorityType(e){if(e.HostNameAndPort.endsWith($s.CIAM_AUTH_URL))return 3;const t=e.PathSegments;if(t.length)switch(t[0].toLowerCase()){case $s.ADFS:return 1;case $s.DSTS:return 2}return 0}get authorityType(){return this.getAuthorityType(this.canonicalAuthorityUrlComponents)}get protocolMode(){return this.authorityOptions.protocolMode}get options(){return this.authorityOptions}get canonicalAuthority(){return this._canonicalAuthority.urlString}set canonicalAuthority(e){this._canonicalAuthority=new Su(e),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null}get canonicalAuthorityUrlComponents(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents}get hostnameAndPort(){return this.canonicalAuthorityUrlComponents.HostNameAndPort.toLowerCase()}get tenant(){return this.canonicalAuthorityUrlComponents.PathSegments[0]}get authorizationEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.authorization_endpoint);throw ml(xc)}get tokenEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint);throw ml(xc)}get deviceCodeEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint.replace("/token","/devicecode"));throw ml(xc)}get endSessionEndpoint(){if(this.discoveryComplete()){if(!this.metadata.end_session_endpoint)throw ml(sl);return this.replacePath(this.metadata.end_session_endpoint)}throw ml(xc)}get selfSignedJwtAudience(){if(this.discoveryComplete())return this.replacePath(this.metadata.issuer);throw ml(xc)}get jwksUri(){if(this.discoveryComplete())return this.replacePath(this.metadata.jwks_uri);throw ml(xc)}canReplaceTenant(e){return 1===e.PathSegments.length&&!vg.reservedTenantDomains.has(e.PathSegments[0])&&0===this.getAuthorityType(e)&&this.protocolMode!==mc}replaceTenant(e){return e.replace(/{tenant}|{tenantid}/g,this.tenant)}replacePath(e){let t=e;const r=new Su(this.metadata.canonical_authority).getUrlComponents(),n=r.PathSegments;return this.canonicalAuthorityUrlComponents.PathSegments.forEach(((e,o)=>{let i=n[o];if(0===o&&this.canReplaceTenant(r)){const e=new Su(this.metadata.authorization_endpoint).getUrlComponents().PathSegments[0];i!==e&&(this.logger.verbose(`Replacing tenant domain name ${i} with id ${e}`),i=e)}e!==i&&(t=t.replace(`/${i}/`,`/${e}/`))})),this.replaceTenant(t)}get defaultOpenIdConfigurationEndpoint(){const e=this.hostnameAndPort;return this.canonicalAuthority.endsWith("v2.0/")||1===this.authorityType||this.protocolMode===mc&&!this.isAliasOfKnownMicrosoftAuthority(e)?`${this.canonicalAuthority}.well-known/openid-configuration`:`${this.canonicalAuthority}v2.0/.well-known/openid-configuration`}discoveryComplete(){return!!this.metadata}async resolveEndpointsAsync(){this.performanceClient?.addQueueMeasurement(Gd,this.correlationId);const e=this.getCurrentMetadataEntity(),t=await mg(this.updateCloudDiscoveryMetadata.bind(this),Yd,this.logger,this.performanceClient,this.correlationId)(e);this.canonicalAuthority=this.canonicalAuthority.replace(this.hostnameAndPort,e.preferred_network);const r=await mg(this.updateEndpointMetadata.bind(this),Jd,this.logger,this.performanceClient,this.correlationId)(e);this.updateCachedMetadata(e,t,{source:r}),this.performanceClient?.addFields({cloudDiscoverySource:t,authorityEndpointSource:r},this.correlationId)}getCurrentMetadataEntity(){let e=this.cacheManager.getAuthorityMetadataByAlias(this.hostnameAndPort);return e||(e={aliases:[],preferred_cache:this.hostnameAndPort,preferred_network:this.hostnameAndPort,canonical_authority:this.canonicalAuthority,authorization_endpoint:"",token_endpoint:"",end_session_endpoint:"",issuer:"",aliasesFromNetwork:!1,endpointsFromNetwork:!1,expiresAt:ql(),jwks_uri:""}),e}updateCachedMetadata(e,t,r){t!==cc&&r?.source!==cc&&(e.expiresAt=ql(),e.canonical_authority=this.canonicalAuthority);const n=this.cacheManager.generateAuthorityMetadataCacheKey(e.preferred_cache);this.cacheManager.setAuthorityMetadata(n,e),this.metadata=e}async updateEndpointMetadata(e){this.performanceClient?.addQueueMeasurement(Jd,this.correlationId);const t=this.updateEndpointMetadataFromLocalSources(e);if(t)return t.source===uc&&this.authorityOptions.azureRegionConfiguration?.azureRegion&&t.metadata&&(Hl(e,await mg(this.updateMetadataWithRegionalInformation.bind(this),Xd,this.logger,this.performanceClient,this.correlationId)(t.metadata),!1),e.canonical_authority=this.canonicalAuthority),t.source;let r=await mg(this.getEndpointMetadataFromNetwork.bind(this),Qd,this.logger,this.performanceClient,this.correlationId)();if(r)return this.authorityOptions.azureRegionConfiguration?.azureRegion&&(r=await mg(this.updateMetadataWithRegionalInformation.bind(this),Xd,this.logger,this.performanceClient,this.correlationId)(r)),Hl(e,r,!0),lc;throw ml(Pc,this.defaultOpenIdConfigurationEndpoint)}updateEndpointMetadataFromLocalSources(e){this.logger.verbose("Attempting to get endpoint metadata from authority configuration");const t=this.getEndpointMetadataFromConfig();if(t)return this.logger.verbose("Found endpoint metadata in authority configuration"),Hl(e,t,!1),{source:sc};if(this.logger.verbose("Did not find endpoint metadata in the config... Attempting to get endpoint metadata from the hardcoded values."),this.authorityOptions.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get endpoint metadata from the network metadata cache.");else{const t=this.getEndpointMetadataFromHardcodedValues();if(t)return Hl(e,t,!1),{source:uc,metadata:t};this.logger.verbose("Did not find endpoint metadata in hardcoded values... Attempting to get endpoint metadata from the network metadata cache.")}const r=Dl(e);return this.isAuthoritySameType(e)&&e.endpointsFromNetwork&&!r?(this.logger.verbose("Found endpoint metadata in the cache."),{source:cc}):(r&&this.logger.verbose("The metadata entity is expired."),null)}isAuthoritySameType(e){return new Su(e.canonical_authority).getUrlComponents().PathSegments.length===this.canonicalAuthorityUrlComponents.PathSegments.length}getEndpointMetadataFromConfig(){if(this.authorityOptions.authorityMetadata)try{return JSON.parse(this.authorityOptions.authorityMetadata)}catch(e){throw du(eu)}return null}async getEndpointMetadataFromNetwork(){this.performanceClient?.addQueueMeasurement(Qd,this.correlationId);const e={},t=this.defaultOpenIdConfigurationEndpoint;this.logger.verbose(`Authority.getEndpointMetadataFromNetwork: attempting to retrieve OAuth endpoints from ${t}`);try{const r=await this.networkInterface.sendGetRequestAsync(t,e),n=function(e){return e.hasOwnProperty("authorization_endpoint")&&e.hasOwnProperty("token_endpoint")&&e.hasOwnProperty("issuer")&&e.hasOwnProperty("jwks_uri")}(r.body);return n?r.body:(this.logger.verbose("Authority.getEndpointMetadataFromNetwork: could not parse response as OpenID configuration"),null)}catch(e){return this.logger.verbose(`Authority.getEndpointMetadataFromNetwork: ${e}`),null}}getEndpointMetadataFromHardcodedValues(){return this.hostnameAndPort in Tu?Tu[this.hostnameAndPort]:null}async updateMetadataWithRegionalInformation(e){this.performanceClient?.addQueueMeasurement(Xd,this.correlationId);const t=this.authorityOptions.azureRegionConfiguration?.azureRegion;if(t){if(t!==$s.AZURE_REGION_AUTO_DISCOVER_FLAG)return this.regionDiscoveryMetadata.region_outcome="2",this.regionDiscoveryMetadata.region_used=t,vg.replaceWithRegionalInformation(e,t);const r=await mg(this.regionDiscovery.detectRegion.bind(this.regionDiscovery),Zd,this.logger,this.performanceClient,this.correlationId)(this.authorityOptions.azureRegionConfiguration?.environmentRegion,this.regionDiscoveryMetadata);if(r)return this.regionDiscoveryMetadata.region_outcome="4",this.regionDiscoveryMetadata.region_used=r,vg.replaceWithRegionalInformation(e,r);this.regionDiscoveryMetadata.region_outcome="5"}return e}async updateCloudDiscoveryMetadata(e){this.performanceClient?.addQueueMeasurement(Yd,this.correlationId);const t=this.updateCloudDiscoveryMetadataFromLocalSources(e);if(t)return t;const r=await mg(this.getCloudDiscoveryMetadataFromNetwork.bind(this),Vd,this.logger,this.performanceClient,this.correlationId)();if(r)return $l(e,r,!0),lc;throw du(tu)}updateCloudDiscoveryMetadataFromLocalSources(e){this.logger.verbose("Attempting to get cloud discovery metadata  from authority configuration"),this.logger.verbosePii(`Known Authorities: ${this.authorityOptions.knownAuthorities||$s.NOT_APPLICABLE}`),this.logger.verbosePii(`Authority Metadata: ${this.authorityOptions.authorityMetadata||$s.NOT_APPLICABLE}`),this.logger.verbosePii(`Canonical Authority: ${e.canonical_authority||$s.NOT_APPLICABLE}`);const t=this.getCloudDiscoveryMetadataFromConfig();if(t)return this.logger.verbose("Found cloud discovery metadata in authority configuration"),$l(e,t,!1),sc;if(this.logger.verbose("Did not find cloud discovery metadata in the config... Attempting to get cloud discovery metadata from the hardcoded values."),this.options.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded cloud discovery metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get cloud discovery metadata from the network metadata cache.");else{const t=(r=this.hostnameAndPort,_u(Iu.metadata,r));if(t)return this.logger.verbose("Found cloud discovery metadata from hardcoded values."),$l(e,t,!1),uc;this.logger.verbose("Did not find cloud discovery metadata in hardcoded values... Attempting to get cloud discovery metadata from the network metadata cache.")}var r;const n=Dl(e);return this.isAuthoritySameType(e)&&e.aliasesFromNetwork&&!n?(this.logger.verbose("Found cloud discovery metadata in the cache."),cc):(n&&this.logger.verbose("The metadata entity is expired."),null)}getCloudDiscoveryMetadataFromConfig(){if(3===this.authorityType)return this.logger.verbose("CIAM authorities do not support cloud discovery metadata, generate the aliases from authority host."),vg.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort);if(this.authorityOptions.cloudDiscoveryMetadata){this.logger.verbose("The cloud discovery metadata has been provided as a network response, in the config.");try{this.logger.verbose("Attempting to parse the cloud discovery metadata.");const e=_u(JSON.parse(this.authorityOptions.cloudDiscoveryMetadata).metadata,this.hostnameAndPort);if(this.logger.verbose("Parsed the cloud discovery metadata."),e)return this.logger.verbose("There is returnable metadata attached to the parsed cloud discovery metadata."),e;this.logger.verbose("There is no metadata attached to the parsed cloud discovery metadata.")}catch(e){throw this.logger.verbose("Unable to parse the cloud discovery metadata. Throwing Invalid Cloud Discovery Metadata Error."),du(Zl)}}return this.isInKnownAuthorities()?(this.logger.verbose("The host is included in knownAuthorities. Creating new cloud discovery metadata from the host."),vg.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)):null}async getCloudDiscoveryMetadataFromNetwork(){this.performanceClient?.addQueueMeasurement(Vd,this.correlationId);const e=`${$s.AAD_INSTANCE_DISCOVERY_ENDPT}${this.canonicalAuthority}oauth2/v2.0/authorize`,t={};let r=null;try{const n=await this.networkInterface.sendGetRequestAsync(e,t);let o,i;if(function(e){return e.hasOwnProperty("tenant_discovery_endpoint")&&e.hasOwnProperty("metadata")}(n.body))o=n.body,i=o.metadata,this.logger.verbosePii(`tenant_discovery_endpoint is: ${o.tenant_discovery_endpoint}`);else{if(!function(e){return e.hasOwnProperty("error")&&e.hasOwnProperty("error_description")}(n.body))return this.logger.error("AAD did not return a CloudInstanceDiscoveryResponse or CloudInstanceDiscoveryErrorResponse"),null;if(this.logger.warning(`A CloudInstanceDiscoveryErrorResponse was returned. The cloud instance discovery network request's status code is: ${n.status}`),o=n.body,o.error===$s.INVALID_INSTANCE)return this.logger.error("The CloudInstanceDiscoveryErrorResponse error is invalid_instance."),null;this.logger.warning(`The CloudInstanceDiscoveryErrorResponse error is ${o.error}`),this.logger.warning(`The CloudInstanceDiscoveryErrorResponse error description is ${o.error_description}`),this.logger.warning("Setting the value of the CloudInstanceDiscoveryMetadata (returned from the network) to []"),i=[]}this.logger.verbose("Attempting to find a match between the developer's authority and the CloudInstanceDiscoveryMetadata returned from the network request."),r=_u(i,this.hostnameAndPort)}catch(e){if(e instanceof Ac)this.logger.error(`There was a network error while attempting to get the cloud discovery instance metadata.\nError: ${e.errorCode}\nError Description: ${e.errorMessage}`);else{const t=e;this.logger.error(`A non-MSALJS error was thrown while attempting to get the cloud instance discovery metadata.\nError: ${t.name}\nError Description: ${t.message}`)}return null}return r||(this.logger.warning("The developer's authority was not found within the CloudInstanceDiscoveryMetadata returned from the network request."),this.logger.verbose("Creating custom Authority for custom domain scenario."),r=vg.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)),r}isInKnownAuthorities(){return this.authorityOptions.knownAuthorities.filter((e=>e&&Su.getDomainFromUrl(e).toLowerCase()===this.hostnameAndPort)).length>0}static generateAuthority(e,t){let r;if(t&&t.azureCloudInstance!==vc){const e=t.tenant?t.tenant:$s.DEFAULT_COMMON_TENANT;r=`${t.azureCloudInstance}/${e}/`}return r||e}static createCloudDiscoveryMetadataFromHost(e){return{preferred_network:e,preferred_cache:e,aliases:[e]}}getPreferredCache(){if(this.managedIdentity)return $s.DEFAULT_AUTHORITY_HOST;if(this.discoveryComplete())return this.metadata.preferred_cache;throw ml(xc)}isAlias(e){return this.metadata.aliases.indexOf(e)>-1}isAliasOfKnownMicrosoftAuthority(e){return Eu.has(e)}static isPublicCloudAuthority(e){return $s.KNOWN_PUBLIC_CLOUDS.indexOf(e)>=0}static buildRegionalAuthorityString(e,t,r){const n=new Su(e);n.validateAsUri();const o=n.getUrlComponents();let i=`${t}.${o.HostNameAndPort}`;this.isPublicCloudAuthority(o.HostNameAndPort)&&(i=`${t}.${$s.REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX}`);const a=Su.constructAuthorityUriFromObject({...n.getUrlComponents(),HostNameAndPort:i}).urlString;return r?`${a}?${r}`:a}static replaceWithRegionalInformation(e,t){const r={...e};return r.authorization_endpoint=vg.buildRegionalAuthorityString(r.authorization_endpoint,t),r.token_endpoint=vg.buildRegionalAuthorityString(r.token_endpoint,t),r.end_session_endpoint&&(r.end_session_endpoint=vg.buildRegionalAuthorityString(r.end_session_endpoint,t)),r}static transformCIAMAuthority(e){let t=e;const r=new Su(e).getUrlComponents();return 0===r.PathSegments.length&&r.HostNameAndPort.endsWith($s.CIAM_AUTH_URL)&&(t=`${t}${r.HostNameAndPort.split(".")[0]}${$s.AAD_TENANT_DOMAIN_SUFFIX}`),t}}function bg(e){return e.endsWith($s.FORWARD_SLASH)?e:`${e}${$s.FORWARD_SLASH}`}function wg(e){const t=e.cloudDiscoveryMetadata;let r;if(t)try{r=JSON.parse(t)}catch(e){throw du(Zl)}return{canonicalAuthority:e.authority?bg(e.authority):void 0,knownAuthorities:e.knownAuthorities,cloudDiscoveryMetadata:r}}vg.reservedTenantDomains=new Set(["{tenant}","{tenantid}",Vs,Qs,Ys]);const Cg="no_tokens_found",Ag="native_account_unavailable",kg="refresh_token_expired",Sg="bad_token",Tg=["interaction_required","consent_required","login_required",Sg],Ig=["message_only","additional_action","basic_action","user_password_expired","consent_required","bad_token"],Eg={[Cg]:"No refresh token found in the cache. Please sign-in.",[Ag]:"The requested account is not available in the native broker. It may have been deleted or logged out. Please sign-in again using an interactive API.",[kg]:"Refresh token has expired.",[Sg]:"Identity provider returned bad_token due to an expired or invalid refresh token. Please invoke an interactive API to resolve."};class xg extends Ac{constructor(e,t,r,n,o,i,a,s){super(e,t,r),Object.setPrototypeOf(this,xg.prototype),this.timestamp=n||$s.EMPTY_STRING,this.traceId=o||$s.EMPTY_STRING,this.correlationId=i||$s.EMPTY_STRING,this.claims=a||$s.EMPTY_STRING,this.name="InteractionRequiredAuthError",this.errorNo=s}}function _g(e,t,r){const n=!!e&&Tg.indexOf(e)>-1,o=!!r&&Ig.indexOf(r)>-1,i=!!t&&Tg.some((e=>t.indexOf(e)>-1));return n||i||o}function Pg(e){return new xg(e,Eg[e])}function Rg(e,t,r){return{clientId:e,authority:t.authority,scopes:t.scopes,homeAccountIdentifier:r,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid,embeddedClientId:t.embeddedClientId||t.tokenBodyParameters?.clientId}}var Og=r(64583).Promise;const Mg="None";class Ng{initialize(){return Og.resolve()}getItem(e){const t=`${encodeURIComponent(e)}`,r=document.cookie.split(";");for(let e=0;e<r.length;e++){const n=r[e],[o,...i]=decodeURIComponent(n).trim().split("="),a=i.join("=");if(o===t)return a}return""}getUserData(){throw ml(hl)}setItem(e,t,r,n=!0,o="Lax"){let i=`${encodeURIComponent(e)}=${encodeURIComponent(t)};path=/;SameSite=${o};`;if(r){const e=function(e){const t=new Date;return new Date(t.getTime()+864e5*e).toUTCString()}(r);i+=`expires=${e};`}(n||o===Mg)&&(i+="Secure;"),document.cookie=i}async setUserData(){return Og.reject(ml(hl))}removeItem(e){this.setItem(e,"",-1)}getKeys(){const e=document.cookie.split(";"),t=[];return e.forEach((e=>{const r=decodeURIComponent(e).trim().split("=");t.push(r[0])})),t}containsKey(e){return this.getKeys().includes(e)}}function Bg(e){const t=e.getItem(Wh);return t?JSON.parse(t):[]}function Lg(e,t){const r=t.getItem(`${Gh}.${e}`);if(r){const e=JSON.parse(r);if(e&&e.hasOwnProperty("idToken")&&e.hasOwnProperty("accessToken")&&e.hasOwnProperty("refreshToken"))return e}return{idToken:[],accessToken:[],refreshToken:[]}}var qg=r(64583).Promise;const Hg="msal.cache.encryption";class $g{constructor(e,t,r){if(!window.localStorage)throw Kf(Df);this.memoryStorage=new dg,this.initialized=!1,this.clientId=e,this.logger=t,this.performanceClient=r,this.broadcast=new BroadcastChannel("msal.broadcast.cache")}async initialize(e){const t=new Ng,r=t.getItem(Hg);let n={key:"",id:""};if(r)try{n=JSON.parse(r)}catch(e){}if(n.key&&n.id){const t=gg(mf,bh,this.logger,this.performanceClient,e)(n.key);this.encryptionCookie={id:n.id,key:await mg(Bf,yh,this.logger,this.performanceClient,e)(t)},await mg(this.importExistingCache.bind(this),lh,this.logger,this.performanceClient,e)(e)}else{this.clear();const r=Pf(),n=await mg(Nf,vh,this.logger,this.performanceClient,e)(),o=gg(hf,wh,this.logger,this.performanceClient,e)(new Uint8Array(n));this.encryptionCookie={id:r,key:await mg(Bf,yh,this.logger,this.performanceClient,e)(n)};const i={id:r,key:o};t.setItem(Hg,JSON.stringify(i),0,!0,Mg)}this.broadcast.addEventListener("message",this.updateCache.bind(this)),this.initialized=!0}getItem(e){return window.localStorage.getItem(e)}getUserData(e){if(!this.initialized)throw sf(Qp);return this.memoryStorage.getItem(e)}setItem(e,t){window.localStorage.setItem(e,t)}async setUserData(e,t,r){if(!this.initialized||!this.encryptionCookie)throw sf(Qp);const{data:n,nonce:o}=await mg(qf,Ch,this.logger,this.performanceClient,r)(this.encryptionCookie.key,t,this.getContext(e)),i={id:this.encryptionCookie.id,nonce:o,data:n};this.memoryStorage.setItem(e,t),this.setItem(e,JSON.stringify(i)),this.broadcast.postMessage({key:e,value:t,context:this.getContext(e)})}removeItem(e){this.memoryStorage.containsKey(e)&&(this.memoryStorage.removeItem(e),this.broadcast.postMessage({key:e,value:null,context:this.getContext(e)})),window.localStorage.removeItem(e)}getKeys(){return Object.keys(window.localStorage)}containsKey(e){return window.localStorage.hasOwnProperty(e)}clear(){this.memoryStorage.clear(),Bg(this).forEach((e=>this.removeItem(e)));const e=Lg(this.clientId,this);e.idToken.forEach((e=>this.removeItem(e))),e.accessToken.forEach((e=>this.removeItem(e))),e.refreshToken.forEach((e=>this.removeItem(e))),this.getKeys().forEach((e=>{(e.startsWith($s.CACHE_PREFIX)||-1!==e.indexOf(this.clientId))&&this.removeItem(e)}))}async importExistingCache(e){if(!this.encryptionCookie)return;let t=Bg(this);t=await this.importArray(t,e),this.setItem(Wh,JSON.stringify(t));const r=Lg(this.clientId,this);r.idToken=await this.importArray(r.idToken,e),r.accessToken=await this.importArray(r.accessToken,e),r.refreshToken=await this.importArray(r.refreshToken,e),this.setItem(`${Gh}.${this.clientId}`,JSON.stringify(r))}async getItemFromEncryptedCache(e,t){if(!this.encryptionCookie)return null;const r=this.getItem(e);if(!r)return null;let n;try{n=JSON.parse(r)}catch(e){return null}return n.id&&n.nonce&&n.data?n.id!==this.encryptionCookie.id?(this.performanceClient.incrementFields({encryptedCacheExpiredCount:1},t),null):mg(Hf,Ah,this.logger,this.performanceClient,t)(this.encryptionCookie.key,n.nonce,this.getContext(e),n.data):(this.performanceClient.incrementFields({unencryptedCacheCount:1},t),null)}async importArray(e,t){const r=[],n=[];return e.forEach((e=>{const o=this.getItemFromEncryptedCache(e,t).then((t=>{t?(this.memoryStorage.setItem(e,t),r.push(e)):this.removeItem(e)}));n.push(o)})),await qg.all(n),r}getContext(e){let t="";return e.includes(this.clientId)&&(t=this.clientId),t}updateCache(e){this.logger.trace("Updating internal cache from broadcast event");const t=this.performanceClient.startMeasurement(dh);t.add({isBackground:!0});const{key:r,value:n,context:o}=e.data;return r?o&&o!==this.clientId?(this.logger.trace(`Ignoring broadcast event from clientId: ${o}`),void t.end({success:!1,errorCode:"contextMismatch"})):(n?(this.memoryStorage.setItem(r,n),this.logger.verbose("Updated item in internal cache")):(this.memoryStorage.removeItem(r),this.logger.verbose("Removed item from internal cache")),void t.end({success:!0})):(this.logger.error("Broadcast event missing key"),void t.end({success:!1,errorCode:"noKey"}))}}class Dg{constructor(){if(!window.sessionStorage)throw Kf(Df)}async initialize(){}getItem(e){return window.sessionStorage.getItem(e)}getUserData(e){return this.getItem(e)}setItem(e,t){window.sessionStorage.setItem(e,t)}async setUserData(e,t){this.setItem(e,t)}removeItem(e){window.sessionStorage.removeItem(e)}getKeys(){return Object.keys(window.sessionStorage)}containsKey(e){return window.sessionStorage.hasOwnProperty(e)}}const Fg="msal:initializeEnd",Ug="msal:accountAdded",jg="msal:accountRemoved",zg="msal:activeAccountChanged",Kg="msal:loginStart",Wg="msal:loginSuccess",Gg="msal:loginFailure",Vg="msal:acquireTokenStart",Yg="msal:acquireTokenSuccess",Qg="msal:acquireTokenFailure",Jg="msal:acquireTokenByCodeFailure",Xg="msal:handleRedirectEnd",Zg="msal:popupOpened",em="msal:logoutStart",tm="msal:logoutSuccess",rm="msal:logoutFailure",nm="msal:logoutEnd";var om=r(64583).Promise;class im extends Bu{constructor(e,t,r,n,o,i,a){super(e,r,n,a),this.cacheConfig=t,this.logger=n,this.internalStorage=new dg,this.browserStorage=am(e,t.cacheLocation,n,o),this.temporaryCacheStorage=am(e,t.temporaryCacheLocation,n,o),this.cookieStorage=new Ng,this.performanceClient=o,this.eventHandler=i}async initialize(e){await this.browserStorage.initialize(e)}validateAndParseJson(e){try{const t=JSON.parse(e);return t&&"object"==typeof t?t:null}catch(e){return null}}getAccount(e){this.logger.trace("BrowserCacheManager.getAccount called");const t=this.browserStorage.getUserData(e);if(!t)return this.removeAccountKeyFromMap(e),null;const r=this.validateAndParseJson(t);return r&&wu.isAccountEntity(r)?Bu.toObject(new wu,r):(this.removeAccountKeyFromMap(e),null)}async setAccount(e,t){this.logger.trace("BrowserCacheManager.setAccount called");const r=e.generateAccountKey();await mg(this.browserStorage.setUserData.bind(this.browserStorage),uh,this.logger,this.performanceClient)(r,JSON.stringify(e),t);const n=this.addAccountKeyToMap(r);this.cacheConfig.cacheLocation===Bh&&n&&this.eventHandler.emitEvent(Ug,void 0,e.getAccountInfo())}getAccountKeys(){return Bg(this.browserStorage)}addAccountKeyToMap(e){this.logger.trace("BrowserCacheManager.addAccountKeyToMap called"),this.logger.tracePii(`BrowserCacheManager.addAccountKeyToMap called with key: ${e}`);const t=this.getAccountKeys();return-1===t.indexOf(e)?(t.push(e),this.browserStorage.setItem(Wh,JSON.stringify(t)),this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key added"),!0):(this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key already exists in map"),!1)}removeAccountKeyFromMap(e){this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap called"),this.logger.tracePii(`BrowserCacheManager.removeAccountKeyFromMap called with key: ${e}`);const t=this.getAccountKeys(),r=t.indexOf(e);r>-1?(t.splice(r,1),this.browserStorage.setItem(Wh,JSON.stringify(t)),this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap account key removed")):this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap key not found in existing map")}async removeAccount(e){super.removeAccount(e),this.removeAccountKeyFromMap(e)}async removeAccountContext(e){await super.removeAccountContext(e),this.cacheConfig.cacheLocation===Bh&&this.eventHandler.emitEvent(jg,void 0,e.getAccountInfo())}removeIdToken(e){super.removeIdToken(e),this.removeTokenKey(e,nc.ID_TOKEN)}async removeAccessToken(e){super.removeAccessToken(e),this.removeTokenKey(e,nc.ACCESS_TOKEN)}removeRefreshToken(e){super.removeRefreshToken(e),this.removeTokenKey(e,nc.REFRESH_TOKEN)}getTokenKeys(){return Lg(this.clientId,this.browserStorage)}addTokenKey(e,t){this.logger.trace("BrowserCacheManager addTokenKey called");const r=this.getTokenKeys();switch(t){case nc.ID_TOKEN:-1===r.idToken.indexOf(e)&&(this.logger.info("BrowserCacheManager: addTokenKey - idToken added to map"),r.idToken.push(e));break;case nc.ACCESS_TOKEN:-1===r.accessToken.indexOf(e)&&(this.logger.info("BrowserCacheManager: addTokenKey - accessToken added to map"),r.accessToken.push(e));break;case nc.REFRESH_TOKEN:-1===r.refreshToken.indexOf(e)&&(this.logger.info("BrowserCacheManager: addTokenKey - refreshToken added to map"),r.refreshToken.push(e));break;default:throw this.logger.error(`BrowserCacheManager:addTokenKey - CredentialType provided invalid. CredentialType: ${t}`),ml(Zc)}this.browserStorage.setItem(`${Gh}.${this.clientId}`,JSON.stringify(r))}removeTokenKey(e,t){this.logger.trace("BrowserCacheManager removeTokenKey called");const r=this.getTokenKeys();switch(t){case nc.ID_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove idToken with key: ${e} from map`);const n=r.idToken.indexOf(e);n>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - idToken removed from map"),r.idToken.splice(n,1)):this.logger.info("BrowserCacheManager: removeTokenKey - idToken does not exist in map. Either it was previously removed or it was never added.");break;case nc.ACCESS_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove accessToken with key: ${e} from map`);const o=r.accessToken.indexOf(e);o>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - accessToken removed from map"),r.accessToken.splice(o,1)):this.logger.info("BrowserCacheManager: removeTokenKey - accessToken does not exist in map. Either it was previously removed or it was never added.");break;case nc.REFRESH_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove refreshToken with key: ${e} from map`);const i=r.refreshToken.indexOf(e);i>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken removed from map"),r.refreshToken.splice(i,1)):this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken does not exist in map. Either it was previously removed or it was never added.");break;default:throw this.logger.error(`BrowserCacheManager:removeTokenKey - CredentialType provided invalid. CredentialType: ${t}`),ml(Zc)}this.browserStorage.setItem(`${Gh}.${this.clientId}`,JSON.stringify(r))}getIdTokenCredential(e){const t=this.browserStorage.getUserData(e);if(!t)return this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeTokenKey(e,nc.ID_TOKEN),null;const r=this.validateAndParseJson(t);return r&&(n=r)&&Rl(n)&&n.hasOwnProperty("realm")&&n.credentialType===nc.ID_TOKEN?(this.logger.trace("BrowserCacheManager.getIdTokenCredential: cache hit"),r):(this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeTokenKey(e,nc.ID_TOKEN),null);var n}async setIdTokenCredential(e,t){this.logger.trace("BrowserCacheManager.setIdTokenCredential called");const r=El(e);await mg(this.browserStorage.setUserData.bind(this.browserStorage),uh,this.logger,this.performanceClient)(r,JSON.stringify(e),t),this.addTokenKey(r,nc.ID_TOKEN)}getAccessTokenCredential(e){const t=this.browserStorage.getUserData(e);if(!t)return this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeTokenKey(e,nc.ACCESS_TOKEN),null;const r=this.validateAndParseJson(t);return r&&(n=r)&&Rl(n)&&n.hasOwnProperty("realm")&&n.hasOwnProperty("target")&&(n.credentialType===nc.ACCESS_TOKEN||n.credentialType===nc.ACCESS_TOKEN_WITH_AUTH_SCHEME)?(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: cache hit"),r):(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeTokenKey(e,nc.ACCESS_TOKEN),null);var n}async setAccessTokenCredential(e,t){this.logger.trace("BrowserCacheManager.setAccessTokenCredential called");const r=El(e);await mg(this.browserStorage.setUserData.bind(this.browserStorage),uh,this.logger,this.performanceClient)(r,JSON.stringify(e),t),this.addTokenKey(r,nc.ACCESS_TOKEN)}getRefreshTokenCredential(e){const t=this.browserStorage.getUserData(e);if(!t)return this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeTokenKey(e,nc.REFRESH_TOKEN),null;const r=this.validateAndParseJson(t);return r&&(n=r)&&Rl(n)&&n.credentialType===nc.REFRESH_TOKEN?(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: cache hit"),r):(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeTokenKey(e,nc.REFRESH_TOKEN),null);var n}async setRefreshTokenCredential(e,t){this.logger.trace("BrowserCacheManager.setRefreshTokenCredential called");const r=El(e);await mg(this.browserStorage.setUserData.bind(this.browserStorage),uh,this.logger,this.performanceClient)(r,JSON.stringify(e),t),this.addTokenKey(r,nc.REFRESH_TOKEN)}getAppMetadata(e){const t=this.browserStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null;const r=this.validateAndParseJson(t);return r&&((n=r)&&0===e.indexOf(oc)&&n.hasOwnProperty("clientId")&&n.hasOwnProperty("environment"))?(this.logger.trace("BrowserCacheManager.getAppMetadata: cache hit"),r):(this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null);var n}setAppMetadata(e){this.logger.trace("BrowserCacheManager.setAppMetadata called");const t=function({environment:e,clientId:t}){return[oc,e,t].join(rc).toLowerCase()}(e);this.browserStorage.setItem(t,JSON.stringify(e))}getServerTelemetry(e){const t=this.browserStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null;const r=this.validateAndParseJson(t);return r&&function(e,t){const r=0===e.indexOf(dc.CACHE_KEY);let n=!0;return t&&(n=t.hasOwnProperty("failedRequests")&&t.hasOwnProperty("errors")&&t.hasOwnProperty("cacheHits")),r&&n}(e,r)?(this.logger.trace("BrowserCacheManager.getServerTelemetry: cache hit"),r):(this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null)}setServerTelemetry(e,t){this.logger.trace("BrowserCacheManager.setServerTelemetry called"),this.browserStorage.setItem(e,JSON.stringify(t))}getAuthorityMetadata(e){const t=this.internalStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAuthorityMetadata: called, no cache hit"),null;const r=this.validateAndParseJson(t);return r&&function(e,t){return!!t&&0===e.indexOf(ac)&&t.hasOwnProperty("aliases")&&t.hasOwnProperty("preferred_cache")&&t.hasOwnProperty("preferred_network")&&t.hasOwnProperty("canonical_authority")&&t.hasOwnProperty("authorization_endpoint")&&t.hasOwnProperty("token_endpoint")&&t.hasOwnProperty("issuer")&&t.hasOwnProperty("aliasesFromNetwork")&&t.hasOwnProperty("endpointsFromNetwork")&&t.hasOwnProperty("expiresAt")&&t.hasOwnProperty("jwks_uri")}(e,r)?(this.logger.trace("BrowserCacheManager.getAuthorityMetadata: cache hit"),r):null}getAuthorityMetadataKeys(){return this.internalStorage.getKeys().filter((e=>this.isAuthorityMetadata(e)))}setWrapperMetadata(e,t){this.internalStorage.setItem(Vh,e),this.internalStorage.setItem(Yh,t)}getWrapperMetadata(){return[this.internalStorage.getItem(Vh)||$s.EMPTY_STRING,this.internalStorage.getItem(Yh)||$s.EMPTY_STRING]}setAuthorityMetadata(e,t){this.logger.trace("BrowserCacheManager.setAuthorityMetadata called"),this.internalStorage.setItem(e,JSON.stringify(t))}getActiveAccount(){const e=this.generateCacheKey(Gs),t=this.browserStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getActiveAccount: No active account filters found"),null;const r=this.validateAndParseJson(t);return r?(this.logger.trace("BrowserCacheManager.getActiveAccount: Active account filters schema found"),this.getAccountInfoFilteredBy({homeAccountId:r.homeAccountId,localAccountId:r.localAccountId,tenantId:r.tenantId})):(this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null)}setActiveAccount(e){const t=this.generateCacheKey(Gs);if(e){this.logger.verbose("setActiveAccount: Active account set");const r={homeAccountId:e.homeAccountId,localAccountId:e.localAccountId,tenantId:e.tenantId};this.browserStorage.setItem(t,JSON.stringify(r))}else this.logger.verbose("setActiveAccount: No account passed, active account not set"),this.browserStorage.removeItem(t);this.eventHandler.emitEvent(zg)}getThrottlingCache(e){const t=this.browserStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null;const r=this.validateAndParseJson(t);return r&&function(e,t){let r=!1;e&&(r=0===e.indexOf(pc));let n=!0;return t&&(n=t.hasOwnProperty("throttleTime")),r&&n}(e,r)?(this.logger.trace("BrowserCacheManager.getThrottlingCache: cache hit"),r):(this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null)}setThrottlingCache(e,t){this.logger.trace("BrowserCacheManager.setThrottlingCache called"),this.browserStorage.setItem(e,JSON.stringify(t))}getTemporaryCache(e,t){const r=t?this.generateCacheKey(e):e;if(this.cacheConfig.storeAuthStateInCookie){const e=this.cookieStorage.getItem(r);if(e)return this.logger.trace("BrowserCacheManager.getTemporaryCache: storeAuthStateInCookies set to true, retrieving from cookies"),e}const n=this.temporaryCacheStorage.getItem(r);if(!n){if(this.cacheConfig.cacheLocation===Bh){const e=this.browserStorage.getItem(r);if(e)return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item found in local storage"),e}return this.logger.trace("BrowserCacheManager.getTemporaryCache: No cache item found in local storage"),null}return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item returned"),n}setTemporaryCache(e,t,r){const n=r?this.generateCacheKey(e):e;this.temporaryCacheStorage.setItem(n,t),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.setTemporaryCache: storeAuthStateInCookie set to true, setting item cookie"),this.cookieStorage.setItem(n,t,void 0,this.cacheConfig.secureCookies))}removeItem(e){this.browserStorage.removeItem(e)}removeTemporaryItem(e){this.temporaryCacheStorage.removeItem(e),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.removeItem: storeAuthStateInCookie is true, clearing item cookie"),this.cookieStorage.removeItem(e))}getKeys(){return this.browserStorage.getKeys()}async clear(){await this.removeAllAccounts(),this.removeAppMetadata(),this.temporaryCacheStorage.getKeys().forEach((e=>{-1===e.indexOf($s.CACHE_PREFIX)&&-1===e.indexOf(this.clientId)||this.removeTemporaryItem(e)})),this.browserStorage.getKeys().forEach((e=>{-1===e.indexOf($s.CACHE_PREFIX)&&-1===e.indexOf(this.clientId)||this.browserStorage.removeItem(e)})),this.internalStorage.clear()}async clearTokensAndKeysWithClaims(e,t){e.addQueueMeasurement(sh,t);const r=this.getTokenKeys(),n=[];r.accessToken.forEach((e=>{const t=this.getAccessTokenCredential(e);t?.requestedClaimsHash&&e.includes(t.requestedClaimsHash.toLowerCase())&&n.push(this.removeAccessToken(e))})),await om.all(n),n.length>0&&this.logger.warning(`${n.length} access tokens with claims in the cache keys have been removed from the cache.`)}generateCacheKey(e){return this.validateAndParseJson(e)?JSON.stringify(e):hu.startsWith(e,$s.CACHE_PREFIX)?e:`${$s.CACHE_PREFIX}.${this.clientId}.${e}`}resetRequestCache(){this.logger.trace("BrowserCacheManager.resetRequestCache called"),this.removeTemporaryItem(this.generateCacheKey(Uh)),this.removeTemporaryItem(this.generateCacheKey(jh)),this.removeTemporaryItem(this.generateCacheKey(Dh)),this.removeTemporaryItem(this.generateCacheKey(Fh)),this.removeTemporaryItem(this.generateCacheKey(Kh)),this.setInteractionInProgress(!1)}cacheAuthorizeRequest(e,t){this.logger.trace("BrowserCacheManager.cacheAuthorizeRequest called");const r=pf(JSON.stringify(e));if(this.setTemporaryCache(Uh,r,!0),t){const e=pf(t);this.setTemporaryCache(jh,e,!0)}}getCachedRequest(){this.logger.trace("BrowserCacheManager.getCachedRequest called");const e=this.getTemporaryCache(Uh,!0);if(!e)throw sf(Pp);const t=this.getTemporaryCache(jh,!0);let r,n="";try{r=JSON.parse(gf(e)),t&&(n=gf(t))}catch(t){throw this.logger.errorPii(`Attempted to parse: ${e}`),this.logger.error(`Parsing cached token request threw with error: ${t}`),sf(Rp)}return[r,n]}getCachedNativeRequest(){this.logger.trace("BrowserCacheManager.getCachedNativeRequest called");const e=this.getTemporaryCache(Kh,!0);if(!e)return this.logger.trace("BrowserCacheManager.getCachedNativeRequest: No cached native request found"),null;return this.validateAndParseJson(e)||(this.logger.error("BrowserCacheManager.getCachedNativeRequest: Unable to parse native request"),null)}isInteractionInProgress(e){const t=this.getInteractionInProgress()?.clientId;return e?t===this.clientId:!!t}getInteractionInProgress(){const e=`${$s.CACHE_PREFIX}.${zh}`,t=this.getTemporaryCache(e,!1);try{return t?JSON.parse(t):null}catch(t){return this.logger.error("Cannot parse interaction status. Removing temporary cache items and clearing url hash. Retrying interaction should fix the error"),this.removeTemporaryItem(e),this.resetRequestCache(),Wf(window),null}}setInteractionInProgress(e,t=Hh){const r=`${$s.CACHE_PREFIX}.${zh}`;if(e){if(this.getInteractionInProgress())throw sf(yp);this.setTemporaryCache(r,JSON.stringify({clientId:this.clientId,type:t}),!1)}else e||this.getInteractionInProgress()?.clientId!==this.clientId||this.removeTemporaryItem(r)}async hydrateCache(e,t){const r=xl(e.account?.homeAccountId,e.account?.environment,e.idToken,this.clientId,e.tenantId);let n;t.claims&&(n=await this.cryptoImpl.hashString(t.claims));const o={idToken:r,accessToken:_l(e.account?.homeAccountId,e.account.environment,e.accessToken,this.clientId,e.tenantId,e.scopes.join(" "),e.expiresOn?kl(e.expiresOn):0,e.extExpiresOn?kl(e.extExpiresOn):0,gf,void 0,e.tokenType,void 0,t.sshKid,t.claims,n)};return this.saveCacheRecord(o,e.correlationId)}async saveCacheRecord(e,t,r){try{await super.saveCacheRecord(e,t,r)}catch(e){if(e instanceof Mu&&this.performanceClient&&t)try{const e=this.getTokenKeys();this.performanceClient.addFields({cacheRtCount:e.refreshToken.length,cacheIdCount:e.idToken.length,cacheAtCount:e.accessToken.length},t)}catch(e){}throw e}}}function am(e,t,r,n){try{switch(t){case Bh:return new $g(e,r,n);case Lh:return new Dg}}catch(e){r.error(e)}return new dg}const sm=(e,t,r,n)=>new im(e,{cacheLocation:qh,temporaryCacheLocation:qh,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1},yl,t,r,n);function cm(e,t,r,n){return e.verbose("getAllAccounts called"),r?t.getAllAccounts(n):[]}function lm(e,t,r){if(t.trace("getAccount called"),0===Object.keys(e).length)return t.warning("getAccount: No accountFilter provided"),null;const n=r.getAccountInfoFilteredBy(e);return n?(t.verbose("getAccount: Account matching provided filter found, returning"),n):(t.verbose("getAccount: No matching account found, returning null"),null)}function um(e,t,r){if(t.trace("getAccountByUsername called"),!e)return t.warning("getAccountByUsername: No username provided"),null;const n=r.getAccountInfoFilteredBy({username:e});return n?(t.verbose("getAccountByUsername: Account matching username found, returning"),t.verbosePii(`getAccountByUsername: Returning signed-in accounts matching username: ${e}`),n):(t.verbose("getAccountByUsername: No matching account found, returning null"),null)}function dm(e,t,r){if(t.trace("getAccountByHomeId called"),!e)return t.warning("getAccountByHomeId: No homeAccountId provided"),null;const n=r.getAccountInfoFilteredBy({homeAccountId:e});return n?(t.verbose("getAccountByHomeId: Account matching homeAccountId found, returning"),t.verbosePii(`getAccountByHomeId: Returning signed-in accounts matching homeAccountId: ${e}`),n):(t.verbose("getAccountByHomeId: No matching account found, returning null"),null)}function hm(e,t,r){if(t.trace("getAccountByLocalId called"),!e)return t.warning("getAccountByLocalId: No localAccountId provided"),null;const n=r.getAccountInfoFilteredBy({localAccountId:e});return n?(t.verbose("getAccountByLocalId: Account matching localAccountId found, returning"),t.verbosePii(`getAccountByLocalId: Returning signed-in accounts matching localAccountId: ${e}`),n):(t.verbose("getAccountByLocalId: No matching account found, returning null"),null)}function pm(e,t){t.setActiveAccount(e)}function fm(e){return e.getActiveAccount()}class gm{constructor(e){this.eventCallbacks=new Map,this.logger=e||new gc({}),"undefined"!=typeof BroadcastChannel&&(this.broadcastChannel=new BroadcastChannel("msal.broadcast.event")),this.invokeCrossTabCallbacks=this.invokeCrossTabCallbacks.bind(this)}addEventCallback(e,t,r){if("undefined"!=typeof window){const n=r||Pf();return this.eventCallbacks.has(n)?(this.logger.error(`Event callback with id: ${n} is already registered. Please provide a unique id or remove the existing callback and try again.`),null):(this.eventCallbacks.set(n,[e,t||[]]),this.logger.verbose(`Event callback registered with id: ${n}`),n)}return null}removeEventCallback(e){this.eventCallbacks.delete(e),this.logger.verbose(`Event callback ${e} removed.`)}emitEvent(e,t,r,n){const o={eventType:e,interactionType:t||null,payload:r||null,error:n||null,timestamp:Date.now()};switch(e){case Ug:case jg:case zg:this.broadcastChannel?.postMessage(o);break;default:this.invokeCallbacks(o)}}invokeCallbacks(e){this.eventCallbacks.forEach((([t,r],n)=>{(0===r.length||r.includes(e.eventType))&&(this.logger.verbose(`Emitting event to callback ${n}: ${e.eventType}`),t.apply(null,[e]))}))}invokeCrossTabCallbacks(e){const t=e.data;this.invokeCallbacks(t)}subscribeCrossTab(){this.broadcastChannel?.addEventListener("message",this.invokeCrossTabCallbacks)}unsubscribeCrossTab(){this.broadcastChannel?.removeEventListener("message",this.invokeCrossTabCallbacks)}}const mm="home_account_id",ym="UPN",vm="client_id",bm="redirect_uri",wm="token_type",Cm="req_cnf",Am="return_spa_code",km="x-client-xtra-sku",Sm="brk_client_id",Tm="brk_redirect_uri",Im="instance_aware";function Em(e,t,r){if(!t)return;const n=e.get(vm);n&&e.has(Sm)&&r?.addFields({embeddedClientId:n,embeddedRedirectUri:e.get(bm)},t)}function xm(e,t){e.set("response_type",t)}function _m(e,t,r=!0,n=Ds){!r||n.includes("openid")||t.includes("openid")||n.push("openid");const o=r?[...t||[],...n]:t||[],i=new pu(o);e.set("scope",i.printScopes())}function Pm(e,t){e.set(vm,t)}function Rm(e,t){e.set(bm,t)}function Om(e,t){e.set("login_hint",t)}function Mm(e,t){e.set(zs,`UPN:${t}`)}function Nm(e,t){e.set(zs,`Oid:${t.uid}@${t.utid}`)}function Bm(e,t){e.set("sid",t)}function Lm(e,t,r){const n=Vm(t,r);try{JSON.parse(n)}catch(e){throw du(Vl)}e.set("claims",n)}function qm(e,t){e.set("client-request-id",t)}function Hm(e,t){e.set("x-client-SKU",t.sku),e.set("x-client-VER",t.version),t.os&&e.set("x-client-OS",t.os),t.cpu&&e.set("x-client-CPU",t.cpu)}function $m(e,t){t?.appName&&e.set("x-app-name",t.appName),t?.appVersion&&e.set("x-app-ver",t.appVersion)}function Dm(e,t){t&&e.set("state",t)}function Fm(e,t){e.set("client_secret",t)}function Um(e,t){t&&e.set("client_assertion",t)}function jm(e,t){t&&e.set("client_assertion_type",t)}function zm(e,t){e.set("grant_type",t)}function Km(e){e.set("client_info","1")}function Wm(e){e.has(Im)||e.set(Im,"true")}function Gm(e,t){Object.entries(t).forEach((([t,r])=>{!e.has(t)&&r&&e.set(t,r)}))}function Vm(e,t){let r;if(e)try{r=JSON.parse(e)}catch(e){throw du(Vl)}else r={};return t&&t.length>0&&(r.hasOwnProperty(Js)||(r[Js]={}),r[Js].xms_cc={values:t}),JSON.stringify(r)}function Ym(e,t){t&&(e.set(wm,hc.POP),e.set(Cm,t))}function Qm(e,t){t&&(e.set(wm,hc.SSH),e.set(Cm,t))}function Jm(e,t){e.set("x-client-current-telemetry",t.generateCurrentRequestHeaderValue()),e.set("x-client-last-telemetry",t.generateLastRequestHeaderValue())}function Xm(e){e.set("x-ms-lib-capability","retry-after, h429")}function Zm(e,t,r){e.has(Sm)||e.set(Sm,t),e.has(Tm)||e.set(Tm,r)}async function ey(e,t,r,n,o,i,a){a?.addQueueMeasurement(Wd,i);const s=vg.transformCIAMAuthority(bg(e)),c=new vg(s,t,r,n,o,i,a);try{return await mg(c.resolveEndpointsAsync.bind(c),Gd,o,a,i)(),c}catch(e){throw ml(xc)}}class ty extends Ac{constructor(e,t,r,n,o){super(e,t,r),this.name="ServerError",this.errorNo=n,this.status=o,Object.setPrototypeOf(this,ty.prototype)}}class ry{static generateThrottlingStorageKey(e){return`${pc}.${JSON.stringify(e)}`}static preProcess(e,t){const r=ry.generateThrottlingStorageKey(t),n=e.getThrottlingCache(r);if(n){if(n.throttleTime<Date.now())return void e.removeItem(r);throw new ty(n.errorCodes?.join(" ")||$s.EMPTY_STRING,n.errorMessage,n.subError)}}static postProcess(e,t,r){if(ry.checkResponseStatus(r)||ry.checkResponseForRetryAfter(r)){const n={throttleTime:ry.calculateThrottleTime(parseInt(r.headers[js])),error:r.body.error,errorCodes:r.body.error_codes,errorMessage:r.body.error_description,subError:r.body.suberror};e.setThrottlingCache(ry.generateThrottlingStorageKey(t),n)}}static checkResponseStatus(e){return 429===e.status||e.status>=500&&e.status<600}static checkResponseForRetryAfter(e){return!!e.headers&&e.headers.hasOwnProperty(js)&&(e.status<200||e.status>=300)}static calculateThrottleTime(e){const t=e<=0?0:e,r=Date.now()/1e3;return Math.floor(1e3*Math.min(r+(t||60),r+3600))}static removeThrottle(e,t,r,n){const o=Rg(t,r,n),i=this.generateThrottlingStorageKey(o);e.removeItem(i)}}class ny{constructor(e,t){this.config=function({authOptions:e,systemOptions:t,loggerOptions:r,cacheOptions:n,storageInterface:o,networkInterface:i,cryptoInterface:a,clientCredentials:s,libraryInfo:c,telemetry:l,serverTelemetryManager:u,persistencePlugin:d,serializableCache:h}){const p={...Hu,...r};return{authOptions:(f=e,{clientCapabilities:[],azureCloudOptions:ju,skipAuthorityMetadataCache:!1,instanceAware:!1,encodeExtraQueryParams:!1,...f}),systemOptions:{...qu,...t},loggerOptions:p,cacheOptions:{...$u,...n},storageInterface:o||new Lu(e.clientId,yl,new gc(p)),networkInterface:i||Du,cryptoInterface:a||yl,clientCredentials:s||Uu,libraryInfo:{...Fu,...c},telemetry:{...zu,...l},serverTelemetryManager:u||null,persistencePlugin:d||null,serializableCache:h||null};var f}(e),this.logger=new gc(this.config.loggerOptions,vl,bl),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.serverTelemetryManager=this.config.serverTelemetryManager,this.authority=this.config.authOptions.authority,this.performanceClient=t}createTokenRequestHeaders(e){const t={};if(t[Us]=$s.URL_FORM_CONTENT_TYPE,!this.config.systemOptions.preventCorsPreflight&&e)switch(e.type){case mm:try{const r=gu(e.credential);t[zs]=`Oid:${r.uid}@${r.utid}`}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}break;case ym:t[zs]=`UPN: ${e.credential}`}return t}async executePostToTokenEndpoint(e,t,r,n,o,i){i&&this.performanceClient?.addQueueMeasurement(i,o);const a=await this.sendPostRequest(n,e,{body:t,headers:r},o);return this.config.serverTelemetryManager&&a.status<500&&429!==a.status&&this.config.serverTelemetryManager.clearTelemetryCache(),a}async sendPostRequest(e,t,r,n){let o;ry.preProcess(this.cacheManager,e);try{o=await mg(this.networkClient.sendPostRequestAsync.bind(this.networkClient),cd,this.logger,this.performanceClient,n)(t,r);const e=o.headers||{};this.performanceClient?.addFields({refreshTokenSize:o.body.refresh_token?.length||0,httpVerToken:e[Ws]||"",requestId:e[Ks]||""},n)}catch(e){if(e instanceof ip){const t=e.responseHeaders;throw t&&this.performanceClient?.addFields({httpVerToken:t[Ws]||"",requestId:t[Ks]||"",contentTypeHeader:t[Us]||void 0,contentLengthHeader:t["Content-Length"]||void 0,httpStatus:e.httpStatus},n),e.error}throw e instanceof Ac?e:ml(_c)}return ry.postProcess(this.cacheManager,e,o),o}async updateAuthority(e,t){this.performanceClient?.addQueueMeasurement(Hd,t);const r=`https://${e}/${this.authority.tenant}/`,n=await ey(r,this.networkClient,this.cacheManager,this.authority.options,this.logger,t,this.performanceClient);this.authority=n}createTokenQueryParameters(e){const t=new Map;return e.embeddedClientId&&Zm(t,this.config.authOptions.clientId,this.config.authOptions.redirectUri),e.tokenQueryParameters&&Gm(t,e.tokenQueryParameters),qm(t,e.correlationId),Em(t,e.correlationId,this.performanceClient),ku(t)}}class oy{static setRequestState(e,t,r){const n=oy.generateLibraryState(e,r);return t?`${n}${$s.RESOURCE_DELIM}${t}`:n}static generateLibraryState(e,t){if(!e)throw ml(Xc);const r={id:e.createNewGuid()};t&&(r.meta=t);const n=JSON.stringify(r);return e.base64Encode(n)}static parseRequestState(e,t){if(!e)throw ml(Xc);if(!t)throw ml(Oc);try{const r=t.split($s.RESOURCE_DELIM),n=r[0],o=r.length>1?r.slice(1).join($s.RESOURCE_DELIM):$s.EMPTY_STRING,i=e.base64Decode(n),a=JSON.parse(i);return{userRequestState:o||$s.EMPTY_STRING,libraryState:a}}catch(e){throw ml(Oc)}}}class iy{constructor(e,t){this.cryptoUtils=e,this.performanceClient=t}async generateCnf(e,t){this.performanceClient?.addQueueMeasurement(Ud,e.correlationId);const r=await mg(this.generateKid.bind(this),Ud,t,this.performanceClient,e.correlationId)(e),n=this.cryptoUtils.base64UrlEncode(JSON.stringify(r));return{kid:r.kid,reqCnfString:n}}async generateKid(e){return this.performanceClient?.addQueueMeasurement(jd,e.correlationId),{kid:await this.cryptoUtils.getPublicKeyThumbprint(e),xms_ksl:"sw"}}async signPopToken(e,t,r){return this.signPayload(e,t,r)}async signPayload(e,t,r,n){const{resourceRequestMethod:o,resourceRequestUri:i,shrClaims:a,shrNonce:s,shrOptions:c}=r,l=i?new Su(i):void 0,u=l?.getUrlComponents();return this.cryptoUtils.signJwt({at:e,ts:Al(),m:o?.toUpperCase(),u:u?.HostNameAndPort,nonce:s||this.cryptoUtils.createNewGuid(),p:u?.AbsolutePath,q:u?.QueryString?[[],u.QueryString]:void 0,client_claims:a||void 0,...n},t,c,r.correlationId)}}class ay{constructor(e,t){this.cache=e,this.hasChanged=t}get cacheHasChanged(){return this.hasChanged}get tokenCache(){return this.cache}}class sy{constructor(e,t,r,n,o,i,a){this.clientId=e,this.cacheStorage=t,this.cryptoObj=r,this.logger=n,this.serializableCache=o,this.persistencePlugin=i,this.performanceClient=a}validateTokenResponse(e,t){if(e.error||e.error_description||e.suberror){const r=`Error(s): ${e.error_codes||$s.NOT_AVAILABLE} - Timestamp: ${e.timestamp||$s.NOT_AVAILABLE} - Description: ${e.error_description||$s.NOT_AVAILABLE} - Correlation ID: ${e.correlation_id||$s.NOT_AVAILABLE} - Trace ID: ${e.trace_id||$s.NOT_AVAILABLE}`,n=e.error_codes?.length?e.error_codes[0]:void 0,o=new ty(e.error,r,e.suberror,n,e.status);if(t&&e.status&&e.status>=500&&e.status<=599)return void this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently unavailable and the access token is unable to be refreshed.\n${o}`);if(t&&e.status&&e.status>=400&&e.status<=499)return void this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently available but is unable to refresh the access token.\n${o}`);if(_g(e.error,e.error_description,e.suberror))throw new xg(e.error,e.error_description,e.suberror,e.timestamp||$s.EMPTY_STRING,e.trace_id||$s.EMPTY_STRING,e.correlation_id||$s.EMPTY_STRING,e.claims||$s.EMPTY_STRING,n);throw o}}async handleServerTokenResponse(e,t,r,n,o,i,a,s,c){let l,u;if(this.performanceClient?.addQueueMeasurement(zd,e.correlation_id),e.id_token){if(l=wl(e.id_token||$s.EMPTY_STRING,this.cryptoObj.base64Decode),o&&o.nonce&&l.nonce!==o.nonce)throw ml(Bc);if(n.maxAge||0===n.maxAge){const e=l.auth_time;if(!e)throw ml(Lc);Cl(e,n.maxAge)}}this.homeAccountIdentifier=wu.generateHomeAccountId(e.client_info||$s.EMPTY_STRING,t.authorityType,this.logger,this.cryptoObj,l),o&&o.state&&(u=oy.parseRequestState(this.cryptoObj,o.state)),e.key_id=e.key_id||n.sshKid||void 0;const d=this.generateCacheRecord(e,t,r,n,l,i,o);let h;try{if(this.persistencePlugin&&this.serializableCache&&(this.logger.verbose("Persistence enabled, calling beforeCacheAccess"),h=new ay(this.serializableCache,!0),await this.persistencePlugin.beforeCacheAccess(h)),a&&!s&&d.account){const e=d.account.generateAccountKey();if(!this.cacheStorage.getAccount(e))return this.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),await sy.generateAuthenticationResult(this.cryptoObj,t,d,!1,n,l,u,void 0,c)}await this.cacheStorage.saveCacheRecord(d,n.correlationId,n.storeInCache)}finally{this.persistencePlugin&&this.serializableCache&&h&&(this.logger.verbose("Persistence enabled, calling afterCacheAccess"),await this.persistencePlugin.afterCacheAccess(h))}return sy.generateAuthenticationResult(this.cryptoObj,t,d,!1,n,l,u,e,c)}generateCacheRecord(e,t,r,n,o,i,a){const s=t.getPreferredCache();if(!s)throw ml(Qc);const c=bu(o);let l,u;e.id_token&&o&&(l=xl(this.homeAccountIdentifier,s,e.id_token,this.clientId,c||""),u=cy(this.cacheStorage,t,this.homeAccountIdentifier,this.cryptoObj.base64Decode,o,e.client_info,s,c,a,void 0,this.logger));let d=null;if(e.access_token){const o=e.scope?pu.fromString(e.scope):new pu(n.scopes||[]),a=("string"==typeof e.expires_in?parseInt(e.expires_in,10):e.expires_in)||0,l=("string"==typeof e.ext_expires_in?parseInt(e.ext_expires_in,10):e.ext_expires_in)||0,u=("string"==typeof e.refresh_in?parseInt(e.refresh_in,10):e.refresh_in)||void 0,h=r+a,p=h+l,f=u&&u>0?r+u:void 0;d=_l(this.homeAccountIdentifier,s,e.access_token,this.clientId,c||t.tenant||"",o.printScopes(),h,p,this.cryptoObj.base64Decode,f,e.token_type,i,e.key_id,n.claims,n.requestedClaimsHash)}let h=null;if(e.refresh_token){let t;e.refresh_token_expires_in&&(t=r+("string"==typeof e.refresh_token_expires_in?parseInt(e.refresh_token_expires_in,10):e.refresh_token_expires_in)),h=Pl(this.homeAccountIdentifier,s,e.refresh_token,this.clientId,e.foci,i,t)}let p=null;return e.foci&&(p={clientId:this.clientId,environment:s,familyId:e.foci}),{account:u,idToken:l,accessToken:d,refreshToken:h,appMetadata:p}}static async generateAuthenticationResult(e,t,r,n,o,i,a,s,c){let l,u,d=$s.EMPTY_STRING,h=[],p=null,f=$s.EMPTY_STRING;if(r.accessToken){if(r.accessToken.tokenType!==hc.POP||o.popKid)d=r.accessToken.secret;else{const t=new iy(e),{secret:n,keyId:i}=r.accessToken;if(!i)throw ml(cl);d=await t.signPopToken(n,i,o)}h=pu.fromString(r.accessToken.target).asArray(),p=Sl(r.accessToken.expiresOn),l=Sl(r.accessToken.extendedExpiresOn),r.accessToken.refreshOn&&(u=Sl(r.accessToken.refreshOn))}r.appMetadata&&(f=r.appMetadata.familyId===ic?ic:"");const g=i?.oid||i?.sub||"",m=i?.tid||"";s?.spa_accountid&&r.account&&(r.account.nativeAccountId=s?.spa_accountid);const y=r.account?vu(r.account.getAccountInfo(),void 0,i,r.idToken?.secret):null;return{authority:t.canonicalAuthority,uniqueId:g,tenantId:m,scopes:h,account:y,idToken:r?.idToken?.secret||"",idTokenClaims:i||{},accessToken:d,fromCache:n,expiresOn:p,extExpiresOn:l,refreshOn:u,correlationId:o.correlationId,requestId:c||$s.EMPTY_STRING,familyId:f,tokenType:r.accessToken?.tokenType||$s.EMPTY_STRING,state:a?a.userRequestState:$s.EMPTY_STRING,cloudGraphHostName:r.account?.cloudGraphHostName||$s.EMPTY_STRING,msGraphHost:r.account?.msGraphHost||$s.EMPTY_STRING,code:s?.spa_code,fromNativeBroker:!1}}}function cy(e,t,r,n,o,i,a,s,c,l,u){u?.verbose("setCachedAccount called");const d=e.getAccountKeys().find((e=>e.startsWith(r)));let h=null;d&&(h=e.getAccount(d));const p=h||wu.createAccount({homeAccountId:r,idTokenClaims:o,clientInfo:i,environment:a,cloudGraphHostName:c?.cloud_graph_host_name,msGraphHost:c?.msgraph_host,nativeAccountId:l},t,n),f=p.tenantProfiles||[],g=s||p.realm;if(g&&!f.find((e=>e.tenantId===g))){const e=yu(r,p.localAccountId,g,o);f.push(e)}return p.tenantProfiles=f,p}class ly{static validateRedirectUri(e){if(!e)throw du(Fl)}static validatePrompt(e){const t=[];for(const e in Xs)t.push(Xs[e]);if(t.indexOf(e)<0)throw du(Gl)}static validateClaims(e){try{JSON.parse(e)}catch(e){throw du(Vl)}}static validateCodeChallengeParams(e,t){if(!e||!t)throw du(Xl);this.validateCodeChallengeMethod(t)}static validateCodeChallengeMethod(e){if([Zs.PLAIN,Zs.S256].indexOf(e)<0)throw du(Jl)}}async function uy(e,t,r){return"string"==typeof e?e:e({clientId:t,tokenEndpoint:r})}class dy extends ny{constructor(e,t){super(e,t),this.includeRedirectUri=!0,this.oidcDefaultScopes=this.config.authOptions.authority.options.OIDCOptions?.defaultScopes}async acquireToken(e,t){if(this.performanceClient?.addQueueMeasurement($d,e.correlationId),!e.code)throw ml(Fc);const r=Al(),n=await mg(this.executeTokenRequest.bind(this),Dd,this.logger,this.performanceClient,e.correlationId)(this.authority,e),o=n.headers?.[Ks],i=new sy(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin,this.performanceClient);return i.validateTokenResponse(n.body),mg(i.handleServerTokenResponse.bind(i),zd,this.logger,this.performanceClient,e.correlationId)(n.body,this.authority,r,e,t,void 0,void 0,void 0,o)}getLogoutUri(e){if(!e)throw du(Ql);const t=this.createLogoutUrlQueryString(e);return Su.appendQueryString(this.authority.endSessionEndpoint,t)}async executeTokenRequest(e,t){this.performanceClient?.addQueueMeasurement(Dd,t.correlationId);const r=this.createTokenQueryParameters(t),n=Su.appendQueryString(e.tokenEndpoint,r),o=await mg(this.createTokenRequestBody.bind(this),Fd,this.logger,this.performanceClient,t.correlationId)(t);let i;if(t.clientInfo)try{const e=fu(t.clientInfo,this.cryptoUtils.base64Decode);i={credential:`${e.uid}.${e.utid}`,type:mm}}catch(e){this.logger.verbose("Could not parse client info for CCS Header: "+e)}const a=this.createTokenRequestHeaders(i||t.ccsCredential),s=Rg(this.config.authOptions.clientId,t);return mg(this.executePostToTokenEndpoint.bind(this),ud,this.logger,this.performanceClient,t.correlationId)(n,o,a,s,t.correlationId,ud)}async createTokenRequestBody(e){this.performanceClient?.addQueueMeasurement(Fd,e.correlationId);const t=new Map;if(Pm(t,e.embeddedClientId||e.tokenBodyParameters?.[vm]||this.config.authOptions.clientId),this.includeRedirectUri?Rm(t,e.redirectUri):ly.validateRedirectUri(e.redirectUri),_m(t,e.scopes,!0,this.oidcDefaultScopes),function(e,t){e.set("code",t)}(t,e.code),Hm(t,this.config.libraryInfo),$m(t,this.config.telemetry.application),Xm(t),this.serverTelemetryManager&&!Ku(this.config)&&Jm(t,this.serverTelemetryManager),e.codeVerifier&&function(e,t){e.set("code_verifier",t)}(t,e.codeVerifier),this.config.clientCredentials.clientSecret&&Fm(t,this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){const r=this.config.clientCredentials.clientAssertion;Um(t,await uy(r.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),jm(t,r.assertionType)}if(zm(t,"authorization_code"),Km(t),e.authenticationScheme===hc.POP){const r=new iy(this.cryptoUtils,this.performanceClient);let n;n=e.popKid?this.cryptoUtils.encodeKid(e.popKid):(await mg(r.generateCnf.bind(r),Ud,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString,Ym(t,n)}else if(e.authenticationScheme===hc.SSH){if(!e.sshJwk)throw du(ru);Qm(t,e.sshJwk)}let r;if((!hu.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&Lm(t,e.claims,this.config.authOptions.clientCapabilities),e.clientInfo)try{const t=fu(e.clientInfo,this.cryptoUtils.base64Decode);r={credential:`${t.uid}.${t.utid}`,type:mm}}catch(e){this.logger.verbose("Could not parse client info for CCS Header: "+e)}else r=e.ccsCredential;if(this.config.systemOptions.preventCorsPreflight&&r)switch(r.type){case mm:try{Nm(t,gu(r.credential))}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}break;case ym:Mm(t,r.credential)}return e.embeddedClientId&&Zm(t,this.config.authOptions.clientId,this.config.authOptions.redirectUri),e.tokenBodyParameters&&Gm(t,e.tokenBodyParameters),!e.enableSpaAuthorizationCode||e.tokenBodyParameters&&e.tokenBodyParameters[Am]||Gm(t,{[Am]:"1"}),Em(t,e.correlationId,this.performanceClient),ku(t)}createLogoutUrlQueryString(e){const t=new Map;return e.postLogoutRedirectUri&&function(e,t){e.set("post_logout_redirect_uri",t)}(t,e.postLogoutRedirectUri),e.correlationId&&qm(t,e.correlationId),e.idTokenHint&&function(e,t){e.set("id_token_hint",t)}(t,e.idTokenHint),e.state&&Dm(t,e.state),e.logoutHint&&function(e,t){e.set("logout_hint",t)}(t,e.logoutHint),e.extraQueryParameters&&Gm(t,e.extraQueryParameters),this.config.authOptions.instanceAware&&Wm(t),ku(t,this.config.authOptions.encodeExtraQueryParams,e.extraQueryParameters)}}class hy{constructor(e,t){this.cacheOutcome="0",this.cacheManager=t,this.apiId=e.apiId,this.correlationId=e.correlationId,this.wrapperSKU=e.wrapperSKU||$s.EMPTY_STRING,this.wrapperVer=e.wrapperVer||$s.EMPTY_STRING,this.telemetryCacheKey=dc.CACHE_KEY+rc+e.clientId}generateCurrentRequestHeaderValue(){const e=`${this.apiId}${dc.VALUE_SEPARATOR}${this.cacheOutcome}`,t=[this.wrapperSKU,this.wrapperVer],r=this.getNativeBrokerErrorCode();r?.length&&t.push(`broker_error=${r}`);const n=t.join(dc.VALUE_SEPARATOR),o=[e,this.getRegionDiscoveryFields()].join(dc.VALUE_SEPARATOR);return[dc.SCHEMA_VERSION,o,n].join(dc.CATEGORY_SEPARATOR)}generateLastRequestHeaderValue(){const e=this.getLastRequests(),t=hy.maxErrorsToSend(e),r=e.failedRequests.slice(0,2*t).join(dc.VALUE_SEPARATOR),n=e.errors.slice(0,t).join(dc.VALUE_SEPARATOR),o=e.errors.length,i=[o,t<o?dc.OVERFLOW_TRUE:dc.OVERFLOW_FALSE].join(dc.VALUE_SEPARATOR);return[dc.SCHEMA_VERSION,e.cacheHits,r,n,i].join(dc.CATEGORY_SEPARATOR)}cacheFailedRequest(e){const t=this.getLastRequests();t.errors.length>=dc.MAX_CACHED_ERRORS&&(t.failedRequests.shift(),t.failedRequests.shift(),t.errors.shift()),t.failedRequests.push(this.apiId,this.correlationId),e instanceof Error&&e&&e.toString()?e instanceof Ac?e.subError?t.errors.push(e.subError):e.errorCode?t.errors.push(e.errorCode):t.errors.push(e.toString()):t.errors.push(e.toString()):t.errors.push(dc.UNKNOWN_ERROR),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t)}incrementCacheHits(){const e=this.getLastRequests();return e.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e),e.cacheHits}getLastRequests(){return this.cacheManager.getServerTelemetry(this.telemetryCacheKey)||{failedRequests:[],errors:[],cacheHits:0}}clearTelemetryCache(){const e=this.getLastRequests(),t=hy.maxErrorsToSend(e);if(t===e.errors.length)this.cacheManager.removeItem(this.telemetryCacheKey);else{const r={failedRequests:e.failedRequests.slice(2*t),errors:e.errors.slice(t),cacheHits:0};this.cacheManager.setServerTelemetry(this.telemetryCacheKey,r)}}static maxErrorsToSend(e){let t,r=0,n=0;const o=e.errors.length;for(t=0;t<o;t++){const o=e.failedRequests[2*t]||$s.EMPTY_STRING,i=e.failedRequests[2*t+1]||$s.EMPTY_STRING,a=e.errors[t]||$s.EMPTY_STRING;if(n+=o.toString().length+i.toString().length+a.length+3,!(n<dc.MAX_LAST_HEADER_BYTES))break;r+=1}return r}getRegionDiscoveryFields(){const e=[];return e.push(this.regionUsed||$s.EMPTY_STRING),e.push(this.regionSource||$s.EMPTY_STRING),e.push(this.regionOutcome||$s.EMPTY_STRING),e.join(",")}updateRegionDiscoveryMetadata(e){this.regionUsed=e.region_used,this.regionSource=e.region_source,this.regionOutcome=e.region_outcome}setCacheOutcome(e){this.cacheOutcome=e}setNativeBrokerErrorCode(e){const t=this.getLastRequests();t.nativeBrokerErrorCode=e,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t)}getNativeBrokerErrorCode(){return this.getLastRequests().nativeBrokerErrorCode}clearNativeBrokerErrorCode(){const e=this.getLastRequests();delete e.nativeBrokerErrorCode,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e)}static makeExtraSkuString(e){return function(e){const{skus:t,libraryName:r,libraryVersion:n,extensionName:o,extensionVersion:i}=e,a=new Map([[0,[r,n]],[2,[o,i]]]);let s=[];if(t?.length){if(s=t.split(","),s.length<4)return t}else s=Array.from({length:4},(()=>"|"));return a.forEach(((e,t)=>{2===e.length&&e[0]?.length&&e[1]?.length&&function(e){const{skuArr:t,index:r,skuName:n,skuVersion:o}=e;r>=t.length||(t[r]=[n,o].join("|"))}({skuArr:s,index:t,skuName:e[0],skuVersion:e[1]})})),s.join(",")}(e)}}class py{constructor(e,t,r,n,o,i,a,s,c){this.config=e,this.browserStorage=t,this.browserCrypto=r,this.networkClient=this.config.system.networkClient,this.eventHandler=o,this.navigationClient=i,this.nativeMessageHandler=s,this.correlationId=c||Pf(),this.logger=n.clone(Ph,eg,this.correlationId),this.performanceClient=a}async clearCacheOnLogout(e){if(e){wu.accountInfoIsEqual(e,this.browserStorage.getActiveAccount(),!1)&&(this.logger.verbose("Setting active account to null"),this.browserStorage.setActiveAccount(null));try{await this.browserStorage.removeAccount(wu.generateAccountCacheKey(e)),this.logger.verbose("Cleared cache items belonging to the account provided in the logout request.")}catch(e){this.logger.error("Account provided in logout request was not found. Local cache unchanged.")}}else try{this.logger.verbose("No account provided in logout request, clearing all cache items.",this.correlationId),await this.browserStorage.clear(),await this.browserCrypto.clearKeystore()}catch(e){this.logger.error("Attempted to clear all MSAL cache items and failed. Local cache unchanged.")}}getRedirectUri(e){this.logger.verbose("getRedirectUri called");const t=e||this.config.auth.redirectUri;return Su.getAbsoluteUrl(t,Vf())}initializeServerTelemetryManager(e,t){this.logger.verbose("initializeServerTelemetryManager called");const r={clientId:this.config.auth.clientId,correlationId:this.correlationId,apiId:e,forceRefresh:t||!1,wrapperSKU:this.browserStorage.getWrapperMetadata()[0],wrapperVer:this.browserStorage.getWrapperMetadata()[1]};return new hy(r,this.browserStorage)}async getDiscoveredAuthority(e){const{account:t}=e,r=e.requestExtraQueryParameters&&e.requestExtraQueryParameters.hasOwnProperty("instance_aware")?e.requestExtraQueryParameters.instance_aware:void 0;this.performanceClient.addQueueMeasurement(ad,this.correlationId);const n={protocolMode:this.config.auth.protocolMode,OIDCOptions:this.config.auth.OIDCOptions,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},o=e.requestAuthority||this.config.auth.authority,i=r?.length?"true"===r:this.config.auth.instanceAware,a=t&&i?this.config.auth.authority.replace(Su.getDomainFromUrl(o),t.environment):o,s=vg.generateAuthority(a,e.requestAzureCloudOptions||this.config.auth.azureCloudOptions),c=await mg(ey,Wd,this.logger,this.performanceClient,this.correlationId)(s,this.config.system.networkClient,this.browserStorage,n,this.logger,this.correlationId,this.performanceClient);if(t&&!c.isAlias(t.environment))throw du(cu);return c}}async function fy(e,t,r,n){r.addQueueMeasurement(wd,e.correlationId);const o=e.authority||t.auth.authority,i=[...e&&e.scopes||[]],a={...e,correlationId:e.correlationId,authority:o,scopes:i};if(a.authenticationScheme){if(a.authenticationScheme===hc.SSH){if(!e.sshJwk)throw du(ru);if(!e.sshKid)throw du(nu)}n.verbose(`Authentication Scheme set to "${a.authenticationScheme}" as configured in Auth request`)}else a.authenticationScheme=hc.BEARER,n.verbose('Authentication Scheme wasn\'t explicitly set in request, defaulting to "Bearer" request');return t.cache.claimsBasedCachingEnabled&&e.claims&&!hu.isEmptyObj(e.claims)&&(a.requestedClaimsHash=await $f(e.claims)),a}async function gy(e,t,r,n,o){n.addQueueMeasurement(Cd,e.correlationId);const i=await mg(fy,wd,o,n,e.correlationId)(e,r,n,o);return{...e,...i,account:t,forceRefresh:e.forceRefresh||!1}}class my extends py{initializeLogoutRequest(e){this.logger.verbose("initializeLogoutRequest called",e?.correlationId);const t={correlationId:this.correlationId||Pf(),...e};if(e)if(e.logoutHint)this.logger.verbose("logoutHint has already been set in logoutRequest");else if(e.account){const r=this.getLogoutHintFromIdTokenClaims(e.account);r&&(this.logger.verbose("Setting logoutHint to login_hint ID Token Claim value for the account provided"),t.logoutHint=r)}else this.logger.verbose("logoutHint was not set and account was not passed into logout request, logoutHint will not be set");else this.logger.verbose("logoutHint will not be set since no logout request was configured");return e&&null===e.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri passed as null, not setting post logout redirect uri",t.correlationId):e&&e.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to uri set on logout request",t.correlationId),t.postLogoutRedirectUri=Su.getAbsoluteUrl(e.postLogoutRedirectUri,Vf())):null===this.config.auth.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri configured as null and no uri set on request, not passing post logout redirect",t.correlationId):this.config.auth.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to configured uri",t.correlationId),t.postLogoutRedirectUri=Su.getAbsoluteUrl(this.config.auth.postLogoutRedirectUri,Vf())):(this.logger.verbose("Setting postLogoutRedirectUri to current page",t.correlationId),t.postLogoutRedirectUri=Su.getAbsoluteUrl(Vf(),Vf())),t}getLogoutHintFromIdTokenClaims(e){const t=e.idTokenClaims;if(t){if(t.login_hint)return t.login_hint;this.logger.verbose("The ID Token Claims tied to the provided account do not contain a login_hint claim, logoutHint will not be added to logout request")}else this.logger.verbose("The provided account does not contain ID Token Claims, logoutHint will not be added to logout request");return null}async createAuthCodeClient(e){this.performanceClient.addQueueMeasurement(_d,this.correlationId);const t=await mg(this.getClientConfiguration.bind(this),Pd,this.logger,this.performanceClient,this.correlationId)(e);return new dy(t,this.performanceClient)}async getClientConfiguration(e){const{serverTelemetryManager:t,requestAuthority:r,requestAzureCloudOptions:n,requestExtraQueryParameters:o,account:i}=e;this.performanceClient.addQueueMeasurement(Pd,this.correlationId);const a=await mg(this.getDiscoveredAuthority.bind(this),ad,this.logger,this.performanceClient,this.correlationId)({requestAuthority:r,requestAzureCloudOptions:n,requestExtraQueryParameters:o,account:i}),s=this.config.system.loggerOptions;return{authOptions:{clientId:this.config.auth.clientId,authority:a,clientCapabilities:this.config.auth.clientCapabilities,redirectUri:this.config.auth.redirectUri},systemOptions:{tokenRenewalOffsetSeconds:this.config.system.tokenRenewalOffsetSeconds,preventCorsPreflight:!0},loggerOptions:{loggerCallback:s.loggerCallback,piiLoggingEnabled:s.piiLoggingEnabled,logLevel:s.logLevel,correlationId:this.correlationId},cacheOptions:{claimsBasedCachingEnabled:this.config.cache.claimsBasedCachingEnabled},cryptoInterface:this.browserCrypto,networkInterface:this.networkClient,storageInterface:this.browserStorage,serverTelemetryManager:t,libraryInfo:{sku:Ph,version:eg,cpu:$s.EMPTY_STRING,os:$s.EMPTY_STRING},telemetry:this.config.telemetry}}async initializeAuthorizationRequest(e,t){this.performanceClient.addQueueMeasurement(Rd,this.correlationId);const r=this.getRedirectUri(e.redirectUri),n={interactionType:t},o=oy.setRequestState(this.browserCrypto,e&&e.state||$s.EMPTY_STRING,n),i={...await mg(fy,wd,this.logger,this.performanceClient,this.correlationId)({...e,correlationId:this.correlationId},this.config,this.performanceClient,this.logger),redirectUri:r,state:o,nonce:e.nonce||Pf(),responseMode:this.config.auth.OIDCOptions.serverResponseType};if(e.loginHint||e.sid)return i;const a=e.account||this.browserStorage.getActiveAccount();return a&&(this.logger.verbose("Setting validated request account",this.correlationId),this.logger.verbosePii(`Setting validated request account: ${a.homeAccountId}`,this.correlationId),i.account=a),i}}const yy="user_switch",vy={[yy]:"User attempted to switch accounts in the native broker, which is not allowed. All new accounts must sign-in through the standard web flow first, please try again."};class by extends Ac{constructor(e,t,r){super(e,t),Object.setPrototypeOf(this,by.prototype),this.name="NativeAuthError",this.ext=r}}function wy(e){return!(!e.ext||!e.ext.status||"PERSISTENT_ERROR"!==e.ext.status&&"DISABLED"!==e.ext.status)||!(!e.ext||!e.ext.error||-2147186943!==e.ext.error)||"ContentError"===e.errorCode}function Cy(e,t,r){if(r&&r.status)switch(r.status){case"ACCOUNT_UNAVAILABLE":return Pg(Ag);case"USER_INTERACTION_REQUIRED":return new xg(e,t);case"USER_CANCEL":return sf(wp);case"NO_NETWORK":return sf(Lp)}return new by(e,vy[e]||t,r)}var Ay=r(64583).Promise;class ky{constructor(e,t,r,n){this.logger=e,this.handshakeTimeoutMs=t,this.extensionId=n,this.resolvers=new Map,this.handshakeResolvers=new Map,this.messageChannel=new MessageChannel,this.windowListener=this.onWindowMessage.bind(this),this.performanceClient=r,this.handshakeEvent=r.startMeasurement(ih)}async sendMessage(e){this.logger.trace("NativeMessageHandler - sendMessage called.");const t={channel:Rh,extensionId:this.extensionId,responseId:Pf(),body:e};return this.logger.trace("NativeMessageHandler - Sending request to browser extension"),this.logger.tracePii(`NativeMessageHandler - Sending request to browser extension: ${JSON.stringify(t)}`),this.messageChannel.port1.postMessage(t),new Ay(((e,r)=>{this.resolvers.set(t.responseId,{resolve:e,reject:r})}))}static async createProvider(e,t,r){e.trace("NativeMessageHandler - createProvider called.");try{const n=new ky(e,t,r,Oh);return await n.sendHandshakeRequest(),n}catch(n){const o=new ky(e,t,r);return await o.sendHandshakeRequest(),o}}async sendHandshakeRequest(){this.logger.trace("NativeMessageHandler - sendHandshakeRequest called."),window.addEventListener("message",this.windowListener,!1);const e={channel:Rh,extensionId:this.extensionId,responseId:Pf(),body:{method:Mh}};return this.handshakeEvent.add({extensionId:this.extensionId,extensionHandshakeTimeoutMs:this.handshakeTimeoutMs}),this.messageChannel.port1.onmessage=e=>{this.onChannelMessage(e)},window.postMessage(e,window.origin,[this.messageChannel.port2]),new Ay(((t,r)=>{this.handshakeResolvers.set(e.responseId,{resolve:t,reject:r}),this.timeoutId=window.setTimeout((()=>{window.removeEventListener("message",this.windowListener,!1),this.messageChannel.port1.close(),this.messageChannel.port2.close(),this.handshakeEvent.end({extensionHandshakeTimedOut:!0,success:!1}),r(sf(Gp)),this.handshakeResolvers.delete(e.responseId)}),this.handshakeTimeoutMs)}))}onWindowMessage(e){if(this.logger.trace("NativeMessageHandler - onWindowMessage called"),e.source!==window)return;const t=e.data;if(t.channel&&t.channel===Rh&&(!t.extensionId||t.extensionId===this.extensionId)&&t.body.method===Mh){const e=this.handshakeResolvers.get(t.responseId);if(!e)return void this.logger.trace(`NativeMessageHandler.onWindowMessage - resolver can't be found for request ${t.responseId}`);this.logger.verbose(t.extensionId?`Extension with id: ${t.extensionId} not installed`:"No extension installed"),clearTimeout(this.timeoutId),this.messageChannel.port1.close(),this.messageChannel.port2.close(),window.removeEventListener("message",this.windowListener,!1),this.handshakeEvent.end({success:!1,extensionInstalled:!1}),e.reject(sf(Vp))}}onChannelMessage(e){this.logger.trace("NativeMessageHandler - onChannelMessage called.");const t=e.data,r=this.resolvers.get(t.responseId),n=this.handshakeResolvers.get(t.responseId);try{const e=t.body.method;if("Response"===e){if(!r)return;const e=t.body.response;if(this.logger.trace("NativeMessageHandler - Received response from browser extension"),this.logger.tracePii(`NativeMessageHandler - Received response from browser extension: ${JSON.stringify(e)}`),"Success"!==e.status)r.reject(Cy(e.code,e.description,e.ext));else{if(!e.result)throw kc(bc,"Event does not contain result.");e.result.code&&e.result.description?r.reject(Cy(e.result.code,e.result.description,e.result.ext)):r.resolve(e.result)}this.resolvers.delete(t.responseId)}else if("HandshakeResponse"===e){if(!n)return void this.logger.trace(`NativeMessageHandler.onChannelMessage - resolver can't be found for request ${t.responseId}`);clearTimeout(this.timeoutId),window.removeEventListener("message",this.windowListener,!1),this.extensionId=t.extensionId,this.extensionVersion=t.body.version,this.logger.verbose(`NativeMessageHandler - Received HandshakeResponse from extension: ${this.extensionId}`),this.handshakeEvent.end({extensionInstalled:!0,success:!0}),n.resolve(),this.handshakeResolvers.delete(t.responseId)}}catch(t){this.logger.error("Error parsing response from WAM Extension"),this.logger.errorPii(`Error parsing response from WAM Extension: ${t}`),this.logger.errorPii(`Unable to parse ${e}`),r?r.reject(t):n&&n.reject(t)}}getExtensionId(){return this.extensionId}getExtensionVersion(){return this.extensionVersion}static isPlatformBrokerAvailable(e,t,r,n){if(t.trace("isPlatformBrokerAvailable called"),!e.system.allowPlatformBroker)return t.trace("isPlatformBrokerAvailable: allowPlatformBroker is not enabled, returning false"),!1;if(!r)return t.trace("isPlatformBrokerAvailable: Platform extension provider is not initialized, returning false"),!1;if(n)switch(n){case hc.BEARER:case hc.POP:return t.trace("isPlatformBrokerAvailable: authenticationScheme is supported, returning true"),!0;default:return t.trace("isPlatformBrokerAvailable: authenticationScheme is not supported, returning false"),!1}return!0}}function Sy(e,t,r){const n=Au(e);if(!n)throw Cu(e)?(r.error(`A ${t} is present in the iframe but it does not contain known properties. It's likely that the ${t} has been replaced by code running on the redirectUri page.`),r.errorPii(`The ${t} detected is: ${e}`),sf(fp)):(r.error(`The request has returned to the redirectUri but a ${t} is not present. It's likely that the ${t} has been removed or the page has been redirected by code running on the redirectUri page.`),sf(hp));return n}function Ty(e,t,r,n){const o=ku(t,r,n);return Su.appendQueryString(e.authorizationEndpoint,o)}function Iy(e,t){if(!e.state||!t)throw e.state?ml(Nc,"Cached State"):ml(Nc,"Server State");let r,n;try{r=decodeURIComponent(e.state)}catch(t){throw ml(Oc,e.state)}try{n=decodeURIComponent(t)}catch(t){throw ml(Oc,e.state)}if(r!==n)throw ml(Mc);if(e.error||e.error_description||e.suberror){const t=function(e){const t="code=",r=e.error_uri?.lastIndexOf(t);return r&&r>=0?e.error_uri?.substring(r+5):void 0}(e);if(_g(e.error,e.error_description,e.suberror))throw new xg(e.error||"",e.error_description,e.suberror,e.timestamp||"",e.trace_id||"",e.correlation_id||"",e.claims||"",t);throw new ty(e.error||"",e.error_description,e.suberror,t)}}class Ey{constructor(e,t,r,n,o){this.authModule=e,this.browserStorage=t,this.authCodeRequest=r,this.logger=n,this.performanceClient=o}async handleCodeResponse(e,t){let r;this.performanceClient.addQueueMeasurement(Nd,t.correlationId);try{r=function(e,t){if(Iy(e,t),!e.code)throw ml(il);return e}(e,t.state)}catch(e){throw e instanceof ty&&e.subError===wp?sf(wp):e}return mg(this.handleCodeResponseFromServer.bind(this),Md,this.logger,this.performanceClient,t.correlationId)(r,t)}async handleCodeResponseFromServer(e,t,r=!0){if(this.performanceClient.addQueueMeasurement(Md,t.correlationId),this.logger.trace("InteractionHandler.handleCodeResponseFromServer called"),this.authCodeRequest.code=e.code,e.cloud_instance_host_name&&await mg(this.authModule.updateAuthority.bind(this.authModule),Hd,this.logger,this.performanceClient,t.correlationId)(e.cloud_instance_host_name,t.correlationId),r&&(e.nonce=t.nonce||void 0),e.state=t.state,e.client_info)this.authCodeRequest.clientInfo=e.client_info;else{const e=this.createCcsCredentials(t);e&&(this.authCodeRequest.ccsCredential=e)}return await mg(this.authModule.acquireToken.bind(this.authModule),$d,this.logger,this.performanceClient,t.correlationId)(this.authCodeRequest,e)}createCcsCredentials(e){return e.account?{credential:e.account.homeAccountId,type:mm}:e.loginHint?{credential:e.loginHint,type:ym}:null}}class xy extends ny{constructor(e,t){super(e,t)}async acquireCachedToken(e){this.performanceClient?.addQueueMeasurement(yd,e.correlationId);let t="0";if(e.forceRefresh||!this.config.cacheOptions.claimsBasedCachingEnabled&&!hu.isEmptyObj(e.claims))throw this.setCacheOutcome("1",e.correlationId),ml(rl);if(!e.account)throw ml(Vc);const r=e.account.tenantId||function(e){const t=new Su(e).getUrlComponents(),r=t.PathSegments.slice(-1)[0]?.toLowerCase();switch(r){case Vs:case Ys:case Qs:return;default:return r}}(e.authority),n=this.cacheManager.getTokenKeys(),o=this.cacheManager.getAccessToken(e.account,e,n,r,this.performanceClient,e.correlationId);if(!o)throw this.setCacheOutcome("2",e.correlationId),ml(rl);if(Il(o.cachedAt)||Tl(o.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw this.setCacheOutcome("3",e.correlationId),ml(rl);o.refreshOn&&Tl(o.refreshOn,0)&&(t="4");const i=e.authority||this.authority.getPreferredCache(),a={account:this.cacheManager.readAccountFromCache(e.account),accessToken:o,idToken:this.cacheManager.getIdToken(e.account,n,r,this.performanceClient,e.correlationId),refreshToken:null,appMetadata:this.cacheManager.readAppMetadataFromCache(i)};return this.setCacheOutcome(t,e.correlationId),this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),[await mg(this.generateResultFromCacheRecord.bind(this),vd,this.logger,this.performanceClient,e.correlationId)(a,e),t]}setCacheOutcome(e,t){this.serverTelemetryManager?.setCacheOutcome(e),this.performanceClient?.addFields({cacheOutcome:e},t),"0"!==e&&this.logger.info(`Token refresh is required due to cache outcome: ${e}`)}async generateResultFromCacheRecord(e,t){let r;if(this.performanceClient?.addQueueMeasurement(vd,t.correlationId),e.idToken&&(r=wl(e.idToken.secret,this.config.cryptoInterface.base64Decode)),t.maxAge||0===t.maxAge){const e=r?.auth_time;if(!e)throw ml(Lc);Cl(e,t.maxAge)}return sy.generateAuthenticationResult(this.cryptoUtils,this.authority,e,!0,t,r)}}class _y extends my{async acquireToken(e){this.performanceClient.addQueueMeasurement(rd,e.correlationId);const t=this.initializeServerTelemetryManager(61),r=await mg(this.getClientConfiguration.bind(this),Pd,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:t,requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,account:e.account}),n=new xy(r,this.performanceClient);this.logger.verbose("Silent auth client created");try{const t=(await mg(n.acquireCachedToken.bind(n),yd,this.logger,this.performanceClient,e.correlationId)(e))[0];return this.performanceClient.addFields({fromCache:!0},e.correlationId),t}catch(e){throw e instanceof af&&e.errorCode===Fp&&this.logger.verbose("Signing keypair for bound access token not found. Refreshing bound access token and generating a new crypto keypair."),e}}logout(e){this.logger.verbose("logoutRedirect called");const t=this.initializeLogoutRequest(e);return this.clearCacheOnLogout(t?.account)}}var Py=r(64583).Promise;class Ry extends py{constructor(e,t,r,n,o,i,a,s,c,l,u,d){super(e,t,r,n,o,i,s,c,d),this.apiId=a,this.accountId=l,this.nativeMessageHandler=c,this.nativeStorageManager=u,this.silentCacheClient=new _y(e,this.nativeStorageManager,r,n,o,i,s,c,d);const h=this.nativeMessageHandler.getExtensionId()===Oh?"chrome":this.nativeMessageHandler.getExtensionId()?.length?"unknown":void 0;this.skus=hy.makeExtraSkuString({libraryName:Ph,libraryVersion:eg,extensionName:h,extensionVersion:this.nativeMessageHandler.getExtensionVersion()})}addRequestSKUs(e){e.extraParameters={...e.extraParameters,[km]:this.skus}}async acquireToken(e,t){this.performanceClient.addQueueMeasurement(sd,e.correlationId),this.logger.trace("NativeInteractionClient - acquireToken called.");const r=this.performanceClient.startMeasurement(sd,e.correlationId),n=Al(),o=this.initializeServerTelemetryManager(this.apiId);try{const i=await this.initializeNativeRequest(e);try{const e=await this.acquireTokensFromCache(this.accountId,i);return r.end({success:!0,isNativeBroker:!1,fromCache:!0}),e}catch(e){if(1===t)throw this.logger.info("MSAL internal Cache does not contain tokens, return error as per cache policy"),e;this.logger.info("MSAL internal Cache does not contain tokens, proceed to make a native call")}const{...a}=i,s={method:Nh,request:a},c=await this.nativeMessageHandler.sendMessage(s),l=this.validateNativeResponse(c);return await this.handleNativeResponse(l,i,n).then((e=>(r.end({success:!0,isNativeBroker:!0,requestId:e.requestId}),o.clearNativeBrokerErrorCode(),e))).catch((e=>{throw r.end({success:!1,errorCode:e.errorCode,subErrorCode:e.subError,isNativeBroker:!0}),e}))}catch(e){throw e instanceof by&&o.setNativeBrokerErrorCode(e.errorCode),e}}createSilentCacheRequest(e,t){return{authority:e.authority,correlationId:this.correlationId,scopes:pu.fromString(e.scope).asArray(),account:t,forceRefresh:!1}}async acquireTokensFromCache(e,t){if(!e)throw this.logger.warning("NativeInteractionClient:acquireTokensFromCache - No nativeAccountId provided"),ml(Jc);const r=this.browserStorage.getBaseAccountInfo({nativeAccountId:e});if(!r)throw ml(Jc);try{const e=this.createSilentCacheRequest(t,r),n=await this.silentCacheClient.acquireToken(e),o={...r,idTokenClaims:n?.idTokenClaims,idToken:n?.idToken};return{...n,account:o}}catch(e){throw e}}async acquireTokenRedirect(e,t){this.logger.trace("NativeInteractionClient - acquireTokenRedirect called.");const{...r}=e;delete r.onRedirectNavigate;const n=await this.initializeNativeRequest(r),o={method:Nh,request:n};try{const e=await this.nativeMessageHandler.sendMessage(o);this.validateNativeResponse(e)}catch(e){if(e instanceof by&&(this.initializeServerTelemetryManager(this.apiId).setNativeBrokerErrorCode(e.errorCode),wy(e)))throw e}this.browserStorage.setTemporaryCache(Kh,JSON.stringify(n),!0);const i={apiId:Qh,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},a=this.config.auth.navigateToLoginRequestUrl?window.location.href:this.getRedirectUri(e.redirectUri);t.end({success:!0}),await this.navigationClient.navigateExternal(a,i)}async handleRedirectPromise(e,t){if(this.logger.trace("NativeInteractionClient - handleRedirectPromise called."),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;const r=this.browserStorage.getCachedNativeRequest();if(!r)return this.logger.verbose("NativeInteractionClient - handleRedirectPromise called but there is no cached request, returning null."),e&&t&&e?.addFields({errorCode:"no_cached_request"},t),null;const{prompt:n,...o}=r;n&&this.logger.verbose("NativeInteractionClient - handleRedirectPromise called and prompt was included in the original request, removing prompt from cached request to prevent second interaction with native broker window."),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(Kh));const i={method:Nh,request:o},a=Al();try{this.logger.verbose("NativeInteractionClient - handleRedirectPromise sending message to native broker.");const e=await this.nativeMessageHandler.sendMessage(i);this.validateNativeResponse(e);const t=this.handleNativeResponse(e,o,a),r=await t;return this.initializeServerTelemetryManager(this.apiId).clearNativeBrokerErrorCode(),r}catch(e){throw e}}logout(){return this.logger.trace("NativeInteractionClient - logout called."),Py.reject("Logout not implemented yet")}async handleNativeResponse(e,t,r){this.logger.trace("NativeInteractionClient - handleNativeResponse called.");const n=wl(e.id_token,gf),o=this.createHomeAccountIdentifier(e,n),i=this.browserStorage.getAccountInfoFilteredBy({nativeAccountId:t.accountId})?.homeAccountId;if(t.extraParameters?.child_client_id&&e.account.id!==t.accountId)this.logger.info("handleNativeServerResponse: Double broker flow detected, ignoring accountId mismatch");else if(o!==i&&e.account.id!==t.accountId)throw Cy(yy);const a=await this.getDiscoveredAuthority({requestAuthority:t.authority}),s=cy(this.browserStorage,a,o,gf,n,e.client_info,void 0,n.tid,void 0,e.account.id,this.logger);e.expires_in=Number(e.expires_in);const c=await this.generateAuthenticationResult(e,t,n,s,a.canonicalAuthority,r);return await this.cacheAccount(s),await this.cacheNativeTokens(e,t,o,n,e.access_token,c.tenantId,r),c}createHomeAccountIdentifier(e,t){return wu.generateHomeAccountId(e.client_info||$s.EMPTY_STRING,0,this.logger,this.browserCrypto,t)}generateScopes(e,t){return e.scope?pu.fromString(e.scope):pu.fromString(t.scope)}async generatePopAccessToken(e,t){if(t.tokenType===hc.POP&&t.signPopToken){if(e.shr)return this.logger.trace("handleNativeServerResponse: SHR is enabled in native layer"),e.shr;const r=new iy(this.browserCrypto),n={resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,shrNonce:t.shrNonce};if(!t.keyId)throw ml(cl);return r.signPopToken(e.access_token,t.keyId,n)}return e.access_token}async generateAuthenticationResult(e,t,r,n,o,i){const a=this.addTelemetryFromNativeResponse(e),s=e.scope?pu.fromString(e.scope):pu.fromString(t.scope),c=e.account.properties||{},l=c.UID||r.oid||r.sub||$s.EMPTY_STRING,u=c.TenantId||r.tid||$s.EMPTY_STRING,d=vu(n.getAccountInfo(),void 0,r,e.id_token);d.nativeAccountId!==e.account.id&&(d.nativeAccountId=e.account.id);const h=await this.generatePopAccessToken(e,t),p=t.tokenType===hc.POP?hc.POP:hc.BEARER;return{authority:o,uniqueId:l,tenantId:u,scopes:s.asArray(),account:d,idToken:e.id_token,idTokenClaims:r,accessToken:h,fromCache:!!a&&this.isResponseFromCache(a),expiresOn:Sl(i+e.expires_in),tokenType:p,correlationId:this.correlationId,state:e.state,fromNativeBroker:!0}}async cacheAccount(e){await this.browserStorage.setAccount(e,this.correlationId),this.browserStorage.removeAccountContext(e).catch((e=>{this.logger.error(`Error occurred while removing account context from browser storage. ${e}`)}))}cacheNativeTokens(e,t,r,n,o,i,a){const s=xl(r,t.authority,e.id_token||"",t.clientId,n.tid||""),c=a+(t.tokenType===hc.POP?$s.SHR_NONCE_VALIDITY:("string"==typeof e.expires_in?parseInt(e.expires_in,10):e.expires_in)||0),l=this.generateScopes(e,t),u={idToken:s,accessToken:_l(r,t.authority,o,t.clientId,n.tid||i,l.printScopes(),c,0,gf,void 0,t.tokenType,void 0,t.keyId)};return this.nativeStorageManager.saveCacheRecord(u,this.correlationId,t.storeInCache)}addTelemetryFromNativeResponse(e){const t=this.getMATSFromResponse(e);return t?(this.performanceClient.addFields({extensionId:this.nativeMessageHandler.getExtensionId(),extensionVersion:this.nativeMessageHandler.getExtensionVersion(),matsBrokerVersion:t.broker_version,matsAccountJoinOnStart:t.account_join_on_start,matsAccountJoinOnEnd:t.account_join_on_end,matsDeviceJoin:t.device_join,matsPromptBehavior:t.prompt_behavior,matsApiErrorCode:t.api_error_code,matsUiVisible:t.ui_visible,matsSilentCode:t.silent_code,matsSilentBiSubCode:t.silent_bi_sub_code,matsSilentMessage:t.silent_message,matsSilentStatus:t.silent_status,matsHttpStatus:t.http_status,matsHttpEventCount:t.http_event_count},this.correlationId),t):null}validateNativeResponse(e){if(e.hasOwnProperty("access_token")&&e.hasOwnProperty("id_token")&&e.hasOwnProperty("client_info")&&e.hasOwnProperty("account")&&e.hasOwnProperty("scope")&&e.hasOwnProperty("expires_in"))return e;throw kc(bc,"Response missing expected properties.")}getMATSFromResponse(e){if(e.properties.MATS)try{return JSON.parse(e.properties.MATS)}catch(e){this.logger.error("NativeInteractionClient - Error parsing MATS telemetry, returning null instead")}return null}isResponseFromCache(e){return void 0===e.is_cached?(this.logger.verbose("NativeInteractionClient - MATS telemetry does not contain field indicating if response was served from cache. Returning false."),!1):!!e.is_cached}async initializeNativeRequest(e){this.logger.trace("NativeInteractionClient - initializeNativeRequest called");const t=e.authority||this.config.auth.authority;e.account&&await this.getDiscoveredAuthority({requestAuthority:t,requestAzureCloudOptions:e.azureCloudOptions,account:e.account});const r=new Su(t);r.validateAsUri();const{scopes:n,...o}=e,i=new pu(n||[]);i.appendScopes(Ds);const a={...o,accountId:this.accountId,clientId:this.config.auth.clientId,authority:r.urlString,scope:i.printScopes(),redirectUri:this.getRedirectUri(e.redirectUri),prompt:(()=>{switch(this.apiId){case 863:case 61:return this.logger.trace("initializeNativeRequest: silent request sets prompt to none"),Xs.NONE}if(e.prompt)switch(e.prompt){case Xs.NONE:case Xs.CONSENT:case Xs.LOGIN:return this.logger.trace("initializeNativeRequest: prompt is compatible with native flow"),e.prompt;default:throw this.logger.trace(`initializeNativeRequest: prompt = ${e.prompt} is not compatible with native flow`),sf(Jp)}else this.logger.trace("initializeNativeRequest: prompt was not provided")})(),correlationId:this.correlationId,tokenType:e.authenticationScheme,windowTitleSubstring:document.title,extraParameters:{...e.extraQueryParameters,...e.tokenQueryParameters},extendedExpiryToken:!1,keyId:e.popKid};if(a.signPopToken&&e.popKid)throw sf(Zp);if(this.handleExtraBrokerParams(a),a.extraParameters=a.extraParameters||{},a.extraParameters.telemetry="MATS",e.authenticationScheme===hc.POP){const t={resourceRequestUri:e.resourceRequestUri,resourceRequestMethod:e.resourceRequestMethod,shrClaims:e.shrClaims,shrNonce:e.shrNonce},r=new iy(this.browserCrypto);let n;if(a.keyId)n=this.browserCrypto.base64UrlEncode(JSON.stringify({kid:a.keyId})),a.signPopToken=!1;else{const o=await mg(r.generateCnf.bind(r),Ud,this.logger,this.performanceClient,e.correlationId)(t,this.logger);n=o.reqCnfString,a.keyId=o.kid,a.signPopToken=!0}a.reqCnf=n}return this.addRequestSKUs(a),a}handleExtraBrokerParams(e){const t=e.extraParameters&&e.extraParameters.hasOwnProperty(Sm)&&e.extraParameters.hasOwnProperty(Tm)&&e.extraParameters.hasOwnProperty(vm);if(!e.embeddedClientId&&!t)return;let r="";const n=e.redirectUri;e.embeddedClientId?(e.redirectUri=this.config.auth.redirectUri,r=e.embeddedClientId):e.extraParameters&&(e.redirectUri=e.extraParameters[Tm],r=e.extraParameters[vm]),e.extraParameters={child_client_id:r,child_redirect_uri:n},this.performanceClient?.addFields({embeddedClientId:r,embeddedRedirectUri:n},e.correlationId)}}async function Oy(e,t,r,n,o){const i=function(e,t,r,n){const o=t.correlationId,i=new Map;if(Pm(i,t.embeddedClientId||t.extraQueryParameters?.[vm]||e.clientId),_m(i,[...t.scopes||[],...t.extraScopesToConsent||[]],!0,e.authority.options.OIDCOptions?.defaultScopes),Rm(i,t.redirectUri),qm(i,o),function(e,t){e.set("response_mode",t||"query")}(i,t.responseMode),Km(i),t.prompt&&(function(e,t){e.set("prompt",t)}(i,t.prompt),n?.addFields({prompt:t.prompt},o)),t.domainHint&&(function(e,t){e.set("domain_hint",t)}(i,t.domainHint),n?.addFields({domainHintFromRequest:!0},o)),t.prompt!==Xs.SELECT_ACCOUNT)if(t.sid&&t.prompt===Xs.NONE)r.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from request"),Bm(i,t.sid),n?.addFields({sidFromRequest:!0},o);else if(t.account){const e=(a=t.account,a.idTokenClaims?.sid||null);let s=function(e){return e.idTokenClaims?.login_hint||null}(t.account);if(s&&t.domainHint&&(r.warning('AuthorizationCodeClient.createAuthCodeUrlQueryString: "domainHint" param is set, skipping opaque "login_hint" claim. Please consider not passing domainHint'),s=null),s){r.verbose("createAuthCodeUrlQueryString: login_hint claim present on account"),Om(i,s),n?.addFields({loginHintFromClaim:!0},o);try{Nm(i,gu(t.account.homeAccountId))}catch(e){r.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(e&&t.prompt===Xs.NONE){r.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from account"),Bm(i,e),n?.addFields({sidFromClaim:!0},o);try{Nm(i,gu(t.account.homeAccountId))}catch(e){r.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(t.loginHint)r.verbose("createAuthCodeUrlQueryString: Adding login_hint from request"),Om(i,t.loginHint),Mm(i,t.loginHint),n?.addFields({loginHintFromRequest:!0},o);else if(t.account.username){r.verbose("createAuthCodeUrlQueryString: Adding login_hint from account"),Om(i,t.account.username),n?.addFields({loginHintFromUpn:!0},o);try{Nm(i,gu(t.account.homeAccountId))}catch(e){r.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}}else t.loginHint&&(r.verbose("createAuthCodeUrlQueryString: No account, adding login_hint from request"),Om(i,t.loginHint),Mm(i,t.loginHint),n?.addFields({loginHintFromRequest:!0},o));else r.verbose("createAuthCodeUrlQueryString: Prompt is select_account, ignoring account hints");var a;return t.nonce&&function(e,t){e.set("nonce",t)}(i,t.nonce),t.state&&Dm(i,t.state),(t.claims||e.clientCapabilities&&e.clientCapabilities.length>0)&&Lm(i,t.claims,e.clientCapabilities),t.embeddedClientId&&Zm(i,e.clientId,e.redirectUri),!e.instanceAware||t.extraQueryParameters&&Object.keys(t.extraQueryParameters).includes(Im)||Wm(i),i}({...e.auth,authority:t},r,n,o);if(Hm(i,{sku:Ph,version:eg,os:"",cpu:""}),e.auth.protocolMode!==mc&&$m(i,e.telemetry.application),r.platformBroker&&(function(e){e.set("nativebroker","1")}(i),r.authenticationScheme===hc.POP)){const e=new pg(n,o),t=new iy(e);let a;a=r.popKid?e.encodeKid(r.popKid):(await mg(t.generateCnf.bind(t),Ud,n,o,r.correlationId)(r,n)).reqCnfString,Ym(i,a)}return Em(i,r.correlationId,o),i}async function My(e,t,r,n,o){if(!r.codeChallenge)throw du(Xl);const i=await mg(Oy,"getStandardParams",n,o,r.correlationId)(e,t,r,n,o);return xm(i,"code"),function(e,t,r){if(!t||!r)throw du(Xl);e.set("code_challenge",t),e.set("code_challenge_method",r)}(i,r.codeChallenge,$s.S256_CODE_CHALLENGE_METHOD),Gm(i,r.extraQueryParameters||{}),Ty(t,i,e.auth.encodeExtraQueryParams,r.extraQueryParameters)}async function Ny(e,t,r,n,o,i){if(!n.earJwk)throw sf(cp);const a=await Oy(t,r,n,o,i);xm(a,"id_token token refresh_token"),function(e,t){e.set("ear_jwk",encodeURIComponent(t)),e.set("ear_jwe_crypto","eyJhbGciOiJkaXIiLCJlbmMiOiJBMjU2R0NNIn0")}(a,n.earJwk);const s=new Map;return Gm(s,n.extraQueryParameters||{}),function(e,t,r){const n=e.createElement("form");return n.method="post",n.action=t,r.forEach(((t,r)=>{const o=e.createElement("input");o.hidden=!0,o.name=r,o.value=t,n.appendChild(o)})),e.body.appendChild(n),n}(e,Ty(r,s,t.auth.encodeExtraQueryParams,n.extraQueryParameters),a)}async function By(e,t,r,n,o,i,a,s,c,l){if(!l)throw sf(Yp);const u=new pg(s,c),d=new Ry(n,o,u,s,a,n.system.navigationClient,r,c,l,t,i,e.correlationId),{userRequestState:h}=oy.parseRequestState(u,e.state);return mg(d.acquireToken.bind(d),sd,s,c,e.correlationId)({...e,state:h,prompt:void 0})}async function Ly(e,t,r,n,o,i,a,s,c,l,u,d){if(ry.removeThrottle(a,o.auth.clientId,e),t.accountId)return mg(By,Ld,l,u,e.correlationId)(e,t.accountId,n,o,a,s,c,l,u,d);const h={...e,code:t.code||"",codeVerifier:r},p=new Ey(i,a,h,l,u);return await mg(p.handleCodeResponse.bind(p),Nd,l,u,e.correlationId)(t,e)}async function qy(e,t,r,n,o,i,a,s,c,l,u){if(ry.removeThrottle(i,n.auth.clientId,e),Iy(t,e.state),!t.ear_jwe)throw sf(lp);if(!e.earJwk)throw sf(cp);const d=JSON.parse(await mg(Mf,Sh,c,l,e.correlationId)(e.earJwk,t.ear_jwe));if(d.accountId)return mg(By,Ld,c,l,e.correlationId)(e,d.accountId,r,n,i,a,s,c,l,u);const h=new sy(n.auth.clientId,i,new pg(c,l),c,null,null,l);h.validateTokenResponse(d);const p={code:"",state:e.state,nonce:e.nonce,client_info:d.client_info,cloud_graph_host_name:d.cloud_graph_host_name,cloud_instance_host_name:d.cloud_instance_host_name,cloud_instance_name:d.cloud_instance_name,msgraph_host:d.msgraph_host};return await mg(h.handleServerTokenResponse.bind(h),zd,c,l,e.correlationId)(d,o,Al(),e,p,void 0,void 0,void 0,void 0)}async function Hy(e,t,r){e.addQueueMeasurement(hh,r);const n=gg($y,ph,t,e,r)(e,t,r);return{verifier:n,challenge:await mg(Dy,fh,t,e,r)(n,e,t,r)}}function $y(e,t,r){try{const n=new Uint8Array(32);return gg(xf,mh,t,e,r)(n),hf(n)}catch(e){throw sf(sp)}}async function Dy(e,t,r,n){t.addQueueMeasurement(fh,n);try{const o=await mg(Ef,gh,r,t,n)(e,t,n);return hf(new Uint8Array(o))}catch(e){throw sf(sp)}}var Fy=r(64583).Promise;class Uy extends my{constructor(e,t,r,n,o,i,a,s,c,l){super(e,t,r,n,o,i,a,c,l),this.unloadWindow=this.unloadWindow.bind(this),this.nativeStorage=s,this.eventHandler=o}acquireToken(e,t){try{const r={popupName:this.generatePopupName(e.scopes||Ds,e.authority||this.config.auth.authority),popupWindowAttributes:e.popupWindowAttributes||{},popupWindowParent:e.popupWindowParent??window};return this.performanceClient.addFields({isAsyncPopup:this.config.system.asyncPopups},this.correlationId),this.config.system.asyncPopups?(this.logger.verbose("asyncPopups set to true, acquiring token"),this.acquireTokenPopupAsync(e,r,t)):(this.logger.verbose("asyncPopup set to false, opening popup before acquiring token"),r.popup=this.openSizedPopup("about:blank",r),this.acquireTokenPopupAsync(e,r,t))}catch(e){return Fy.reject(e)}}logout(e){try{this.logger.verbose("logoutPopup called");const t=this.initializeLogoutRequest(e),r={popupName:this.generateLogoutPopupName(t),popupWindowAttributes:e?.popupWindowAttributes||{},popupWindowParent:e?.popupWindowParent??window},n=e&&e.authority,o=e&&e.mainWindowRedirectUri;return this.config.system.asyncPopups?(this.logger.verbose("asyncPopups set to true"),this.logoutPopupAsync(t,r,n,o)):(this.logger.verbose("asyncPopup set to false, opening popup"),r.popup=this.openSizedPopup("about:blank",r),this.logoutPopupAsync(t,r,n,o))}catch(e){return Fy.reject(e)}}async acquireTokenPopupAsync(e,t,r){this.logger.verbose("acquireTokenPopupAsync called");const n=await mg(this.initializeAuthorizationRequest.bind(this),Rd,this.logger,this.performanceClient,this.correlationId)(e,Xh.Popup);t.popup&&Zf(n.authority);const o=ky.isPlatformBrokerAvailable(this.config,this.logger,this.nativeMessageHandler,e.authenticationScheme);return n.platformBroker=o,this.config.auth.protocolMode===yc?this.executeEarFlow(n,t):this.executeCodeFlow(n,t,r)}async executeCodeFlow(e,t,r){const n=e.correlationId,o=this.initializeServerTelemetryManager(Jh),i=r||await mg(Hy,hh,this.logger,this.performanceClient,n)(this.performanceClient,this.logger,n),a={...e,codeChallenge:i.challenge};try{const r=await mg(this.createAuthCodeClient.bind(this),_d,this.logger,this.performanceClient,n)({serverTelemetryManager:o,requestAuthority:a.authority,requestAzureCloudOptions:a.azureCloudOptions,requestExtraQueryParameters:a.extraQueryParameters,account:a.account}),s=await mg(My,Od,this.logger,this.performanceClient,n)(this.config,r.authority,a,this.logger,this.performanceClient),c=this.initiateAuthRequest(s,t);this.eventHandler.emitEvent(Zg,Xh.Popup,{popupWindow:c},null);const l=await this.monitorPopupForHash(c,t.popupWindowParent),u=gg(Sy,Kd,this.logger,this.performanceClient,this.correlationId)(l,this.config.auth.OIDCOptions.serverResponseType,this.logger);return await mg(Ly,qd,this.logger,this.performanceClient,n)(e,u,i.verifier,Jh,this.config,r,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.nativeMessageHandler)}catch(e){throw t.popup?.close(),e instanceof Ac&&(e.setCorrelationId(this.correlationId),o.cacheFailedRequest(e)),e}}async executeEarFlow(e,t){const r=e.correlationId,n=await mg(this.getDiscoveredAuthority.bind(this),ad,this.logger,this.performanceClient,r)({requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account}),o=await mg(Of,kh,this.logger,this.performanceClient,r)(),i={...e,earJwk:o},a=t.popup||this.openPopup("about:blank",t);(await Ny(a.document,this.config,n,i,this.logger,this.performanceClient)).submit();const s=await mg(this.monitorPopupForHash.bind(this),Id,this.logger,this.performanceClient,r)(a,t.popupWindowParent),c=gg(Sy,Kd,this.logger,this.performanceClient,this.correlationId)(s,this.config.auth.OIDCOptions.serverResponseType,this.logger);return mg(qy,Bd,this.logger,this.performanceClient,r)(i,c,Jh,this.config,n,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.nativeMessageHandler)}async logoutPopupAsync(e,t,r,n){this.logger.verbose("logoutPopupAsync called"),this.eventHandler.emitEvent(em,Xh.Popup,e);const o=this.initializeServerTelemetryManager(962);try{await this.clearCacheOnLogout(e.account);const i=await mg(this.createAuthCodeClient.bind(this),_d,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:o,requestAuthority:r,account:e.account||void 0});try{i.authority.endSessionEndpoint}catch{if(e.account?.homeAccountId&&e.postLogoutRedirectUri&&i.authority.protocolMode===mc){if(this.browserStorage.removeAccount(e.account?.homeAccountId),this.eventHandler.emitEvent(tm,Xh.Popup,e),n){const e={apiId:962,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},t=Su.getAbsoluteUrl(n,Vf());await this.navigationClient.navigateInternal(t,e)}return void t.popup?.close()}}const a=i.getLogoutUri(e);this.eventHandler.emitEvent(tm,Xh.Popup,e);const s=this.openPopup(a,t);if(this.eventHandler.emitEvent(Zg,Xh.Popup,{popupWindow:s},null),await this.monitorPopupForHash(s,t.popupWindowParent).catch((()=>{})),n){const e={apiId:962,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},t=Su.getAbsoluteUrl(n,Vf());this.logger.verbose("Redirecting main window to url specified in the request"),this.logger.verbosePii(`Redirecting main window to: ${t}`),await this.navigationClient.navigateInternal(t,e)}else this.logger.verbose("No main window navigation requested")}catch(e){throw t.popup?.close(),e instanceof Ac&&(e.setCorrelationId(this.correlationId),o.cacheFailedRequest(e)),this.eventHandler.emitEvent(rm,Xh.Popup,null,e),this.eventHandler.emitEvent(nm,Xh.Popup),e}this.eventHandler.emitEvent(nm,Xh.Popup)}initiateAuthRequest(e,t){if(e)return this.logger.infoPii(`Navigate to: ${e}`),this.openPopup(e,t);throw this.logger.error("Navigate url is empty"),sf(dp)}monitorPopupForHash(e,t){return new Fy(((t,r)=>{this.logger.verbose("PopupHandler.monitorPopupForHash - polling started");const n=setInterval((()=>{if(e.closed)return this.logger.error("PopupHandler.monitorPopupForHash - window closed"),clearInterval(n),void r(sf(wp));let o="";try{o=e.location.href}catch(e){}if(!o||"about:blank"===o)return;clearInterval(n);let i="";const a=this.config.auth.OIDCOptions.serverResponseType;e&&(i=a===ec?e.location.search:e.location.hash),this.logger.verbose("PopupHandler.monitorPopupForHash - popup window is on same origin as caller"),t(i)}),this.config.system.pollIntervalMilliseconds)})).finally((()=>{this.cleanPopup(e,t)}))}openPopup(e,t){try{let r;if(t.popup?(r=t.popup,this.logger.verbosePii(`Navigating popup window to: ${e}`),r.location.assign(e)):void 0===t.popup&&(this.logger.verbosePii(`Opening popup window to: ${e}`),r=this.openSizedPopup(e,t)),!r)throw sf(bp);return r.focus&&r.focus(),this.currentWindow=r,t.popupWindowParent.addEventListener("beforeunload",this.unloadWindow),r}catch(e){throw this.logger.error("error opening popup "+e.message),sf(vp)}}openSizedPopup(e,{popupName:t,popupWindowAttributes:r,popupWindowParent:n}){const o=n.screenLeft?n.screenLeft:n.screenX,i=n.screenTop?n.screenTop:n.screenY,a=n.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,s=n.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;let c=r.popupSize?.width,l=r.popupSize?.height,u=r.popupPosition?.top,d=r.popupPosition?.left;return(!c||c<0||c>a)&&(this.logger.verbose("Default popup window width used. Window width not configured or invalid."),c=483),(!l||l<0||l>s)&&(this.logger.verbose("Default popup window height used. Window height not configured or invalid."),l=600),(!u||u<0||u>s)&&(this.logger.verbose("Default popup window top position used. Window top not configured or invalid."),u=Math.max(0,s/2-300+i)),(!d||d<0||d>a)&&(this.logger.verbose("Default popup window left position used. Window left not configured or invalid."),d=Math.max(0,a/2-241.5+o)),n.open(e,t,`width=${c}, height=${l}, top=${u}, left=${d}, scrollbars=yes`)}unloadWindow(e){this.currentWindow&&this.currentWindow.close(),e.preventDefault()}cleanPopup(e,t){e.close(),t.removeEventListener("beforeunload",this.unloadWindow)}generatePopupName(e,t){return`${_h}.${this.config.auth.clientId}.${e.join("-")}.${t}.${this.correlationId}`}generateLogoutPopupName(e){const t=e.account&&e.account.homeAccountId;return`${_h}.${this.config.auth.clientId}.${t}.${this.correlationId}`}}class jy extends my{constructor(e,t,r,n,o,i,a,s,c,l){super(e,t,r,n,o,i,a,c,l),this.nativeStorage=s}async acquireToken(e){const t=await mg(this.initializeAuthorizationRequest.bind(this),Rd,this.logger,this.performanceClient,this.correlationId)(e,Xh.Redirect);t.platformBroker=ky.isPlatformBrokerAvailable(this.config,this.logger,this.nativeMessageHandler,e.authenticationScheme);const r=e=>{e.persisted&&(this.logger.verbose("Page was restored from back/forward cache. Clearing temporary cache."),this.browserStorage.resetRequestCache(),this.eventHandler.emitEvent("msal:restoreFromBFCache",Xh.Redirect))},n=this.getRedirectStartPage(e.redirectStartPage);this.logger.verbosePii(`Redirect start page: ${n}`),this.browserStorage.setTemporaryCache(Dh,n,!0),window.addEventListener("pageshow",r);try{this.config.auth.protocolMode===yc?await this.executeEarFlow(t):await this.executeCodeFlow(t,e.onRedirectNavigate)}catch(e){throw e instanceof Ac&&e.setCorrelationId(this.correlationId),window.removeEventListener("pageshow",r),e}}async executeCodeFlow(e,t){const r=e.correlationId,n=this.initializeServerTelemetryManager(Qh),o=await mg(Hy,hh,this.logger,this.performanceClient,r)(this.performanceClient,this.logger,r),i={...e,codeChallenge:o.challenge};this.browserStorage.cacheAuthorizeRequest(i,o.verifier);try{const r=await mg(this.createAuthCodeClient.bind(this),_d,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:n,requestAuthority:i.authority,requestAzureCloudOptions:i.azureCloudOptions,requestExtraQueryParameters:i.extraQueryParameters,account:i.account}),o=await mg(My,Od,this.logger,this.performanceClient,e.correlationId)(this.config,r.authority,i,this.logger,this.performanceClient);return await this.initiateAuthRequest(o,t)}catch(e){throw e instanceof Ac&&(e.setCorrelationId(this.correlationId),n.cacheFailedRequest(e)),e}}async executeEarFlow(e){const t=e.correlationId,r=await mg(this.getDiscoveredAuthority.bind(this),ad,this.logger,this.performanceClient,t)({requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account}),n=await mg(Of,kh,this.logger,this.performanceClient,t)(),o={...e,earJwk:n};this.browserStorage.cacheAuthorizeRequest(o),(await Ny(document,this.config,r,o,this.logger,this.performanceClient)).submit()}async handleRedirectPromise(e="",t,r,n){const o=this.initializeServerTelemetryManager(865);try{const[i,a]=this.getRedirectResponse(e||"");if(!i)return this.logger.info("handleRedirectPromise did not detect a response as a result of a redirect. Cleaning temporary cache."),this.browserStorage.resetRequestCache(),"back_forward"!==function(){if("undefined"==typeof window||void 0===window.performance||"function"!=typeof window.performance.getEntriesByType)return;const e=window.performance.getEntriesByType("navigation"),t=e.length?e[0]:void 0;return t?.type}()?n.event.errorCode="no_server_response":this.logger.verbose("Back navigation event detected. Muting no_server_response error"),null;const s=this.browserStorage.getTemporaryCache(Dh,!0)||$s.EMPTY_STRING;if(Su.removeHashFromUrl(s)===Su.removeHashFromUrl(window.location.href)&&this.config.auth.navigateToLoginRequestUrl)return this.logger.verbose("Current page is loginRequestUrl, handling response"),s.indexOf("#")>-1&&function(e){const t=e.split("#");t.shift(),window.location.hash=t.length>0?t.join("#"):""}(s),await this.handleResponse(i,t,r,o);if(!this.config.auth.navigateToLoginRequestUrl)return this.logger.verbose("NavigateToLoginRequestUrl set to false, handling response"),await this.handleResponse(i,t,r,o);if(!Gf()||this.config.system.allowRedirectInIframe){this.browserStorage.setTemporaryCache(Fh,a,!0);const e={apiId:865,timeout:this.config.system.redirectNavigationTimeout,noHistory:!0};let n=!0;if(s&&"null"!==s)this.logger.verbose(`Navigating to loginRequestUrl: ${s}`),n=await this.navigationClient.navigateInternal(s,e);else{const t=function(){const e=new Su(window.location.href).getUrlComponents();return`${e.Protocol}//${e.HostNameAndPort}/`}();this.browserStorage.setTemporaryCache(Dh,t,!0),this.logger.warning("Unable to get valid login request url from cache, redirecting to home page"),n=await this.navigationClient.navigateInternal(t,e)}if(!n)return await this.handleResponse(i,t,r,o)}return null}catch(e){throw e instanceof Ac&&(e.setCorrelationId(this.correlationId),o.cacheFailedRequest(e)),e}}getRedirectResponse(e){this.logger.verbose("getRedirectResponseHash called");let t=e;t||(t=this.config.auth.OIDCOptions.serverResponseType===ec?window.location.search:window.location.hash);let r=Au(t);if(r){try{!function(e,t,r){if(!e.state)throw sf(pp);const n=function(e,t){if(!t)return null;try{return oy.parseRequestState(e,t).libraryState.meta}catch(e){throw ml(Oc)}}(t,e.state);if(!n)throw sf(gp);if(n.interactionType!==r)throw sf(mp)}(r,this.browserCrypto,Xh.Redirect)}catch(e){return e instanceof Ac&&this.logger.error(`Interaction type validation failed due to ${e.errorCode}: ${e.errorMessage}`),[null,""]}return Wf(window),this.logger.verbose("Hash contains known properties, returning response hash"),[r,t]}const n=this.browserStorage.getTemporaryCache(Fh,!0);return this.browserStorage.removeItem(this.browserStorage.generateCacheKey(Fh)),n&&(r=Au(n),r)?(this.logger.verbose("Hash does not contain known properties, returning cached hash"),[r,n]):[null,""]}async handleResponse(e,t,r,n){if(!e.state)throw sf(pp);if(e.ear_jwe){const r=await mg(this.getDiscoveredAuthority.bind(this),ad,this.logger,this.performanceClient,t.correlationId)({requestAuthority:t.authority,requestAzureCloudOptions:t.azureCloudOptions,requestExtraQueryParameters:t.extraQueryParameters,account:t.account});return mg(qy,Bd,this.logger,this.performanceClient,t.correlationId)(t,e,Qh,this.config,r,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.nativeMessageHandler)}const o=await mg(this.createAuthCodeClient.bind(this),_d,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:n,requestAuthority:t.authority});return mg(Ly,qd,this.logger,this.performanceClient,t.correlationId)(t,e,r,Qh,this.config,o,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.nativeMessageHandler)}async initiateAuthRequest(e,t){if(this.logger.verbose("RedirectHandler.initiateAuthRequest called"),e){this.logger.infoPii(`RedirectHandler.initiateAuthRequest: Navigate to: ${e}`);const r={apiId:Qh,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},n=t||this.config.auth.onRedirectNavigate;return"function"==typeof n?(this.logger.verbose("RedirectHandler.initiateAuthRequest: Invoking onRedirectNavigate callback"),!1!==n(e)?(this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate did not return false, navigating"),void await this.navigationClient.navigateExternal(e,r)):void this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate returned false, stopping navigation")):(this.logger.verbose("RedirectHandler.initiateAuthRequest: Navigating window to navigate url"),void await this.navigationClient.navigateExternal(e,r))}throw this.logger.info("RedirectHandler.initiateAuthRequest: Navigate url is empty"),sf(dp)}async logout(e){this.logger.verbose("logoutRedirect called");const t=this.initializeLogoutRequest(e),r=this.initializeServerTelemetryManager(961);try{this.eventHandler.emitEvent(em,Xh.Redirect,e),await this.clearCacheOnLogout(t.account);const n={apiId:961,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},o=await mg(this.createAuthCodeClient.bind(this),_d,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:r,requestAuthority:e&&e.authority,requestExtraQueryParameters:e?.extraQueryParameters,account:e&&e.account||void 0});if(o.authority.protocolMode===mc)try{o.authority.endSessionEndpoint}catch{if(t.account?.homeAccountId)return this.browserStorage.removeAccount(t.account?.homeAccountId),void this.eventHandler.emitEvent(tm,Xh.Redirect,t)}const i=o.getLogoutUri(t);if(this.eventHandler.emitEvent(tm,Xh.Redirect,t),!e||"function"!=typeof e.onRedirectNavigate)return this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0,$h),void await this.navigationClient.navigateExternal(i,n);if(!1!==e.onRedirectNavigate(i))return this.logger.verbose("Logout onRedirectNavigate did not return false, navigating"),this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0,$h),void await this.navigationClient.navigateExternal(i,n);this.browserStorage.setInteractionInProgress(!1),this.logger.verbose("Logout onRedirectNavigate returned false, stopping navigation")}catch(e){throw e instanceof Ac&&(e.setCorrelationId(this.correlationId),r.cacheFailedRequest(e)),this.eventHandler.emitEvent(rm,Xh.Redirect,null,e),this.eventHandler.emitEvent(nm,Xh.Redirect),e}this.eventHandler.emitEvent(nm,Xh.Redirect)}getRedirectStartPage(e){const t=e||window.location.href;return Su.getAbsoluteUrl(t,Vf())}}var zy=r(64583).Promise;async function Ky(e,t,r,n,o){if(t.addQueueMeasurement(Td,n),!e)throw r.info("Navigate url is empty"),sf(dp);return o?mg(Vy,Ed,r,t,n)(e,o,t,n):gg(Yy,xd,r,t,n)(e)}async function Wy(e,t,r,n,o){const i=Qy();if(!i.contentDocument)throw"No document associated with iframe!";return(await Ny(i.contentDocument,e,t,r,n,o)).submit(),i}async function Gy(e,t,r,n,o,i,a){return n.addQueueMeasurement(Id,i),new zy(((n,i)=>{t<1e4&&o.warning(`system.loadFrameTimeout or system.iframeHashTimeout set to lower (${t}ms) than the default (10000ms). This may result in timeouts.`);const s=window.setTimeout((()=>{window.clearInterval(c),i(sf(Ap))}),t),c=window.setInterval((()=>{let t="";const r=e.contentWindow;try{t=r?r.location.href:""}catch(e){}if(!t||"about:blank"===t)return;let o="";r&&(o=a===ec?r.location.search:r.location.hash),window.clearTimeout(s),window.clearInterval(c),n(o)}),r)})).finally((()=>{gg(Jy,ah,o,n,i)(e)}))}function Vy(e,t,r,n){return r.addQueueMeasurement(Ed,n),new zy(((r,n)=>{const o=Qy();window.setTimeout((()=>{o?(o.src=e,r(o)):n("Unable to load iframe")}),t)}))}function Yy(e){const t=Qy();return t.src=e,t}function Qy(){const e=document.createElement("iframe");return e.className="msalSilentIframe",e.style.visibility="hidden",e.style.position="absolute",e.style.width=e.style.height="0",e.style.border="0",e.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),document.body.appendChild(e),e}function Jy(e){document.body===e.parentNode&&document.body.removeChild(e)}var Xy=r(64583).Promise;class Zy extends my{constructor(e,t,r,n,o,i,a,s,c,l,u){super(e,t,r,n,o,i,s,l,u),this.apiId=a,this.nativeStorage=c}async acquireToken(e){this.performanceClient.addQueueMeasurement(nd,e.correlationId),e.loginHint||e.sid||e.account&&e.account.username||this.logger.warning("No user hint provided. The authorization server may need more information to complete this request.");const t={...e};t.prompt?t.prompt!==Xs.NONE&&t.prompt!==Xs.NO_SESSION&&(this.logger.warning(`SilentIframeClient. Replacing invalid prompt ${t.prompt} with ${Xs.NONE}`),t.prompt=Xs.NONE):t.prompt=Xs.NONE;const r=await mg(this.initializeAuthorizationRequest.bind(this),Rd,this.logger,this.performanceClient,e.correlationId)(t,Xh.Silent);return r.platformBroker=ky.isPlatformBrokerAvailable(this.config,this.logger,this.nativeMessageHandler,r.authenticationScheme),Zf(r.authority),this.config.auth.protocolMode===yc?this.executeEarFlow(r):this.executeCodeFlow(r)}async executeCodeFlow(e){let t;const r=this.initializeServerTelemetryManager(this.apiId);try{return t=await mg(this.createAuthCodeClient.bind(this),_d,this.logger,this.performanceClient,e.correlationId)({serverTelemetryManager:r,requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account}),await mg(this.silentTokenHelper.bind(this),Sd,this.logger,this.performanceClient,e.correlationId)(t,e)}catch(n){if(n instanceof Ac&&(n.setCorrelationId(this.correlationId),r.cacheFailedRequest(n)),!(t&&n instanceof Ac&&n.errorCode===xh))throw n;return this.performanceClient.addFields({retryError:n.errorCode},this.correlationId),await mg(this.silentTokenHelper.bind(this),Sd,this.logger,this.performanceClient,this.correlationId)(t,e)}}async executeEarFlow(e){const t=e.correlationId,r=await mg(this.getDiscoveredAuthority.bind(this),ad,this.logger,this.performanceClient,t)({requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account}),n=await mg(Of,kh,this.logger,this.performanceClient,t)(),o={...e,earJwk:n},i=await mg(Wy,Td,this.logger,this.performanceClient,t)(this.config,r,o,this.logger,this.performanceClient),a=this.config.auth.OIDCOptions.serverResponseType,s=await mg(Gy,Id,this.logger,this.performanceClient,t)(i,this.config.system.iframeHashTimeout,this.config.system.pollIntervalMilliseconds,this.performanceClient,this.logger,t,a),c=gg(Sy,Kd,this.logger,this.performanceClient,t)(s,a,this.logger);return mg(qy,Bd,this.logger,this.performanceClient,t)(o,c,this.apiId,this.config,r,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.nativeMessageHandler)}logout(){return Xy.reject(sf(Ep))}async silentTokenHelper(e,t){const r=t.correlationId;this.performanceClient.addQueueMeasurement(Sd,r);const n=await mg(Hy,hh,this.logger,this.performanceClient,r)(this.performanceClient,this.logger,r),o={...t,codeChallenge:n.challenge},i=await mg(My,Od,this.logger,this.performanceClient,r)(this.config,e.authority,o,this.logger,this.performanceClient),a=await mg(Ky,Td,this.logger,this.performanceClient,r)(i,this.performanceClient,this.logger,r,this.config.system.navigateFrameWait),s=this.config.auth.OIDCOptions.serverResponseType,c=await mg(Gy,Id,this.logger,this.performanceClient,r)(a,this.config.system.iframeHashTimeout,this.config.system.pollIntervalMilliseconds,this.performanceClient,this.logger,r,s),l=gg(Sy,Kd,this.logger,this.performanceClient,r)(c,s,this.logger);return mg(Ly,qd,this.logger,this.performanceClient,r)(t,l,n.verifier,this.apiId,this.config,e,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.nativeMessageHandler)}}class ev extends ny{constructor(e,t){super(e,t)}async acquireToken(e){this.performanceClient?.addQueueMeasurement(hd,e.correlationId);const t=Al(),r=await mg(this.executeTokenRequest.bind(this),dd,this.logger,this.performanceClient,e.correlationId)(e,this.authority),n=r.headers?.[Ks],o=new sy(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin);return o.validateTokenResponse(r.body),mg(o.handleServerTokenResponse.bind(o),zd,this.logger,this.performanceClient,e.correlationId)(r.body,this.authority,t,e,void 0,void 0,!0,e.forceCache,n)}async acquireTokenByRefreshToken(e){if(!e)throw du(Yl);if(this.performanceClient?.addQueueMeasurement(fd,e.correlationId),!e.account)throw ml(Vc);if(this.cacheManager.isAppMetadataFOCI(e.account.environment))try{return await mg(this.acquireTokenWithCachedRefreshToken.bind(this),pd,this.logger,this.performanceClient,e.correlationId)(e,!0)}catch(t){const r=t instanceof xg&&t.errorCode===Cg,n=t instanceof ty&&"invalid_grant"===t.errorCode&&"client_mismatch"===t.subError;if(r||n)return mg(this.acquireTokenWithCachedRefreshToken.bind(this),pd,this.logger,this.performanceClient,e.correlationId)(e,!1);throw t}return mg(this.acquireTokenWithCachedRefreshToken.bind(this),pd,this.logger,this.performanceClient,e.correlationId)(e,!1)}async acquireTokenWithCachedRefreshToken(e,t){this.performanceClient?.addQueueMeasurement(pd,e.correlationId);const r=gg(this.cacheManager.getRefreshToken.bind(this.cacheManager),ch,this.logger,this.performanceClient,e.correlationId)(e.account,t,void 0,this.performanceClient,e.correlationId);if(!r)throw Pg(Cg);if(r.expiresOn&&Tl(r.expiresOn,e.refreshTokenExpirationOffsetSeconds||300))throw this.performanceClient?.addFields({rtExpiresOnMs:Number(r.expiresOn)},e.correlationId),Pg(kg);const n={...e,refreshToken:r.secret,authenticationScheme:e.authenticationScheme||hc.BEARER,ccsCredential:{credential:e.account.homeAccountId,type:mm}};try{return await mg(this.acquireToken.bind(this),hd,this.logger,this.performanceClient,e.correlationId)(n)}catch(t){if(t instanceof xg&&(this.performanceClient?.addFields({rtExpiresOnMs:Number(r.expiresOn)},e.correlationId),t.subError===Sg)){this.logger.verbose("acquireTokenWithRefreshToken: bad refresh token, removing from cache");const e=El(r);this.cacheManager.removeRefreshToken(e)}throw t}}async executeTokenRequest(e,t){this.performanceClient?.addQueueMeasurement(dd,e.correlationId);const r=this.createTokenQueryParameters(e),n=Su.appendQueryString(t.tokenEndpoint,r),o=await mg(this.createTokenRequestBody.bind(this),gd,this.logger,this.performanceClient,e.correlationId)(e),i=this.createTokenRequestHeaders(e.ccsCredential),a=Rg(this.config.authOptions.clientId,e);return mg(this.executePostToTokenEndpoint.bind(this),ld,this.logger,this.performanceClient,e.correlationId)(n,o,i,a,e.correlationId,ld)}async createTokenRequestBody(e){this.performanceClient?.addQueueMeasurement(gd,e.correlationId);const t=new Map;if(Pm(t,e.embeddedClientId||e.tokenBodyParameters?.[vm]||this.config.authOptions.clientId),e.redirectUri&&Rm(t,e.redirectUri),_m(t,e.scopes,!0,this.config.authOptions.authority.options.OIDCOptions?.defaultScopes),zm(t,"refresh_token"),Km(t),Hm(t,this.config.libraryInfo),$m(t,this.config.telemetry.application),Xm(t),this.serverTelemetryManager&&!Ku(this.config)&&Jm(t,this.serverTelemetryManager),function(e,t){e.set("refresh_token",t)}(t,e.refreshToken),this.config.clientCredentials.clientSecret&&Fm(t,this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){const r=this.config.clientCredentials.clientAssertion;Um(t,await uy(r.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),jm(t,r.assertionType)}if(e.authenticationScheme===hc.POP){const r=new iy(this.cryptoUtils,this.performanceClient);let n;n=e.popKid?this.cryptoUtils.encodeKid(e.popKid):(await mg(r.generateCnf.bind(r),Ud,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString,Ym(t,n)}else if(e.authenticationScheme===hc.SSH){if(!e.sshJwk)throw du(ru);Qm(t,e.sshJwk)}if((!hu.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&Lm(t,e.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&e.ccsCredential)switch(e.ccsCredential.type){case mm:try{Nm(t,gu(e.ccsCredential.credential))}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}break;case ym:Mm(t,e.ccsCredential.credential)}return e.embeddedClientId&&Zm(t,this.config.authOptions.clientId,this.config.authOptions.redirectUri),e.tokenBodyParameters&&Gm(t,e.tokenBodyParameters),Em(t,e.correlationId,this.performanceClient),ku(t)}}var tv=r(64583).Promise;class rv extends my{async acquireToken(e){this.performanceClient.addQueueMeasurement(od,e.correlationId);const t=await mg(fy,wd,this.logger,this.performanceClient,e.correlationId)(e,this.config,this.performanceClient,this.logger),r={...e,...t};e.redirectUri&&(r.redirectUri=this.getRedirectUri(e.redirectUri));const n=this.initializeServerTelemetryManager(61),o=await this.createRefreshTokenClient({serverTelemetryManager:n,authorityUrl:r.authority,azureCloudOptions:r.azureCloudOptions,account:r.account});return mg(o.acquireTokenByRefreshToken.bind(o),fd,this.logger,this.performanceClient,e.correlationId)(r).catch((e=>{throw e.setCorrelationId(this.correlationId),n.cacheFailedRequest(e),e}))}logout(){return tv.reject(sf(Ep))}async createRefreshTokenClient(e){const t=await mg(this.getClientConfiguration.bind(this),Pd,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:e.serverTelemetryManager,requestAuthority:e.authorityUrl,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account});return new ev(t,this.performanceClient)}}class nv{constructor(e,t,r,n){this.isBrowserEnvironment="undefined"!=typeof window,this.config=e,this.storage=t,this.logger=r,this.cryptoObj=n}async loadExternalTokens(e,t,r){if(!this.isBrowserEnvironment)throw sf(Np);const n=e.correlationId||Pf(),o=t.id_token?wl(t.id_token,gf):void 0,i={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},a=e.authority?new vg(vg.generateAuthority(e.authority,e.azureCloudOptions),this.config.system.networkClient,this.storage,i,this.logger,e.correlationId||Pf()):void 0,s=await this.loadAccount(e,r.clientInfo||t.client_info||"",n,o,a),c=await this.loadIdToken(t,s.homeAccountId,s.environment,s.realm,n),l=await this.loadAccessToken(e,t,s.homeAccountId,s.environment,s.realm,r,n),u=await this.loadRefreshToken(t,s.homeAccountId,s.environment,n);return this.generateAuthenticationResult(e,{account:s,idToken:c,accessToken:l,refreshToken:u},o,a)}async loadAccount(e,t,r,n,o){if(this.logger.verbose("TokenCache - loading account"),e.account){const t=wu.createFromAccountInfo(e.account);return await this.storage.setAccount(t,r),t}if(!o||!t&&!n)throw this.logger.error("TokenCache - if an account is not provided on the request, authority and either clientInfo or idToken must be provided instead."),sf(Dp);const i=wu.generateHomeAccountId(t,o.authorityType,this.logger,this.cryptoObj,n),a=n?.tid,s=cy(this.storage,o,i,gf,n,t,o.hostnameAndPort,a,void 0,void 0,this.logger);return await this.storage.setAccount(s,r),s}async loadIdToken(e,t,r,n,o){if(!e.id_token)return this.logger.verbose("TokenCache - no id token found in response"),null;this.logger.verbose("TokenCache - loading id token");const i=xl(t,r,e.id_token,this.config.auth.clientId,n);return await this.storage.setIdTokenCredential(i,o),i}async loadAccessToken(e,t,r,n,o,i,a){if(!t.access_token)return this.logger.verbose("TokenCache - no access token found in response"),null;if(!t.expires_in)return this.logger.error("TokenCache - no expiration set on the access token. Cannot add it to the cache."),null;if(!(t.scope||e.scopes&&e.scopes.length))return this.logger.error("TokenCache - scopes not specified in the request or response. Cannot add token to the cache."),null;this.logger.verbose("TokenCache - loading access token");const s=t.scope?pu.fromString(t.scope):new pu(e.scopes),c=i.expiresOn||t.expires_in+Al(),l=i.extendedExpiresOn||(t.ext_expires_in||t.expires_in)+Al(),u=_l(r,n,t.access_token,this.config.auth.clientId,o,s.printScopes(),c,l,gf);return await this.storage.setAccessTokenCredential(u,a),u}async loadRefreshToken(e,t,r,n){if(!e.refresh_token)return this.logger.verbose("TokenCache - no refresh token found in response"),null;this.logger.verbose("TokenCache - loading refresh token");const o=Pl(t,r,e.refresh_token,this.config.auth.clientId,e.foci,void 0,e.refresh_token_expires_in);return await this.storage.setRefreshTokenCredential(o,n),o}generateAuthenticationResult(e,t,r,n){let o,i="",a=[],s=null;t?.accessToken&&(i=t.accessToken.secret,a=pu.fromString(t.accessToken.target).asArray(),s=Sl(t.accessToken.expiresOn),o=Sl(t.accessToken.extendedExpiresOn));const c=t.account;return{authority:n?n.canonicalAuthority:"",uniqueId:t.account.localAccountId,tenantId:t.account.realm,scopes:a,account:c.getAccountInfo(),idToken:t.idToken?.secret||"",idTokenClaims:r||{},accessToken:i,fromCache:!0,expiresOn:s,correlationId:e.correlationId||"",requestId:"",extExpiresOn:o,familyId:t.refreshToken?.familyId||"",tokenType:t?.accessToken?.tokenType||"",state:e.state||"",cloudGraphHostName:c.cloudGraphHostName||"",msGraphHost:c.msGraphHost||"",fromNativeBroker:!1}}}class ov extends dy{constructor(e){super(e),this.includeRedirectUri=!1}}var iv=r(64583).Promise;class av extends my{constructor(e,t,r,n,o,i,a,s,c,l){super(e,t,r,n,o,i,s,c,l),this.apiId=a}async acquireToken(e){if(!e.code)throw sf(Up);const t=await mg(this.initializeAuthorizationRequest.bind(this),Rd,this.logger,this.performanceClient,e.correlationId)(e,Xh.Silent),r=this.initializeServerTelemetryManager(this.apiId);try{const n={...t,code:e.code},o=await mg(this.getClientConfiguration.bind(this),Pd,this.logger,this.performanceClient,e.correlationId)({serverTelemetryManager:r,requestAuthority:t.authority,requestAzureCloudOptions:t.azureCloudOptions,requestExtraQueryParameters:t.extraQueryParameters,account:t.account}),i=new ov(o);this.logger.verbose("Auth code client created");const a=new Ey(i,this.browserStorage,n,this.logger,this.performanceClient);return await mg(a.handleCodeResponseFromServer.bind(a),Md,this.logger,this.performanceClient,e.correlationId)({code:e.code,msgraph_host:e.msGraphHost,cloud_graph_host_name:e.cloudGraphHostName,cloud_instance_host_name:e.cloudInstanceHostName},t,!1)}catch(e){throw e instanceof Ac&&(e.setCorrelationId(this.correlationId),r.cacheFailedRequest(e)),e}}logout(){return iv.reject(sf(Ep))}}var sv=r(64583).Promise;function cv(e){const t=e?.idTokenClaims;return t?.tfp||t?.acr?"B2C":t?.tid?"9188040d-6c67-4c5b-b112-36a304b66dad"===t?.tid?"MSA":"AAD":void 0}function lv(e,t){try{Jf(e)}catch(e){throw t.end({success:!1},e),e}}class uv{constructor(e){this.operatingContext=e,this.isBrowserEnvironment=this.operatingContext.isBrowserEnvironment(),this.config=e.getConfig(),this.initialized=!1,this.logger=this.operatingContext.getLogger(),this.networkClient=this.config.system.networkClient,this.navigationClient=this.config.system.navigationClient,this.redirectResponse=new Map,this.hybridAuthCodeResponses=new Map,this.performanceClient=this.config.telemetry.client,this.browserCrypto=this.isBrowserEnvironment?new pg(this.logger,this.performanceClient):yl,this.eventHandler=new gm(this.logger),this.browserStorage=this.isBrowserEnvironment?new im(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger,this.performanceClient,this.eventHandler,wg(this.config.auth)):sm(this.config.auth.clientId,this.logger,this.performanceClient,this.eventHandler);const t={cacheLocation:qh,temporaryCacheLocation:qh,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1};this.nativeInternalStorage=new im(this.config.auth.clientId,t,this.browserCrypto,this.logger,this.performanceClient,this.eventHandler),this.tokenCache=new nv(this.config,this.browserStorage,this.logger,this.browserCrypto),this.activeSilentTokenRequests=new Map,this.trackPageVisibility=this.trackPageVisibility.bind(this),this.trackPageVisibilityWithMeasurement=this.trackPageVisibilityWithMeasurement.bind(this)}static async createController(e,t){const r=new uv(e);return await r.initialize(t),r}trackPageVisibility(e){e&&(this.logger.info("Perf: Visibility change detected"),this.performanceClient.incrementFields({visibilityChangeCount:1},e))}async initialize(e,t){if(this.logger.trace("initialize called"),this.initialized)return void this.logger.info("initialize has already been called, exiting early.");if(!this.isBrowserEnvironment)return this.logger.info("in non-browser environment, exiting early."),this.initialized=!0,void this.eventHandler.emitEvent(Fg);const r=e?.correlationId||this.getRequestCorrelationId(),n=this.config.system.allowPlatformBroker,o=this.performanceClient.startMeasurement(Ad,r);if(this.eventHandler.emitEvent("msal:initializeStart"),!t)try{this.logMultipleInstances(o)}catch{}if(await mg(this.browserStorage.initialize.bind(this.browserStorage),kd,this.logger,this.performanceClient,r)(r),n)try{this.nativeExtensionProvider=await ky.createProvider(this.logger,this.config.system.nativeBrokerHandshakeTimeout,this.performanceClient)}catch(e){this.logger.verbose(e)}this.config.cache.claimsBasedCachingEnabled||(this.logger.verbose("Claims-based caching is disabled. Clearing the previous cache with claims"),await mg(this.browserStorage.clearTokensAndKeysWithClaims.bind(this.browserStorage),sh,this.logger,this.performanceClient,r)(this.performanceClient,r)),this.config.system.asyncPopups&&await this.preGeneratePkceCodes(r),this.initialized=!0,this.eventHandler.emitEvent(Fg),o.end({allowPlatformBroker:n,success:!0})}async handleRedirectPromise(e){if(this.logger.verbose("handleRedirectPromise called"),Qf(this.initialized),this.isBrowserEnvironment){const t=e||"";let r=this.redirectResponse.get(t);return void 0===r?(r=this.handleRedirectPromiseInternal(e),this.redirectResponse.set(t,r),this.logger.verbose("handleRedirectPromise has been called for the first time, storing the promise")):this.logger.verbose("handleRedirectPromise has been called previously, returning the result from the first call"),r}return this.logger.verbose("handleRedirectPromise returns null, not browser environment"),null}async handleRedirectPromiseInternal(e){if(!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;const t=this.browserStorage.getInteractionInProgress()?.type;if(t===$h)return this.logger.verbose("handleRedirectPromise removing interaction_in_progress flag and returning null after sign-out"),this.browserStorage.setInteractionInProgress(!1),sv.resolve(null);const r=this.getAllAccounts(),n=this.browserStorage.getCachedNativeRequest(),o=n&&ky.isPlatformBrokerAvailable(this.config,this.logger,this.nativeExtensionProvider)&&this.nativeExtensionProvider&&!e;let i,a;this.eventHandler.emitEvent("msal:handleRedirectStart",Xh.Redirect);try{if(o&&this.nativeExtensionProvider){i=this.performanceClient.startMeasurement(Zu,n?.correlationId||""),this.logger.trace("handleRedirectPromise - acquiring token from native platform");const e=new Ry(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,865,this.performanceClient,this.nativeExtensionProvider,n.accountId,this.nativeInternalStorage,n.correlationId);a=mg(e.handleRedirectPromise.bind(e),oh,this.logger,this.performanceClient,i.event.correlationId)(this.performanceClient,i.event.correlationId)}else{const[t,r]=this.browserStorage.getCachedRequest(),n=t.correlationId;i=this.performanceClient.startMeasurement(Zu,n),this.logger.trace("handleRedirectPromise - acquiring token from web flow");const o=this.createRedirectClient(n);a=mg(o.handleRedirectPromise.bind(o),nh,this.logger,this.performanceClient,i.event.correlationId)(e,t,r,i)}}catch(e){throw this.browserStorage.resetRequestCache(),e}return a.then((e=>(e?(this.browserStorage.resetRequestCache(),r.length<this.getAllAccounts().length?(this.eventHandler.emitEvent(Wg,Xh.Redirect,e),this.logger.verbose("handleRedirectResponse returned result, login success")):(this.eventHandler.emitEvent(Yg,Xh.Redirect,e),this.logger.verbose("handleRedirectResponse returned result, acquire token success")),i.end({success:!0,accountType:cv(e.account)})):i.event.errorCode?i.end({success:!1}):i.discard(),this.eventHandler.emitEvent(Xg,Xh.Redirect),e))).catch((e=>{this.browserStorage.resetRequestCache();const t=e;throw r.length>0?this.eventHandler.emitEvent(Qg,Xh.Redirect,null,t):this.eventHandler.emitEvent(Gg,Xh.Redirect,null,t),this.eventHandler.emitEvent(Xg,Xh.Redirect),i.end({success:!1},t),e}))}async acquireTokenRedirect(e){const t=this.getRequestCorrelationId(e);this.logger.verbose("acquireTokenRedirect called",t);const r=this.performanceClient.startMeasurement("acquireTokenPreRedirect",t);r.add({accountType:cv(e.account),scenarioId:e.scenarioId});const n=e.onRedirectNavigate;if(n)e.onRedirectNavigate=e=>{const t="function"==typeof n?n(e):void 0;return!1!==t?r.end({success:!0}):r.discard(),t};else{const e=this.config.auth.onRedirectNavigate;this.config.auth.onRedirectNavigate=t=>{const n="function"==typeof e?e(t):void 0;return!1!==n?r.end({success:!0}):r.discard(),n}}const o=this.getAllAccounts().length>0;try{let n;return Xf(this.initialized,this.config),this.browserStorage.setInteractionInProgress(!0,Hh),o?this.eventHandler.emitEvent(Vg,Xh.Redirect,e):this.eventHandler.emitEvent(Kg,Xh.Redirect,e),n=this.nativeExtensionProvider&&this.canUsePlatformBroker(e)?new Ry(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Qh,this.performanceClient,this.nativeExtensionProvider,this.getNativeAccountId(e),this.nativeInternalStorage,t).acquireTokenRedirect(e,r).catch((r=>{if(r instanceof by&&wy(r))return this.nativeExtensionProvider=void 0,this.createRedirectClient(t).acquireToken(e);if(r instanceof xg)return this.logger.verbose("acquireTokenRedirect - Resolving interaction required error thrown by native broker by falling back to web flow"),this.createRedirectClient(t).acquireToken(e);throw r})):this.createRedirectClient(t).acquireToken(e),await n}catch(e){throw this.browserStorage.resetRequestCache(),r.end({success:!1},e),o?this.eventHandler.emitEvent(Qg,Xh.Redirect,null,e):this.eventHandler.emitEvent(Gg,Xh.Redirect,null,e),e}}acquireTokenPopup(e){const t=this.getRequestCorrelationId(e),r=this.performanceClient.startMeasurement(Xu,t);r.add({scenarioId:e.scenarioId,accountType:cv(e.account)});try{this.logger.verbose("acquireTokenPopup called",t),lv(this.initialized,r),this.browserStorage.setInteractionInProgress(!0,Hh)}catch(e){return sv.reject(e)}const n=this.getAllAccounts();let o;n.length>0?this.eventHandler.emitEvent(Vg,Xh.Popup,e):this.eventHandler.emitEvent(Kg,Xh.Popup,e);const i=this.getPreGeneratedPkceCodes(t);return o=this.canUsePlatformBroker(e)?this.acquireTokenNative({...e,correlationId:t},Jh).then((e=>(r.end({success:!0,isNativeBroker:!0,accountType:cv(e.account)}),e))).catch((r=>{if(r instanceof by&&wy(r))return this.nativeExtensionProvider=void 0,this.createPopupClient(t).acquireToken(e,i);if(r instanceof xg)return this.logger.verbose("acquireTokenPopup - Resolving interaction required error thrown by native broker by falling back to web flow"),this.createPopupClient(t).acquireToken(e,i);throw r})):this.createPopupClient(t).acquireToken(e,i),o.then((e=>(n.length<this.getAllAccounts().length?this.eventHandler.emitEvent(Wg,Xh.Popup,e):this.eventHandler.emitEvent(Yg,Xh.Popup,e),r.end({success:!0,accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length,accountType:cv(e.account)}),e))).catch((e=>(n.length>0?this.eventHandler.emitEvent(Qg,Xh.Popup,null,e):this.eventHandler.emitEvent(Gg,Xh.Popup,null,e),r.end({success:!1},e),sv.reject(e)))).finally((async()=>{this.browserStorage.setInteractionInProgress(!1),this.config.system.asyncPopups&&await this.preGeneratePkceCodes(t)}))}trackPageVisibilityWithMeasurement(){const e=this.ssoSilentMeasurement||this.acquireTokenByCodeAsyncMeasurement;e&&(this.logger.info("Perf: Visibility change detected in ",e.event.name),e.increment({visibilityChangeCount:1}))}async ssoSilent(e){const t=this.getRequestCorrelationId(e),r={...e,prompt:e.prompt,correlationId:t};let n;return this.ssoSilentMeasurement=this.performanceClient.startMeasurement(id,t),this.ssoSilentMeasurement?.add({scenarioId:e.scenarioId,accountType:cv(e.account)}),lv(this.initialized,this.ssoSilentMeasurement),this.ssoSilentMeasurement?.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),this.logger.verbose("ssoSilent called",t),this.eventHandler.emitEvent("msal:ssoSilentStart",Xh.Silent,r),n=this.canUsePlatformBroker(r)?this.acquireTokenNative(r,863).catch((e=>{if(e instanceof by&&wy(e))return this.nativeExtensionProvider=void 0,this.createSilentIframeClient(r.correlationId).acquireToken(r);throw e})):this.createSilentIframeClient(r.correlationId).acquireToken(r),n.then((e=>(this.eventHandler.emitEvent("msal:ssoSilentSuccess",Xh.Silent,e),this.ssoSilentMeasurement?.end({success:!0,isNativeBroker:e.fromNativeBroker,accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length,accountType:cv(e.account)}),e))).catch((e=>{throw this.eventHandler.emitEvent("msal:ssoSilentFailure",Xh.Silent,null,e),this.ssoSilentMeasurement?.end({success:!1},e),e})).finally((()=>{document.removeEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement)}))}async acquireTokenByCode(e){const t=this.getRequestCorrelationId(e);this.logger.trace("acquireTokenByCode called",t);const r=this.performanceClient.startMeasurement(Vu,t);lv(this.initialized,r),this.eventHandler.emitEvent("msal:acquireTokenByCodeStart",Xh.Silent,e),r.add({scenarioId:e.scenarioId});try{if(e.code&&e.nativeAccountId)throw sf(zp);if(e.code){const n=e.code;let o=this.hybridAuthCodeResponses.get(n);return o?(this.logger.verbose("Existing acquireTokenByCode request found",t),r.discard()):(this.logger.verbose("Initiating new acquireTokenByCode request",t),o=this.acquireTokenByCodeAsync({...e,correlationId:t}).then((e=>(this.eventHandler.emitEvent("msal:acquireTokenByCodeSuccess",Xh.Silent,e),this.hybridAuthCodeResponses.delete(n),r.end({success:!0,isNativeBroker:e.fromNativeBroker,accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length,accountType:cv(e.account)}),e))).catch((e=>{throw this.hybridAuthCodeResponses.delete(n),this.eventHandler.emitEvent(Jg,Xh.Silent,null,e),r.end({success:!1},e),e})),this.hybridAuthCodeResponses.set(n,o)),await o}if(e.nativeAccountId){if(this.canUsePlatformBroker(e,e.nativeAccountId)){const n=await this.acquireTokenNative({...e,correlationId:t},866,e.nativeAccountId).catch((e=>{throw e instanceof by&&wy(e)&&(this.nativeExtensionProvider=void 0),e}));return r.end({accountType:cv(n.account),success:!0}),n}throw sf(Wp)}throw sf(jp)}catch(e){throw this.eventHandler.emitEvent(Jg,Xh.Silent,null,e),r.end({success:!1},e),e}}async acquireTokenByCodeAsync(e){this.logger.trace("acquireTokenByCodeAsync called",e.correlationId),this.acquireTokenByCodeAsyncMeasurement=this.performanceClient.startMeasurement(rh,e.correlationId),this.acquireTokenByCodeAsyncMeasurement?.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement);const t=this.createSilentAuthCodeClient(e.correlationId);return await t.acquireToken(e).then((e=>(this.acquireTokenByCodeAsyncMeasurement?.end({success:!0,fromCache:e.fromCache,isNativeBroker:e.fromNativeBroker}),e))).catch((e=>{throw this.acquireTokenByCodeAsyncMeasurement?.end({success:!1},e),e})).finally((()=>{document.removeEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement)}))}async acquireTokenFromCache(e,t){switch(this.performanceClient.addQueueMeasurement(md,e.correlationId),t){case 0:case 1:case 2:const t=this.createSilentCacheClient(e.correlationId);return mg(t.acquireToken.bind(t),rd,this.logger,this.performanceClient,e.correlationId)(e);default:throw ml(rl)}}async acquireTokenByRefreshToken(e,t){switch(this.performanceClient.addQueueMeasurement(Yu,e.correlationId),t){case 0:case 2:case 3:case 4:const t=this.createSilentRefreshClient(e.correlationId);return mg(t.acquireToken.bind(t),od,this.logger,this.performanceClient,e.correlationId)(e);default:throw ml(rl)}}async acquireTokenBySilentIframe(e){this.performanceClient.addQueueMeasurement(bd,e.correlationId);const t=this.createSilentIframeClient(e.correlationId);return mg(t.acquireToken.bind(t),nd,this.logger,this.performanceClient,e.correlationId)(e)}async logout(e){const t=this.getRequestCorrelationId(e);return this.logger.warning("logout API is deprecated and will be removed in msal-browser v3.0.0. Use logoutRedirect instead.",t),this.logoutRedirect({correlationId:t,...e})}async logoutRedirect(e){const t=this.getRequestCorrelationId(e);return Xf(this.initialized,this.config),this.browserStorage.setInteractionInProgress(!0,$h),this.createRedirectClient(t).logout(e)}logoutPopup(e){try{const t=this.getRequestCorrelationId(e);return Jf(this.initialized),this.browserStorage.setInteractionInProgress(!0,$h),this.createPopupClient(t).logout(e).finally((()=>{this.browserStorage.setInteractionInProgress(!1)}))}catch(e){return sv.reject(e)}}async clearCache(e){if(!this.isBrowserEnvironment)return void this.logger.info("in non-browser environment, returning early.");const t=this.getRequestCorrelationId(e);return this.createSilentCacheClient(t).logout(e)}getAllAccounts(e){return cm(this.logger,this.browserStorage,this.isBrowserEnvironment,e)}getAccount(e){return lm(e,this.logger,this.browserStorage)}getAccountByUsername(e){return um(e,this.logger,this.browserStorage)}getAccountByHomeId(e){return dm(e,this.logger,this.browserStorage)}getAccountByLocalId(e){return hm(e,this.logger,this.browserStorage)}setActiveAccount(e){pm(e,this.browserStorage)}getActiveAccount(){return fm(this.browserStorage)}async hydrateCache(e,t){this.logger.verbose("hydrateCache called");const r=wu.createFromAccountInfo(e.account,e.cloudGraphHostName,e.msGraphHost);return await this.browserStorage.setAccount(r,e.correlationId),e.fromNativeBroker?(this.logger.verbose("Response was from native broker, storing in-memory"),this.nativeInternalStorage.hydrateCache(e,t)):this.browserStorage.hydrateCache(e,t)}async acquireTokenNative(e,t,r,n){if(this.logger.trace("acquireTokenNative called"),!this.nativeExtensionProvider)throw sf(Yp);return new Ry(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,t,this.performanceClient,this.nativeExtensionProvider,r||this.getNativeAccountId(e),this.nativeInternalStorage,e.correlationId).acquireToken(e,n)}canUsePlatformBroker(e,t){if(this.logger.trace("canUsePlatformBroker called"),!ky.isPlatformBrokerAvailable(this.config,this.logger,this.nativeExtensionProvider,e.authenticationScheme))return this.logger.trace("canUsePlatformBroker: isPlatformBrokerAvailable returned false, returning false"),!1;if(e.prompt)switch(e.prompt){case Xs.NONE:case Xs.CONSENT:case Xs.LOGIN:this.logger.trace("canUsePlatformBroker: prompt is compatible with platform broker flow");break;default:return this.logger.trace(`canUsePlatformBroker: prompt = ${e.prompt} is not compatible with platform broker flow, returning false`),!1}return!(!t&&!this.getNativeAccountId(e)&&(this.logger.trace("canUsePlatformBroker: nativeAccountId is not available, returning false"),1))}getNativeAccountId(e){const t=e.account||this.getAccount({loginHint:e.loginHint,sid:e.sid})||this.getActiveAccount();return t&&t.nativeAccountId||""}createPopupClient(e){return new Uy(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createRedirectClient(e){return new jy(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createSilentIframeClient(e){return new Zy(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,863,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createSilentCacheClient(e){return new _y(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)}createSilentRefreshClient(e){return new rv(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)}createSilentAuthCodeClient(e){return new av(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,866,this.performanceClient,this.nativeExtensionProvider,e)}addEventCallback(e,t){return this.eventHandler.addEventCallback(e,t)}removeEventCallback(e){this.eventHandler.removeEventCallback(e)}addPerformanceCallback(e){return Yf(),this.performanceClient.addPerformanceCallback(e)}removePerformanceCallback(e){return this.performanceClient.removePerformanceCallback(e)}enableAccountStorageEvents(){this.config.cache.cacheLocation===Bh?this.eventHandler.subscribeCrossTab():this.logger.info("Account storage events are only available when cacheLocation is set to localStorage")}disableAccountStorageEvents(){this.config.cache.cacheLocation===Bh?this.eventHandler.unsubscribeCrossTab():this.logger.info("Account storage events are only available when cacheLocation is set to localStorage")}getTokenCache(){return this.tokenCache}getLogger(){return this.logger}setLogger(e){this.logger=e}initializeWrapperLibrary(e,t){this.browserStorage.setWrapperMetadata(e,t)}setNavigationClient(e){this.navigationClient=e}getConfiguration(){return this.config}getPerformanceClient(){return this.performanceClient}isBrowserEnv(){return this.isBrowserEnvironment}getRequestCorrelationId(e){return e?.correlationId?e.correlationId:this.isBrowserEnvironment?Pf():$s.EMPTY_STRING}async loginRedirect(e){const t=this.getRequestCorrelationId(e);return this.logger.verbose("loginRedirect called",t),this.acquireTokenRedirect({correlationId:t,...e||Zh})}loginPopup(e){const t=this.getRequestCorrelationId(e);return this.logger.verbose("loginPopup called",t),this.acquireTokenPopup({correlationId:t,...e||Zh})}async acquireTokenSilent(e){const t=this.getRequestCorrelationId(e),r=this.performanceClient.startMeasurement(Qu,t);r.add({cacheLookupPolicy:e.cacheLookupPolicy,scenarioId:e.scenarioId}),lv(this.initialized,r),this.logger.verbose("acquireTokenSilent called",t);const n=e.account||this.getActiveAccount();if(!n)throw sf(xp);return r.add({accountType:cv(n)}),this.acquireTokenSilentDeduped(e,n,t).then((n=>(r.end({success:!0,fromCache:n.fromCache,isNativeBroker:n.fromNativeBroker,accessTokenSize:n.accessToken.length,idTokenSize:n.idToken.length}),{...n,state:e.state,correlationId:t}))).catch((e=>{throw e instanceof Ac&&e.setCorrelationId(t),r.end({success:!1},e),e}))}async acquireTokenSilentDeduped(e,t,r){const n=Rg(this.config.auth.clientId,{...e,authority:e.authority||this.config.auth.authority,correlationId:r},t.homeAccountId),o=JSON.stringify(n),i=this.activeSilentTokenRequests.get(o);if(void 0===i){this.logger.verbose("acquireTokenSilent called for the first time, storing active request",r),this.performanceClient.addFields({deduped:!1},r);const n=mg(this.acquireTokenSilentAsync.bind(this),Ju,this.logger,this.performanceClient,r)({...e,correlationId:r},t);return this.activeSilentTokenRequests.set(o,n),n.finally((()=>{this.activeSilentTokenRequests.delete(o)}))}return this.logger.verbose("acquireTokenSilent has been called previously, returning the result from the first call",r),this.performanceClient.addFields({deduped:!0},r),i}async acquireTokenSilentAsync(e,t){const r=()=>this.trackPageVisibility(e.correlationId);this.performanceClient.addQueueMeasurement(Ju,e.correlationId),this.eventHandler.emitEvent(Vg,Xh.Silent,e),e.correlationId&&this.performanceClient.incrementFields({visibilityChangeCount:0},e.correlationId),document.addEventListener("visibilitychange",r);const n=await mg(gy,Cd,this.logger,this.performanceClient,e.correlationId)(e,t,this.config,this.performanceClient,this.logger),o=e.cacheLookupPolicy||0;return this.acquireTokenSilentNoIframe(n,o).catch((async e=>{const t=function(e,t){const r=!(e instanceof xg&&e.subError!==Sg),n=e.errorCode===xh||e.errorCode===rl,o=r&&n||e.errorCode===Cg||e.errorCode===kg,i=rp.includes(t);return o&&i}(e,o);if(t){if(this.activeIframeRequest){if(5!==o){const[t,r]=this.activeIframeRequest;this.logger.verbose(`Iframe request is already in progress, awaiting resolution for request with correlationId: ${r}`,n.correlationId);const i=this.performanceClient.startMeasurement("awaitConcurrentIframe",n.correlationId);i.add({awaitIframeCorrelationId:r});const a=await t;if(i.end({success:a}),a)return this.logger.verbose(`Parallel iframe request with correlationId: ${r} succeeded. Retrying cache and/or RT redemption`,n.correlationId),this.acquireTokenSilentNoIframe(n,o);throw this.logger.info(`Iframe request with correlationId: ${r} failed. Interaction is required.`),e}return this.logger.warning("Another iframe request is currently in progress and CacheLookupPolicy is set to Skip. This may result in degraded performance and/or reliability for both calls. Please consider changing the CacheLookupPolicy to take advantage of request queuing and token cache.",n.correlationId),mg(this.acquireTokenBySilentIframe.bind(this),bd,this.logger,this.performanceClient,n.correlationId)(n)}{let e;return this.activeIframeRequest=[new sv((t=>{e=t})),n.correlationId],this.logger.verbose("Refresh token expired/invalid or CacheLookupPolicy is set to Skip, attempting acquire token by iframe.",n.correlationId),mg(this.acquireTokenBySilentIframe.bind(this),bd,this.logger,this.performanceClient,n.correlationId)(n).then((t=>(e(!0),t))).catch((t=>{throw e(!1),t})).finally((()=>{this.activeIframeRequest=void 0}))}}throw e})).then((t=>(this.eventHandler.emitEvent(Yg,Xh.Silent,t),e.correlationId&&this.performanceClient.addFields({fromCache:t.fromCache,isNativeBroker:t.fromNativeBroker},e.correlationId),t))).catch((e=>{throw this.eventHandler.emitEvent(Qg,Xh.Silent,null,e),e})).finally((()=>{document.removeEventListener("visibilitychange",r)}))}async acquireTokenSilentNoIframe(e,t){return ky.isPlatformBrokerAvailable(this.config,this.logger,this.nativeExtensionProvider,e.authenticationScheme)&&e.account.nativeAccountId?(this.logger.verbose("acquireTokenSilent - attempting to acquire token from native platform"),this.acquireTokenNative(e,61,e.account.nativeAccountId,t).catch((async e=>{if(e instanceof by&&wy(e))throw this.logger.verbose("acquireTokenSilent - native platform unavailable, falling back to web flow"),this.nativeExtensionProvider=void 0,ml(rl);throw e}))):(this.logger.verbose("acquireTokenSilent - attempting to acquire token from web flow"),1===t&&this.logger.verbose("acquireTokenSilent - cache lookup policy set to AccessToken, attempting to acquire token from local cache"),mg(this.acquireTokenFromCache.bind(this),md,this.logger,this.performanceClient,e.correlationId)(e,t).catch((r=>{if(1===t)throw r;return this.eventHandler.emitEvent("msal:acquireTokenFromNetworkStart",Xh.Silent,e),mg(this.acquireTokenByRefreshToken.bind(this),Yu,this.logger,this.performanceClient,e.correlationId)(e,t)})))}async preGeneratePkceCodes(e){return this.logger.verbose("Generating new PKCE codes"),this.pkceCode=await mg(Hy,hh,this.logger,this.performanceClient,e)(this.performanceClient,this.logger,e),sv.resolve()}getPreGeneratedPkceCodes(e){this.logger.verbose("Attempting to pick up pre-generated PKCE codes");const t=this.pkceCode?{...this.pkceCode}:void 0;return this.pkceCode=void 0,this.logger.verbose((t?"Found":"Did not find")+" pre-generated PKCE codes"),this.performanceClient.addFields({usePreGeneratedPkce:!!t},e),t}logMultipleInstances(e){const t=this.config.auth.clientId;window&&(window.msal=window.msal||{},window.msal.clientIds=window.msal.clientIds||[],window.msal.clientIds.length>0&&this.logger.verbose("There is already an instance of MSAL.js in the window."),window.msal.clientIds.push(t),function(e,t,r){const n=window.msal?.clientIds||[],o=n.length,i=n.filter((t=>t===e)).length;i>1&&r.warning("There is already an instance of MSAL.js in the window with the same client id."),t.add({msalInstanceCount:o,sameClientIdInstanceCount:i})}(t,e,this.logger))}}r(64583).Promise;const dv="NESTED_APP_AUTH_UNAVAILABLE";class hv{constructor(e,t,r,n){this.clientId=e,this.clientCapabilities=t,this.crypto=r,this.logger=n}toNaaTokenRequest(e){let t;t=void 0===e.extraQueryParameters?new Map:new Map(Object.entries(e.extraQueryParameters));const r=e.correlationId||this.crypto.createNewGuid(),n=Vm(e.claims,this.clientCapabilities),o=e.scopes||Ds;return{platformBrokerId:e.account?.homeAccountId,clientId:this.clientId,authority:e.authority,scope:o.join(" "),correlationId:r,claims:hu.isEmptyObj(n)?void 0:n,state:e.state,authenticationScheme:e.authenticationScheme||hc.BEARER,extraParameters:t}}fromNaaTokenResponse(e,t,r){if(!t.token.id_token||!t.token.access_token)throw ml(Ec);const n=Sl(r+(t.token.expires_in||0)),o=wl(t.token.id_token,this.crypto.base64Decode),i=this.fromNaaAccountInfo(t.account,t.token.id_token,o),a=t.token.scope||e.scope;return{authority:t.token.authority||i.environment,uniqueId:i.localAccountId,tenantId:i.tenantId,scopes:a.split(" "),account:i,idToken:t.token.id_token,idTokenClaims:o,accessToken:t.token.access_token,fromCache:!1,expiresOn:n,tokenType:e.authenticationScheme||hc.BEARER,correlationId:e.correlationId,extExpiresOn:n,state:e.state}}fromNaaAccountInfo(e,t,r){const n=r||e.idTokenClaims,o=e.localAccountId||n?.oid||n?.sub||"",i=e.tenantId||n?.tid||"",a=e.homeAccountId||`${o}.${i}`,s=e.username||n?.preferred_username||"",c=e.name||n?.name,l=new Map,u=yu(a,o,i,n);return l.set(i,u),{homeAccountId:a,environment:e.environment,tenantId:i,username:s,localAccountId:o,name:c,idToken:t,idTokenClaims:n,tenantProfiles:l}}fromBridgeError(e){if(!function(e){return void 0!==e.status}(e))return new Ac("unknown_error","An unknown error occurred");switch(e.status){case"USER_CANCEL":return new gl(ul);case"NO_NETWORK":return new gl(ll);case"ACCOUNT_UNAVAILABLE":return new gl(Jc);case"DISABLED":return new gl(pl);case dv:return new gl(e.code||pl,e.description);case"TRANSIENT_ERROR":case"PERSISTENT_ERROR":return new ty(e.code,e.description);case"USER_INTERACTION_REQUIRED":return new xg(e.code,e.description);default:return new Ac(e.code,e.description)}}toAuthenticationResultFromCache(e,t,r,n,o){if(!t||!r)throw ml(Ec);const i=wl(t.secret,this.crypto.base64Decode),a=r.target||n.scopes.join(" ");return{authority:r.environment||e.environment,uniqueId:e.localAccountId,tenantId:e.tenantId,scopes:a.split(" "),account:e,idToken:t.secret,idTokenClaims:i||{},accessToken:r.secret,fromCache:!0,expiresOn:Sl(r.expiresOn),extExpiresOn:Sl(r.extendedExpiresOn),tokenType:n.authenticationScheme||hc.BEARER,correlationId:o,state:n.state}}}const pv="unsupported_method",fv="This method is not supported in nested app environment.";class gv extends Ac{constructor(e,t){super(e,t),Object.setPrototypeOf(this,gv.prototype),this.name="NestedAppAuthError"}static createUnsupportedError(){return new gv(pv,fv)}}var mv=r(64583).Promise;class yv{constructor(e){this.operatingContext=e;const t=this.operatingContext.getBridgeProxy();if(void 0===t)throw new Error("unexpected: bridgeProxy is undefined");this.bridgeProxy=t,this.config=e.getConfig(),this.logger=this.operatingContext.getLogger(),this.performanceClient=this.config.telemetry.client,this.browserCrypto=e.isBrowserEnvironment()?new pg(this.logger,this.performanceClient,!0):yl,this.eventHandler=new gm(this.logger),this.browserStorage=this.operatingContext.isBrowserEnvironment()?new im(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger,this.performanceClient,this.eventHandler,wg(this.config.auth)):sm(this.config.auth.clientId,this.logger,this.performanceClient,this.eventHandler),this.nestedAppAuthAdapter=new hv(this.config.auth.clientId,this.config.auth.clientCapabilities,this.browserCrypto,this.logger);const r=this.bridgeProxy.getAccountContext();this.currentAccountContext=r||null}static async createController(e){const t=new yv(e);return mv.resolve(t)}async initialize(e,t){const r=e?.correlationId||Pf();return await this.browserStorage.initialize(r),mv.resolve()}ensureValidRequest(e){return e?.correlationId?e:{...e,correlationId:this.browserCrypto.createNewGuid()}}async acquireTokenInteractive(e){const t=this.ensureValidRequest(e);this.eventHandler.emitEvent(Vg,Xh.Popup,t);const r=this.performanceClient.startMeasurement(Xu,t.correlationId);r?.add({nestedAppAuthRequest:!0});try{const n=this.nestedAppAuthAdapter.toNaaTokenRequest(t),o=Al(),i=await this.bridgeProxy.getTokenInteractive(n),a={...this.nestedAppAuthAdapter.fromNaaTokenResponse(n,i,o)};return await this.hydrateCache(a,e),this.currentAccountContext={homeAccountId:a.account.homeAccountId,environment:a.account.environment,tenantId:a.account.tenantId},this.eventHandler.emitEvent(Yg,Xh.Popup,a),r.add({accessTokenSize:a.accessToken.length,idTokenSize:a.idToken.length}),r.end({success:!0,requestId:a.requestId}),a}catch(e){const t=e instanceof Ac?e:this.nestedAppAuthAdapter.fromBridgeError(e);throw this.eventHandler.emitEvent(Qg,Xh.Popup,null,e),r.end({success:!1},e),t}}async acquireTokenSilentInternal(e){const t=this.ensureValidRequest(e);this.eventHandler.emitEvent(Vg,Xh.Silent,t);const r=await this.acquireTokenFromCache(t);if(r)return this.eventHandler.emitEvent(Yg,Xh.Silent,r),r;const n=this.performanceClient.startMeasurement(id,t.correlationId);n?.increment({visibilityChangeCount:0}),n?.add({nestedAppAuthRequest:!0});try{const r=this.nestedAppAuthAdapter.toNaaTokenRequest(t),o=Al(),i=await this.bridgeProxy.getTokenSilent(r),a=this.nestedAppAuthAdapter.fromNaaTokenResponse(r,i,o);return await this.hydrateCache(a,e),this.currentAccountContext={homeAccountId:a.account.homeAccountId,environment:a.account.environment,tenantId:a.account.tenantId},this.eventHandler.emitEvent(Yg,Xh.Silent,a),n?.add({accessTokenSize:a.accessToken.length,idTokenSize:a.idToken.length}),n?.end({success:!0,requestId:a.requestId}),a}catch(e){const t=e instanceof Ac?e:this.nestedAppAuthAdapter.fromBridgeError(e);throw this.eventHandler.emitEvent(Qg,Xh.Silent,null,e),n?.end({success:!1},e),t}}async acquireTokenFromCache(e){const t=this.performanceClient.startMeasurement(Qu,e.correlationId);if(t?.add({nestedAppAuthRequest:!0}),e.claims)return this.logger.verbose("Claims are present in the request, skipping cache lookup"),null;if(e.forceRefresh)return this.logger.verbose("forceRefresh is set to true, skipping cache lookup"),null;let r=null;switch(e.cacheLookupPolicy||(e.cacheLookupPolicy=0),e.cacheLookupPolicy){case 0:case 1:case 2:r=await this.acquireTokenFromCacheInternal(e);break;default:return null}return r?(this.eventHandler.emitEvent(Yg,Xh.Silent,r),t?.add({accessTokenSize:r?.accessToken.length,idTokenSize:r?.idToken.length}),t?.end({success:!0}),r):(this.logger.warning("Cached tokens are not found for the account, proceeding with silent token request."),this.eventHandler.emitEvent(Qg,Xh.Silent,null),t?.end({success:!1}),null)}async acquireTokenFromCacheInternal(e){const t=this.bridgeProxy.getAccountContext()||this.currentAccountContext;let r=null;if(t&&(r=lm(t,this.logger,this.browserStorage)),!r)return this.logger.verbose("No active account found, falling back to the host"),mv.resolve(null);this.logger.verbose("active account found, attempting to acquire token silently");const n={...e,correlationId:e.correlationId||this.browserCrypto.createNewGuid(),authority:e.authority||r.environment,scopes:e.scopes?.length?e.scopes:[...Ds]},o=this.browserStorage.getTokenKeys(),i=this.browserStorage.getAccessToken(r,n,o,r.tenantId,this.performanceClient,n.correlationId);if(!i)return this.logger.verbose("No cached access token found"),mv.resolve(null);if(Il(i.cachedAt)||Tl(i.expiresOn,this.config.system.tokenRenewalOffsetSeconds))return this.logger.verbose("Cached access token has expired"),mv.resolve(null);const a=this.browserStorage.getIdToken(r,o,r.tenantId,this.performanceClient,n.correlationId);return a?this.nestedAppAuthAdapter.toAuthenticationResultFromCache(r,a,i,n,n.correlationId):(this.logger.verbose("No cached id token found"),mv.resolve(null))}async acquireTokenPopup(e){return this.acquireTokenInteractive(e)}acquireTokenRedirect(e){throw gv.createUnsupportedError()}async acquireTokenSilent(e){return this.acquireTokenSilentInternal(e)}acquireTokenByCode(e){throw gv.createUnsupportedError()}acquireTokenNative(e,t,r){throw gv.createUnsupportedError()}acquireTokenByRefreshToken(e,t){throw gv.createUnsupportedError()}addEventCallback(e,t){return this.eventHandler.addEventCallback(e,t)}removeEventCallback(e){this.eventHandler.removeEventCallback(e)}addPerformanceCallback(e){throw gv.createUnsupportedError()}removePerformanceCallback(e){throw gv.createUnsupportedError()}enableAccountStorageEvents(){throw gv.createUnsupportedError()}disableAccountStorageEvents(){throw gv.createUnsupportedError()}getAllAccounts(e){return cm(this.logger,this.browserStorage,this.isBrowserEnv(),e)}getAccount(e){return lm(e,this.logger,this.browserStorage)}getAccountByUsername(e){return um(e,this.logger,this.browserStorage)}getAccountByHomeId(e){return dm(e,this.logger,this.browserStorage)}getAccountByLocalId(e){return hm(e,this.logger,this.browserStorage)}setActiveAccount(e){return pm(e,this.browserStorage)}getActiveAccount(){return fm(this.browserStorage)}handleRedirectPromise(e){return mv.resolve(null)}loginPopup(e){return this.acquireTokenInteractive(e||Zh)}loginRedirect(e){throw gv.createUnsupportedError()}logout(e){throw gv.createUnsupportedError()}logoutRedirect(e){throw gv.createUnsupportedError()}logoutPopup(e){throw gv.createUnsupportedError()}ssoSilent(e){return this.acquireTokenSilentInternal(e)}getTokenCache(){throw gv.createUnsupportedError()}getLogger(){return this.logger}setLogger(e){this.logger=e}initializeWrapperLibrary(e,t){}setNavigationClient(e){this.logger.warning("setNavigationClient is not supported in nested app auth")}getConfiguration(){return this.config}isBrowserEnv(){return this.operatingContext.isBrowserEnvironment()}getBrowserCrypto(){return this.browserCrypto}getPerformanceClient(){throw gv.createUnsupportedError()}getRedirectResponse(){throw gv.createUnsupportedError()}async clearCache(e){throw gv.createUnsupportedError()}async hydrateCache(e,t){this.logger.verbose("hydrateCache called");const r=wu.createFromAccountInfo(e.account,e.cloudGraphHostName,e.msGraphHost);return await this.browserStorage.setAccount(r,e.correlationId),this.browserStorage.hydrateCache(e,t)}}var vv=r(64583).Promise;class bv{static async initializeNestedAppAuthBridge(){if(void 0===window)throw new Error("window is undefined");if(void 0===window.nestedAppAuthBridge)throw new Error("window.nestedAppAuthBridge is undefined");try{window.nestedAppAuthBridge.addEventListener("message",(e=>{const t="string"==typeof e?e:e.data,r=JSON.parse(t),n=bv.bridgeRequests.find((e=>e.requestId===r.requestId));void 0!==n&&(bv.bridgeRequests.splice(bv.bridgeRequests.indexOf(n),1),r.success?n.resolve(r):n.reject(r.error))}));const e=await new vv(((e,t)=>{const r=bv.buildRequest("GetInitContext"),n={requestId:r.requestId,method:r.method,resolve:e,reject:t};bv.bridgeRequests.push(n),window.nestedAppAuthBridge.postMessage(JSON.stringify(r))}));return bv.validateBridgeResultOrThrow(e.initContext)}catch(e){throw window.console.log(e),e}}getTokenInteractive(e){return this.getToken("GetTokenPopup",e)}getTokenSilent(e){return this.getToken("GetToken",e)}async getToken(e,t){const r=await this.sendRequest(e,{tokenParams:t});return{token:bv.validateBridgeResultOrThrow(r.token),account:bv.validateBridgeResultOrThrow(r.account)}}getHostCapabilities(){return this.capabilities??null}getAccountContext(){return this.accountContext?this.accountContext:null}static buildRequest(e,t){return{messageType:"NestedAppAuthRequest",method:e,requestId:Pf(),sendTime:Date.now(),clientLibrary:Ph,clientLibraryVersion:eg,...t}}sendRequest(e,t){const r=bv.buildRequest(e,t);return new vv(((e,t)=>{const n={requestId:r.requestId,method:r.method,resolve:e,reject:t};bv.bridgeRequests.push(n),window.nestedAppAuthBridge.postMessage(JSON.stringify(r))}))}static validateBridgeResultOrThrow(e){if(void 0===e)throw{status:dv};return e}constructor(e,t,r,n){this.sdkName=e,this.sdkVersion=t,this.accountContext=r,this.capabilities=n}static async create(){const e=await bv.initializeNestedAppAuthBridge();return new bv(e.sdkName,e.sdkVersion,e.accountContext,e.capabilities)}}bv.bridgeRequests=[];class wv extends tg{constructor(){super(...arguments),this.bridgeProxy=void 0,this.accountContext=null}getModuleName(){return wv.MODULE_NAME}getId(){return wv.ID}getBridgeProxy(){return this.bridgeProxy}async initialize(){try{if("undefined"!=typeof window){"function"==typeof window.__initializeNestedAppAuth&&await window.__initializeNestedAppAuth();const e=await bv.create();this.accountContext=e.getAccountContext(),this.bridgeProxy=e,this.available=void 0!==e}}catch(e){this.logger.infoPii(`Could not initialize Nested App Auth bridge (${e})`)}return this.logger.info(`Nested App Auth Bridge available: ${this.available}`),this.available}}wv.MODULE_NAME="",wv.ID="NestedAppOperatingContext";class Cv{static async createPublicClientApplication(e){const t=await async function(e){const t=new rg(e);return await t.initialize(),uv.createController(t,void 0)}(e);return new Cv(e,t)}constructor(e,t){this.isBroker=!1,this.controller=t||new uv(new rg(e))}async initialize(e){return this.controller.initialize(e,this.isBroker)}async acquireTokenPopup(e){return this.controller.acquireTokenPopup(e)}acquireTokenRedirect(e){return this.controller.acquireTokenRedirect(e)}acquireTokenSilent(e){return this.controller.acquireTokenSilent(e)}acquireTokenByCode(e){return this.controller.acquireTokenByCode(e)}addEventCallback(e,t){return this.controller.addEventCallback(e,t)}removeEventCallback(e){return this.controller.removeEventCallback(e)}addPerformanceCallback(e){return this.controller.addPerformanceCallback(e)}removePerformanceCallback(e){return this.controller.removePerformanceCallback(e)}enableAccountStorageEvents(){this.controller.enableAccountStorageEvents()}disableAccountStorageEvents(){this.controller.disableAccountStorageEvents()}getAccount(e){return this.controller.getAccount(e)}getAccountByHomeId(e){return this.controller.getAccountByHomeId(e)}getAccountByLocalId(e){return this.controller.getAccountByLocalId(e)}getAccountByUsername(e){return this.controller.getAccountByUsername(e)}getAllAccounts(e){return this.controller.getAllAccounts(e)}handleRedirectPromise(e){return this.controller.handleRedirectPromise(e)}loginPopup(e){return this.controller.loginPopup(e)}loginRedirect(e){return this.controller.loginRedirect(e)}logout(e){return this.controller.logout(e)}logoutRedirect(e){return this.controller.logoutRedirect(e)}logoutPopup(e){return this.controller.logoutPopup(e)}ssoSilent(e){return this.controller.ssoSilent(e)}getTokenCache(){return this.controller.getTokenCache()}getLogger(){return this.controller.getLogger()}setLogger(e){this.controller.setLogger(e)}setActiveAccount(e){this.controller.setActiveAccount(e)}getActiveAccount(){return this.controller.getActiveAccount()}initializeWrapperLibrary(e,t){return this.controller.initializeWrapperLibrary(e,t)}setNavigationClient(e){this.controller.setNavigationClient(e)}getConfiguration(){return this.controller.getConfiguration()}async hydrateCache(e,t){return this.controller.hydrateCache(e,t)}clearCache(e){return this.controller.clearCache(e)}}async function Av(e){const t=new wv(e);if(await t.initialize(),t.isAvailable()){const r=new yv(t),n=new Cv(e,r);return await n.initialize(),n}return async function(e){const t=new Cv(e);return await t.initialize(),t}(e)}var kv,Sv=function(e){return"".concat(window.location.origin,"/").concat(e)},Tv={auth:{clientId:"043652b6-bdb4-479c-a426-d2050f781fd2",redirectUri:(kv=window.location.origin,kv.includes("localhost")||kv.includes("127.0.0.1")?Sv("auth.html"):kv.includes("codewithabubakr.github.io")?"brk-multihub://codewithabubakr.github.io/This-is-a-Phish/auth.html":Sv("auth.html")),postLogoutRedirectUri:function(){var e=window.location.origin;return e.includes("localhost")||e.includes("127.0.0.1")?Sv("auth.html"):e.includes("codewithabubakr.github.io")?"brk-multihub://codewithabubakr.github.io/This-is-a-Phish/auth.html":Sv("auth.html")}()},cache:{cacheLocation:"localStorage"},system:{loggerOptions:{logLevel:fc.Verbose,loggerCallback:function(e,t){switch(e){case fc.Error:return void console.error(t);case fc.Info:return void console.info(t);case fc.Verbose:return void console.debug(t);case fc.Warning:return void console.warn(t)}},piiLoggingEnabled:!0}}},Iv=(r(64583).Promise,function(){return Iv=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Iv.apply(this,arguments)}),Ev=function(e,t,r){var n={};return t&&(n={prompt:"select_account"}),r&&(n.redirectUri=r),Iv({scopes:e},n)},xv=r(64583).Promise,_v=function(e,t,r,n){return new(r||(r=xv))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},Pv=function(e,t){var r,n,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,n=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Rv=function(e){var t=window.location.origin;return t.includes("localhost")||t.includes("127.0.0.1")?Sv(e):t.includes("codewithabubakr.github.io")?"brk-multihub://codewithabubakr.github.io/This-is-a-Phish/".concat(e):Sv(e)},Ov=function(){function e(){this.pca=void 0,this._dialogApiResult=null,this._usingFallbackDialog=!1}return e.prototype.getSignOutButton=function(){return document.getElementById("signOutButton")},e.prototype.setSignOutButtonVisibility=function(e){var t=this.getSignOutButton();t&&(t.style.visibility=e?"visible":"hidden")},e.prototype.isNestedAppAuthSupported=function(){return Office.context.requirements.isSetSupported("NestedAppAuth","1.1")},e.prototype.initialize=function(){return _v(this,void 0,void 0,(function(){var e,t,r=this;return Pv(this,(function(n){switch(n.label){case 0:return[4,Office.onReady()];case 1:return n.sent(),e=this,[4,Av(Tv)];case 2:return e.pca=n.sent(),!this.isNestedAppAuthSupported()&&this.pca.getActiveAccount()&&this.setSignOutButtonVisibility(!0),null===(t=this.getSignOutButton())||void 0===t||t.addEventListener("click",(function(){return r.signOut()})),[2]}}))}))},e.prototype.signOut=function(){return _v(this,void 0,void 0,(function(){var e;return Pv(this,(function(t){switch(t.label){case 0:return this._usingFallbackDialog?[4,this.signOutWithDialogApi()]:[3,2];case 1:return t.sent(),[3,4];case 2:return[4,null===(e=this.pca)||void 0===e?void 0:e.logoutPopup()];case 3:t.sent(),t.label=4;case 4:return this.setSignOutButtonVisibility(!1),[2]}}))}))},e.prototype.ssoGetAccessToken=function(e){return _v(this,void 0,void 0,(function(){var t,r,n,o;return Pv(this,(function(i){switch(i.label){case 0:if(this._dialogApiResult)return[2,this._dialogApiResult];if(void 0===this.pca)throw new Error("AccountManager is not initialized!");i.label=1;case 1:return i.trys.push([1,3,,4]),console.log("Trying to acquire token silently..."),[4,this.pca.acquireTokenSilent(Ev(e,!1))];case 2:return n=i.sent(),console.log("Acquired token silently."),[2,n.accessToken];case 3:return t=i.sent(),console.warn("Unable to acquire token silently: ".concat(t)),[3,4];case 4:return i.trys.push([4,6,,10]),console.log("Trying to acquire token interactively..."),r=!this.pca.getActiveAccount(),[4,this.pca.acquireTokenPopup(Ev(e,r))];case 5:return n=i.sent(),console.log("Acquired token interactively."),r&&this.pca.setActiveAccount(n.account),this.isNestedAppAuthSupported()||this.setSignOutButtonVisibility(!0),[2,n.accessToken];case 6:return(o=i.sent())instanceof af&&"popup_window_error"===o.errorCode?[4,this.getTokenWithDialogApi()]:[3,8];case 7:return[2,i.sent()];case 8:throw console.error("Unable to acquire token interactively: ".concat(o)),new Error("Unable to acquire access token: ".concat(o));case 9:return[3,10];case 10:return[2]}}))}))},e.prototype.getTokenWithDialogApi=function(){return _v(this,void 0,void 0,(function(){var e=this;return Pv(this,(function(t){return this._dialogApiResult=new xv((function(t,r){Office.context.ui.displayDialogAsync(Rv("dialog.html"),{height:60,width:30},(function(n){n.value.addEventHandler(Office.EventType.DialogEventReceived,(function(t){12006==t.error&&(e._dialogApiResult=null,r("Dialog closed"))})),n.value.addEventHandler(Office.EventType.DialogMessageReceived,(function(o){var i=o,a=JSON.parse(i.message);n.value.close(),a.error?(r(a.error),e._dialogApiResult=null):(t(a.accessToken),e.setSignOutButtonVisibility(!0),e._usingFallbackDialog=!0)}))}))})),[2,this._dialogApiResult]}))}))},e.prototype.signOutWithDialogApi=function(){var e=this;return new xv((function(t){Office.context.ui.displayDialogAsync(Rv("dialog.html?logout=1"),{height:60,width:30},(function(r){r.value.addEventHandler(Office.EventType.DialogMessageReceived,(function(){e.setSignOutButtonVisibility(!1),e._dialogApiResult=null,t(),r.value.close()}))}))}))},e}(),Mv=r(64583).Promise,Nv=function(){return Nv=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Nv.apply(this,arguments)},Bv=function(e,t,r){for(var n=[],o=3;o<arguments.length;o++)n[o-3]=arguments[o];return i=void 0,a=function(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))}([e,t,r],n,!0),c=function(e,t,r,n,o){var i,a,s,c;return void 0===n&&(n="GET"),function(e,t){var r,n,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,n=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}}(this,(function(l){switch(l.label){case 0:if(!t)throw new Error("path is required.");if(!t.startsWith("/"))throw new Error("path must start with '/'.");if(r&&!r.startsWith("?"))throw new Error("queryParams must start with '?'.");return i=Nv({method:n,headers:Nv({Authorization:e},"GET"!==n&&{"Content-Type":"application/json"})},"GET"!==n&&o?{body:JSON.stringify(o)}:{}),[4,fetch("https://graph.microsoft.com/v1.0".concat(t).concat(r),i)];case 1:return(a=l.sent()).ok?(s=a.headers.get("content-type"))&&-1!==s.indexOf("application/json")?[4,a.json()]:[3,3]:[3,5];case 2:return c=l.sent(),console.log(c),[2,c];case 3:return[2,!0];case 4:return[3,6];case 5:throw new Error(a.statusText);case 6:return[2]}}))},new((s=void 0)||(s=Mv))((function(e,t){function r(e){try{o(c.next(e))}catch(e){t(e)}}function n(e){try{o(c.throw(e))}catch(e){t(e)}}function o(t){var o;t.done?e(t.value):(o=t.value,o instanceof s?o:new s((function(e){e(o)}))).then(r,n)}o((c=c.apply(i,a||[])).next())}));var i,a,s,c},Lv=r(64583).Promise,qv=new Ov,Hv=function(e){return t=void 0,r=void 0,o=function(){var t,r;return function(e,t){var r,n,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,n=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}}(this,(function(n){switch(n.label){case 0:return n.trys.push([0,4,,5]),[4,qv.initialize()];case 1:return n.sent(),[4,qv.ssoGetAccessToken(["Mail.ReadWrite"])];case 2:return t=n.sent(),[4,Bv(t,"/me/messages/".concat(e),"","DELETE")];case 3:return n.sent(),console.log("Email with ID ".concat(e," deleted successfully.")),[3,5];case 4:return r=n.sent(),console.error("Failed to delete email:",r),[3,5];case 5:return[2]}}))},new((n=void 0)||(n=Lv))((function(e,i){function a(e){try{c(o.next(e))}catch(e){i(e)}}function s(e){try{c(o.throw(e))}catch(e){i(e)}}function c(t){var r;t.done?e(t.value):(r=t.value,r instanceof n?r:new n((function(e){e(r)}))).then(a,s)}c((o=o.apply(t,r||[])).next())}));var t,r,n,o},$v=r(64583).Promise,Dv=function(){return Dv=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Dv.apply(this,arguments)},Fv=function(e,t,r,n){return new(r||(r=$v))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},Uv=function(e,t){var r,n,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,n=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},jv=function(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))},zv=function(){var e=V(),t=window.Office.context.mailbox.item,r=window.Office.context.mailbox.item.dateTimeCreated,o=new Date(r).toLocaleString("en-US",{month:"numeric",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",second:"2-digit",hour12:!0});(0,n.useEffect)((function(){var e=window.Office.context.mailbox.userProfile.emailAddress,t=e.substring(e.lastIndexOf("@")+1);console.log(t)}),[]);var i=function(e){return Fv(void 0,void 0,void 0,(function(){var t,r,n;return Uv(this,(function(o){if(!e)return[2,{campaignId:null,templateId:null,userId:null}];try{return t=e.match(/X-PHISHBAIT4:\s*(\d+)/i),r=e.match(/X-PHISHBAIT2:\s*(\d+)/i),n=e.match(/X-PHISHBAIT3:\s*(\d+)/i),[2,{campaignId:t&&t[1]?t[1]:null,templateId:r&&r[1]?r[1]:null,userId:n&&n[1]?n[1]:null}]}catch(e){return[2,{campaignId:null,templateId:null,userId:null}]}}))}))},a=function(e){return Fv(void 0,void 0,void 0,(function(){var t,r;return Uv(this,(function(n){switch(n.label){case 0:n.label=1;case 1:return n.trys.push([1,6,,7]),t=null,"function"!=typeof e.getAllInternetHeadersAsync?[3,3]:[4,new $v((function(t){return e.getAllInternetHeadersAsync(t)}))];case 2:(r=n.sent()).status===Office.AsyncResultStatus.Succeeded&&r.value&&(t=r.value),n.label=3;case 3:return t||"function"!=typeof e.getHeadersAsync?[3,5]:[4,new $v((function(t){return e.getHeadersAsync(t)}))];case 4:(r=n.sent()).status===Office.AsyncResultStatus.Succeeded&&r.value&&(t=r.value),n.label=5;case 5:return t||(t=e.headers||null),[2,t];case 6:return n.sent(),[2,null];case 7:return[2]}}))}))};window.headerExtractor={extractPhishBaitValues:i,getEmailHeaders:a};var s=function(e){return Fv(void 0,void 0,void 0,(function(){var t,r;return Uv(this,(function(n){switch(n.label){case 0:return n.trys.push([0,3,,4]),[4,fetch("https://baitandphish.com/API/getConfigByDomain.php?domain=".concat(encodeURIComponent(e)))];case 1:if(!(t=n.sent()).ok)throw new Error("Failed to fetch config");return[4,t.json()];case 2:if(!(r=n.sent()).success||!r.config)throw new Error("Invalid config format");return[2,Dv(Dv(Dv({},ms),r.config),{OtherPhishingTargetEmails:r.config.OtherPhishingTargetEmails||"security@".concat(e)})];case 3:return n.sent(),[2,Dv(Dv({},ms),{OtherPhishingTargetEmails:"security@".concat(e)})];case 4:return[2]}}))}))},c=function(e,t,r,n){return Fv(void 0,void 0,void 0,(function(){var o,a,s,c,l,d;return Uv(this,(function(h){switch(h.label){case 0:return h.trys.push([0,4,,6]),[4,i(n||"")];case 1:return o=h.sent(),console.log("Extracted PhishBait values for report:",o),a={companyId:r.companyId,employeeId:t,emailId:e.itemId||"",subject:e.subject||"",sender:(null===(d=e.sender)||void 0===d?void 0:d.emailAddress)||"",campaignId:(null==o?void 0:o.campaignId)||null,templateId:(null==o?void 0:o.templateId)||null,userId:(null==o?void 0:o.userId)||null},[4,fetch("https://baitandphish.com/API/phishReport.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})];case 2:if(!(s=h.sent()).ok)throw new Error("Server error");return s.ok&&Hs.success("Great job! You correctly identified a simulated phishing email."),[4,s.json()];case 3:if(!(c=h.sent()).success)throw new Error(c.message||"Server returned error");return[3,6];case 4:return l=h.sent(),Hs.error(l),[4,u(e,t,r,!1)];case 5:return h.sent(),[3,6];case 6:return[2]}}))}))},l=function(e,t,r,n,o){for(var i=[],a=5;a<arguments.length;a++)i[a-5]=arguments[a];return Fv(void 0,jv([e,t,r,n,o],i,!0),void 0,(function(e,t,r,n,o,i){return void 0===i&&(i=!1),Uv(this,(function(a){return[2,new $v((function(a,s){try{var c=function(e,t){var r=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"),n='\n        <div style="background-color: #fff4ce; border-left: 4px solid #ffd700; padding: 10px; margin-bottom: 20px;">\n            <p style="margin: 0; font-weight: bold; color: #7a6400;">IMPORTANT: Please click send on this message</p>\n            <p style="margin: 10px 0 0 0; color: #7a6400;">\n                The correct emails to send phishing reports to have been automatically added for you. \n                The original email has also automatically been attached and we have included the email headers below for analysis. \n                Thank you.\n            </p>\n        </div>\n        <div style="margin-bottom: 20px; white-space: pre-wrap; word-wrap: break-word;">\n            '.concat(r.replace(/\n/g,"<br>"),"\n        </div>\n    ");if(t){var o=t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;");n+='\n            <div style="background-color: #f5f5f5; border: 1px solid #ddd; padding: 10px; margin-top: 20px;">\n                <p style="margin: 0 0 10px 0; font-weight: bold; color: #333;">Email Headers (For Analysis):</p>\n                <pre style="margin: 0; white-space: pre-wrap; word-wrap: break-word; font-family: monospace; font-size: 12px; color: #666;">'.concat(o,"</pre>\n            </div>\n        ")}return n}(n,o),l={toRecipients:t,subject:r,htmlBody:c};if(e.itemId&&(l.attachments=[{type:Office.MailboxEnums.AttachmentType.Item,name:"Original Email.msg",itemId:e.itemId}]),!i&&Office.MailboxEnums&&Office.MailboxEnums.DisplayMode)try{l.displayMode=Office.MailboxEnums.DisplayMode.NewWindow}catch(e){console.warn("Could not set display mode:",e)}try{window.Office.context.mailbox.displayNewMessageForm(l,(function(e){e.status===Office.AsyncResultStatus.Succeeded?a(e):e.error&&"SecurityError"===e.error.name&&l.attachments?(delete l.attachments,window.Office.context.mailbox.displayNewMessageForm(l,(function(e){e.status===Office.AsyncResultStatus.Succeeded?a(e):s(new Error("Failed to create email without attachment: ".concat(e.error.message)))}))):s(new Error("Failed to create new email: ".concat(e.error.message)))}))}catch(e){if(console.error("Error displaying new message form:",e),"SecurityError"===e.name&&l.attachments){delete l.attachments;try{window.Office.context.mailbox.displayNewMessageForm(l,(function(e){e.status===Office.AsyncResultStatus.Succeeded?a(e):s(new Error("Failed to create email without attachment: ".concat(e.error.message)))}))}catch(e){s(new Error("Failed to create email: ".concat(e.message)))}}else s(e)}}catch(e){console.error("Error in createNewEmailWithAttachment:",e),s(e)}}))]}))}))},u=function(e,t,r,n){for(var o=[],i=4;i<arguments.length;i++)o[i-4]=arguments[i];return Fv(void 0,jv([e,t,r,n],o,!0),void 0,(function(e,t,r,n,o){var i,s,u,d,h,p,f,g,m;return void 0===o&&(o=!1),Uv(this,(function(y){switch(y.label){case 0:return y.trys.push([0,11,,12]),[4,a(e)];case 1:return i=y.sent(),console.log("Headers in handleEmailForwarding:",i),s=r.OtherPhishingTargetEmails.split(",").map((function(e){return e.trim()})),n?[4,c(e,t,r,i)]:[3,3];case 2:return y.sent(),Hs.success("Phishing simulation reported successfully"),[3,5];case 3:return u=r.OtherPhishingSubject.replace("{subject}",e.subject||""),d=r.OtherPhishingBody.replace("{userEmail}",t).replace("{date}",(new Date).toLocaleString()).replace("{subject}",e.subject||"").replace("{sender}",(null===(m=e.sender)||void 0===m?void 0:m.emailAddress)||""),[4,l(e,s,u,d,i,o)];case 4:y.sent(),Hs.success("Phishing email reported to security team"),y.label=5;case 5:if(y.trys.push([5,9,,10]),!e.itemId)throw new Error("No email selected to delete.");return h=window.Office.context.mailbox.convertToRestId(e.itemId,Office.MailboxEnums.RestVersion.v2_0),(p=h)?[4,Hv(p)]:[3,7];case 6:return y.sent(),[3,8];case 7:console.error("No message ID found for the current item."),y.label=8;case 8:return[3,10];case 9:return f=y.sent(),console.error("Error deleting email:",f),Hs.error("Could not delete the email. Please delete it manually."),[3,10];case 10:return[3,12];case 11:return g=y.sent(),console.error("Error in handleEmailForwarding:",g),Hs.error("Could not process the phishing report. Please try again or contact your IT department."),[3,12];case 12:return[2]}}))}))};return n.createElement(n.Fragment,null,n.createElement(ki,{sx:{backgroundColor:"#f5f5f5",padding:"8px",borderRadius:2,maxWidth:600}},n.createElement(Gi,{sx:{paddingLeft:"2px",paddingRight:"8px"}},n.createElement(Qi,null,n.createElement(oa,{sx:{fontWeight:"bold",fontSize:"20px",padding:"6px 0"},color:"primary"},gs.title),n.createElement(oa,{variant:"body1",paragraph:!0},gs.description),n.createElement(ki,{sx:{borderLeft:"4px solid #2196f3",pl:2,my:2,borderRadius:"4px"}},n.createElement(oa,{variant:"body2"},n.createElement("strong",null,gs.from)," ",t.from.emailAddress),n.createElement(oa,{variant:"body2"},n.createElement("strong",null,gs.subject)," ",t.subject),n.createElement(oa,{variant:"body2"},n.createElement("strong",null,gs.received)," ",o)),n.createElement(oa,{variant:"body1",paragraph:!0},gs.report_email),n.createElement(fs,{variant:"contained",color:"primary",fullWidth:!0,onClick:function(){return Fv(void 0,void 0,void 0,(function(){return Uv(this,(function(t){switch(t.label){case 0:return console.log("Report as Phishing"),e("/phishing"),[4,Fv(void 0,void 0,void 0,(function(){var e,t,r,n,o,i,l,d;return Uv(this,(function(h){switch(h.label){case 0:if(!(e=window.Office.context.mailbox.item))return Hs.error("Cannot access email information"),[2];h.label=1;case 1:return h.trys.push([1,8,,9]),t=window.Office.context.mailbox.userProfile.emailAddress,r=t.substring(t.lastIndexOf("@")+1),[4,s(r)];case 2:return n=h.sent(),o="OutlookWebApp"===window.Office.context.mailbox.diagnostics.hostName,[4,a(e)];case 3:return i=h.sent(),l=null==i?void 0:i.includes("X-PHISHBAIT"),console.log("isSimulation",l),l?[4,c(e,t,n,i)]:[3,5];case 4:return h.sent(),[3,7];case 5:return[4,u(e,t,n,!1,o)];case 6:h.sent(),h.label=7;case 7:return[3,9];case 8:return d=h.sent(),Hs.error(d),[3,9];case 9:return[2]}}))}))];case 1:return t.sent(),[2]}}))}))},sx:{textTransform:"capitalize"}},gs.button)))))};const Kv=n.createContext(),Wv=()=>n.useContext(Kv)??!1;function Gv(e){return parseInt(n.version,10)>=19?e?.props?.ref||null:e?.ref||null}var Vv=r(40961),Yv="unmounted",Qv="exited",Jv="entering",Xv="entered",Zv="exiting",eb=function(e){function t(t,r){var n;n=e.call(this,t,r)||this;var o,i=r&&!r.isMounting?t.enter:t.appear;return n.appearStatus=null,t.in?i?(o=Qv,n.appearStatus=Jv):o=Xv:o=t.unmountOnExit||t.mountOnEnter?Yv:Qv,n.state={status:o},n.nextCallback=null,n}ba(t,e),t.getDerivedStateFromProps=function(e,t){return e.in&&t.status===Yv?{status:Qv}:null};var r=t.prototype;return r.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},r.componentDidUpdate=function(e){var t=null;if(e!==this.props){var r=this.state.status;this.props.in?r!==Jv&&r!==Xv&&(t=Jv):r!==Jv&&r!==Xv||(t=Zv)}this.updateStatus(!1,t)},r.componentWillUnmount=function(){this.cancelNextCallback()},r.getTimeouts=function(){var e,t,r,n=this.props.timeout;return e=t=r=n,null!=n&&"number"!=typeof n&&(e=n.exit,t=n.enter,r=void 0!==n.appear?n.appear:t),{exit:e,enter:t,appear:r}},r.updateStatus=function(e,t){if(void 0===e&&(e=!1),null!==t)if(this.cancelNextCallback(),t===Jv){if(this.props.unmountOnExit||this.props.mountOnEnter){var r=this.props.nodeRef?this.props.nodeRef.current:Vv.findDOMNode(this);r&&function(e){e.scrollTop}(r)}this.performEnter(e)}else this.performExit();else this.props.unmountOnExit&&this.state.status===Qv&&this.setState({status:Yv})},r.performEnter=function(e){var t=this,r=this.props.enter,n=this.context?this.context.isMounting:e,o=this.props.nodeRef?[n]:[Vv.findDOMNode(this),n],i=o[0],a=o[1],s=this.getTimeouts(),c=n?s.appear:s.enter;e||r?(this.props.onEnter(i,a),this.safeSetState({status:Jv},(function(){t.props.onEntering(i,a),t.onTransitionEnd(c,(function(){t.safeSetState({status:Xv},(function(){t.props.onEntered(i,a)}))}))}))):this.safeSetState({status:Xv},(function(){t.props.onEntered(i)}))},r.performExit=function(){var e=this,t=this.props.exit,r=this.getTimeouts(),n=this.props.nodeRef?void 0:Vv.findDOMNode(this);t?(this.props.onExit(n),this.safeSetState({status:Zv},(function(){e.props.onExiting(n),e.onTransitionEnd(r.exit,(function(){e.safeSetState({status:Qv},(function(){e.props.onExited(n)}))}))}))):this.safeSetState({status:Qv},(function(){e.props.onExited(n)}))},r.cancelNextCallback=function(){null!==this.nextCallback&&(this.nextCallback.cancel(),this.nextCallback=null)},r.safeSetState=function(e,t){t=this.setNextCallback(t),this.setState(e,t)},r.setNextCallback=function(e){var t=this,r=!0;return this.nextCallback=function(n){r&&(r=!1,t.nextCallback=null,e(n))},this.nextCallback.cancel=function(){r=!1},this.nextCallback},r.onTransitionEnd=function(e,t){this.setNextCallback(t);var r=this.props.nodeRef?this.props.nodeRef.current:Vv.findDOMNode(this),n=null==e&&!this.props.addEndListener;if(r&&!n){if(this.props.addEndListener){var o=this.props.nodeRef?[this.nextCallback]:[r,this.nextCallback],i=o[0],a=o[1];this.props.addEndListener(i,a)}null!=e&&setTimeout(this.nextCallback,e)}else setTimeout(this.nextCallback,0)},r.render=function(){var e=this.state.status;if(e===Yv)return null;var t=this.props,r=t.children,o=(t.in,t.mountOnEnter,t.unmountOnExit,t.appear,t.enter,t.exit,t.timeout,t.addEndListener,t.onEnter,t.onEntering,t.onEntered,t.onExit,t.onExiting,t.onExited,t.nodeRef,ya(t,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]));return n.createElement(wa.Provider,{value:null},"function"==typeof r?r(e,o):n.cloneElement(n.Children.only(r),o))},t}(n.Component);function tb(){}eb.contextType=wa,eb.propTypes={},eb.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:tb,onEntering:tb,onEntered:tb,onExit:tb,onExiting:tb,onExited:tb},eb.UNMOUNTED=Yv,eb.EXITED=Qv,eb.ENTERING=Jv,eb.ENTERED=Xv,eb.EXITING=Zv;var rb=eb;function nb(e,t){const{timeout:r,easing:n,style:o={}}=e;return{duration:o.transitionDuration??("number"==typeof r?r:r[t.mode]||0),easing:o.transitionTimingFunction??("object"==typeof n?n[t.mode]:n),delay:o.transitionDelay}}function ob(e){return`scale(${e}, ${e**2})`}const ib={entering:{opacity:1,transform:ob(1)},entered:{opacity:1,transform:"none"}},ab="undefined"!=typeof navigator&&/^((?!chrome|android).)*(safari|mobile)/i.test(navigator.userAgent)&&/(os |version\/)15(.|_)4/i.test(navigator.userAgent),sb=n.forwardRef((function(e,t){const{addEndListener:r,appear:o=!0,children:i,easing:a,in:s,onEnter:c,onEntered:l,onEntering:u,onExit:d,onExited:h,onExiting:p,style:f,timeout:g="auto",TransitionComponent:m=rb,...y}=e,v=_a(),b=n.useRef(),w=$i(),C=n.useRef(null),A=ua(C,Gv(i),t),k=e=>t=>{if(e){const r=C.current;void 0===t?e(r):e(r,t)}},S=k(u),T=k(((e,t)=>{(e=>{e.scrollTop})(e);const{duration:r,delay:n,easing:o}=nb({style:f,timeout:g,easing:a},{mode:"enter"});let i;"auto"===g?(i=w.transitions.getAutoHeightDuration(e.clientHeight),b.current=i):i=r,e.style.transition=[w.transitions.create("opacity",{duration:i,delay:n}),w.transitions.create("transform",{duration:ab?i:.666*i,delay:n,easing:o})].join(","),c&&c(e,t)})),I=k(l),E=k(p),x=k((e=>{const{duration:t,delay:r,easing:n}=nb({style:f,timeout:g,easing:a},{mode:"exit"});let o;"auto"===g?(o=w.transitions.getAutoHeightDuration(e.clientHeight),b.current=o):o=t,e.style.transition=[w.transitions.create("opacity",{duration:o,delay:r}),w.transitions.create("transform",{duration:ab?o:.666*o,delay:ab?r:r||.333*o,easing:n})].join(","),e.style.opacity=0,e.style.transform=ob(.75),d&&d(e)})),_=k(h);return(0,Bn.jsx)(m,{appear:o,in:s,nodeRef:C,onEnter:T,onEntered:I,onEntering:S,onExit:x,onExited:_,onExiting:E,addEndListener:e=>{"auto"===g&&v.start(b.current||0,e),r&&r(C.current,e)},timeout:"auto"===g?null:g,...y,children:(e,{ownerState:t,...r})=>n.cloneElement(i,{style:{opacity:0,transform:ob(.75),visibility:"exited"!==e||s?void 0:"hidden",...ib[e],...f,...i.props.style},ref:A,...r})})}));sb&&(sb.muiSupportAuto=!0);var cb=sb;function lb(e){return e&&e.ownerDocument||document}function ub(e){if(null==e)return window;if("[object Window]"!==e.toString()){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function db(e){return e instanceof ub(e).Element||e instanceof Element}function hb(e){return e instanceof ub(e).HTMLElement||e instanceof HTMLElement}function pb(e){return"undefined"!=typeof ShadowRoot&&(e instanceof ub(e).ShadowRoot||e instanceof ShadowRoot)}var fb=Math.max,gb=Math.min,mb=Math.round;function yb(){var e=navigator.userAgentData;return null!=e&&e.brands&&Array.isArray(e.brands)?e.brands.map((function(e){return e.brand+"/"+e.version})).join(" "):navigator.userAgent}function vb(){return!/^((?!chrome|android).)*safari/i.test(yb())}function bb(e,t,r){void 0===t&&(t=!1),void 0===r&&(r=!1);var n=e.getBoundingClientRect(),o=1,i=1;t&&hb(e)&&(o=e.offsetWidth>0&&mb(n.width)/e.offsetWidth||1,i=e.offsetHeight>0&&mb(n.height)/e.offsetHeight||1);var a=(db(e)?ub(e):window).visualViewport,s=!vb()&&r,c=(n.left+(s&&a?a.offsetLeft:0))/o,l=(n.top+(s&&a?a.offsetTop:0))/i,u=n.width/o,d=n.height/i;return{width:u,height:d,top:l,right:c+u,bottom:l+d,left:c,x:c,y:l}}function wb(e){var t=ub(e);return{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function Cb(e){return e?(e.nodeName||"").toLowerCase():null}function Ab(e){return((db(e)?e.ownerDocument:e.document)||window.document).documentElement}function kb(e){return bb(Ab(e)).left+wb(e).scrollLeft}function Sb(e){return ub(e).getComputedStyle(e)}function Tb(e){var t=Sb(e),r=t.overflow,n=t.overflowX,o=t.overflowY;return/auto|scroll|overlay|hidden/.test(r+o+n)}function Ib(e,t,r){void 0===r&&(r=!1);var n=hb(t),o=hb(t)&&function(e){var t=e.getBoundingClientRect(),r=mb(t.width)/e.offsetWidth||1,n=mb(t.height)/e.offsetHeight||1;return 1!==r||1!==n}(t),i=Ab(t),a=bb(e,o,r),s={scrollLeft:0,scrollTop:0},c={x:0,y:0};return(n||!n&&!r)&&(("body"!==Cb(t)||Tb(i))&&(s=function(e){return e!==ub(e)&&hb(e)?{scrollLeft:(t=e).scrollLeft,scrollTop:t.scrollTop}:wb(e);var t}(t)),hb(t)?((c=bb(t,!0)).x+=t.clientLeft,c.y+=t.clientTop):i&&(c.x=kb(i))),{x:a.left+s.scrollLeft-c.x,y:a.top+s.scrollTop-c.y,width:a.width,height:a.height}}function Eb(e){var t=bb(e),r=e.offsetWidth,n=e.offsetHeight;return Math.abs(t.width-r)<=1&&(r=t.width),Math.abs(t.height-n)<=1&&(n=t.height),{x:e.offsetLeft,y:e.offsetTop,width:r,height:n}}function xb(e){return"html"===Cb(e)?e:e.assignedSlot||e.parentNode||(pb(e)?e.host:null)||Ab(e)}function _b(e){return["html","body","#document"].indexOf(Cb(e))>=0?e.ownerDocument.body:hb(e)&&Tb(e)?e:_b(xb(e))}function Pb(e,t){var r;void 0===t&&(t=[]);var n=_b(e),o=n===(null==(r=e.ownerDocument)?void 0:r.body),i=ub(n),a=o?[i].concat(i.visualViewport||[],Tb(n)?n:[]):n,s=t.concat(a);return o?s:s.concat(Pb(xb(a)))}function Rb(e){return["table","td","th"].indexOf(Cb(e))>=0}function Ob(e){return hb(e)&&"fixed"!==Sb(e).position?e.offsetParent:null}function Mb(e){for(var t=ub(e),r=Ob(e);r&&Rb(r)&&"static"===Sb(r).position;)r=Ob(r);return r&&("html"===Cb(r)||"body"===Cb(r)&&"static"===Sb(r).position)?t:r||function(e){var t=/firefox/i.test(yb());if(/Trident/i.test(yb())&&hb(e)&&"fixed"===Sb(e).position)return null;var r=xb(e);for(pb(r)&&(r=r.host);hb(r)&&["html","body"].indexOf(Cb(r))<0;){var n=Sb(r);if("none"!==n.transform||"none"!==n.perspective||"paint"===n.contain||-1!==["transform","perspective"].indexOf(n.willChange)||t&&"filter"===n.willChange||t&&n.filter&&"none"!==n.filter)return r;r=r.parentNode}return null}(e)||t}var Nb="top",Bb="bottom",Lb="right",qb="left",Hb="auto",$b=[Nb,Bb,Lb,qb],Db="start",Fb="end",Ub="viewport",jb="popper",zb=$b.reduce((function(e,t){return e.concat([t+"-"+Db,t+"-"+Fb])}),[]),Kb=[].concat($b,[Hb]).reduce((function(e,t){return e.concat([t,t+"-"+Db,t+"-"+Fb])}),[]),Wb=["beforeRead","read","afterRead","beforeMain","main","afterMain","beforeWrite","write","afterWrite"];function Gb(e){var t=new Map,r=new Set,n=[];function o(e){r.add(e.name),[].concat(e.requires||[],e.requiresIfExists||[]).forEach((function(e){if(!r.has(e)){var n=t.get(e);n&&o(n)}})),n.push(e)}return e.forEach((function(e){t.set(e.name,e)})),e.forEach((function(e){r.has(e.name)||o(e)})),n}var Vb=r(64583).Promise,Yb=r(64583).Promise,Qb={placement:"bottom",modifiers:[],strategy:"absolute"};function Jb(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return!t.some((function(e){return!(e&&"function"==typeof e.getBoundingClientRect)}))}function Xb(e){void 0===e&&(e={});var t=e,r=t.defaultModifiers,n=void 0===r?[]:r,o=t.defaultOptions,i=void 0===o?Qb:o;return function(e,t,r){void 0===r&&(r=i);var o,a,s={placement:"bottom",orderedModifiers:[],options:Object.assign({},Qb,i),modifiersData:{},elements:{reference:e,popper:t},attributes:{},styles:{}},c=[],l=!1,u={state:s,setOptions:function(r){var o="function"==typeof r?r(s.options):r;d(),s.options=Object.assign({},i,s.options,o),s.scrollParents={reference:db(e)?Pb(e):e.contextElement?Pb(e.contextElement):[],popper:Pb(t)};var a,l,h=function(e){var t=Gb(e);return Wb.reduce((function(e,r){return e.concat(t.filter((function(e){return e.phase===r})))}),[])}((a=[].concat(n,s.options.modifiers),l=a.reduce((function(e,t){var r=e[t.name];return e[t.name]=r?Object.assign({},r,t,{options:Object.assign({},r.options,t.options),data:Object.assign({},r.data,t.data)}):t,e}),{}),Object.keys(l).map((function(e){return l[e]}))));return s.orderedModifiers=h.filter((function(e){return e.enabled})),s.orderedModifiers.forEach((function(e){var t=e.name,r=e.options,n=void 0===r?{}:r,o=e.effect;if("function"==typeof o){var i=o({state:s,name:t,instance:u,options:n});c.push(i||function(){})}})),u.update()},forceUpdate:function(){if(!l){var e=s.elements,t=e.reference,r=e.popper;if(Jb(t,r)){s.rects={reference:Ib(t,Mb(r),"fixed"===s.options.strategy),popper:Eb(r)},s.reset=!1,s.placement=s.options.placement,s.orderedModifiers.forEach((function(e){return s.modifiersData[e.name]=Object.assign({},e.data)}));for(var n=0;n<s.orderedModifiers.length;n++)if(!0!==s.reset){var o=s.orderedModifiers[n],i=o.fn,a=o.options,c=void 0===a?{}:a,d=o.name;"function"==typeof i&&(s=i({state:s,options:c,name:d,instance:u})||s)}else s.reset=!1,n=-1}}},update:(o=function(){return new Yb((function(e){u.forceUpdate(),e(s)}))},function(){return a||(a=new Vb((function(e){Vb.resolve().then((function(){a=void 0,e(o())}))}))),a}),destroy:function(){d(),l=!0}};if(!Jb(e,t))return u;function d(){c.forEach((function(e){return e()})),c=[]}return u.setOptions(r).then((function(e){!l&&r.onFirstUpdate&&r.onFirstUpdate(e)})),u}}var Zb={passive:!0},ew={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(e){var t=e.state,r=e.instance,n=e.options,o=n.scroll,i=void 0===o||o,a=n.resize,s=void 0===a||a,c=ub(t.elements.popper),l=[].concat(t.scrollParents.reference,t.scrollParents.popper);return i&&l.forEach((function(e){e.addEventListener("scroll",r.update,Zb)})),s&&c.addEventListener("resize",r.update,Zb),function(){i&&l.forEach((function(e){e.removeEventListener("scroll",r.update,Zb)})),s&&c.removeEventListener("resize",r.update,Zb)}},data:{}};function tw(e){return e.split("-")[0]}function rw(e){return e.split("-")[1]}function nw(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function ow(e){var t,r=e.reference,n=e.element,o=e.placement,i=o?tw(o):null,a=o?rw(o):null,s=r.x+r.width/2-n.width/2,c=r.y+r.height/2-n.height/2;switch(i){case Nb:t={x:s,y:r.y-n.height};break;case Bb:t={x:s,y:r.y+r.height};break;case Lb:t={x:r.x+r.width,y:c};break;case qb:t={x:r.x-n.width,y:c};break;default:t={x:r.x,y:r.y}}var l=i?nw(i):null;if(null!=l){var u="y"===l?"height":"width";switch(a){case Db:t[l]=t[l]-(r[u]/2-n[u]/2);break;case Fb:t[l]=t[l]+(r[u]/2-n[u]/2)}}return t}var iw={top:"auto",right:"auto",bottom:"auto",left:"auto"};function aw(e){var t,r=e.popper,n=e.popperRect,o=e.placement,i=e.variation,a=e.offsets,s=e.position,c=e.gpuAcceleration,l=e.adaptive,u=e.roundOffsets,d=e.isFixed,h=a.x,p=void 0===h?0:h,f=a.y,g=void 0===f?0:f,m="function"==typeof u?u({x:p,y:g}):{x:p,y:g};p=m.x,g=m.y;var y=a.hasOwnProperty("x"),v=a.hasOwnProperty("y"),b=qb,w=Nb,C=window;if(l){var A=Mb(r),k="clientHeight",S="clientWidth";A===ub(r)&&"static"!==Sb(A=Ab(r)).position&&"absolute"===s&&(k="scrollHeight",S="scrollWidth"),(o===Nb||(o===qb||o===Lb)&&i===Fb)&&(w=Bb,g-=(d&&A===C&&C.visualViewport?C.visualViewport.height:A[k])-n.height,g*=c?1:-1),o!==qb&&(o!==Nb&&o!==Bb||i!==Fb)||(b=Lb,p-=(d&&A===C&&C.visualViewport?C.visualViewport.width:A[S])-n.width,p*=c?1:-1)}var T,I=Object.assign({position:s},l&&iw),E=!0===u?function(e,t){var r=e.x,n=e.y,o=t.devicePixelRatio||1;return{x:mb(r*o)/o||0,y:mb(n*o)/o||0}}({x:p,y:g},ub(r)):{x:p,y:g};return p=E.x,g=E.y,c?Object.assign({},I,((T={})[w]=v?"0":"",T[b]=y?"0":"",T.transform=(C.devicePixelRatio||1)<=1?"translate("+p+"px, "+g+"px)":"translate3d("+p+"px, "+g+"px, 0)",T)):Object.assign({},I,((t={})[w]=v?g+"px":"",t[b]=y?p+"px":"",t.transform="",t))}var sw={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(e){var t=e.state,r=e.options,n=r.gpuAcceleration,o=void 0===n||n,i=r.adaptive,a=void 0===i||i,s=r.roundOffsets,c=void 0===s||s,l={placement:tw(t.placement),variation:rw(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:o,isFixed:"fixed"===t.options.strategy};null!=t.modifiersData.popperOffsets&&(t.styles.popper=Object.assign({},t.styles.popper,aw(Object.assign({},l,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:a,roundOffsets:c})))),null!=t.modifiersData.arrow&&(t.styles.arrow=Object.assign({},t.styles.arrow,aw(Object.assign({},l,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:c})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})},data:{}},cw={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(e){var t=e.state,r=e.options,n=e.name,o=r.offset,i=void 0===o?[0,0]:o,a=Kb.reduce((function(e,r){return e[r]=function(e,t,r){var n=tw(e),o=[qb,Nb].indexOf(n)>=0?-1:1,i="function"==typeof r?r(Object.assign({},t,{placement:e})):r,a=i[0],s=i[1];return a=a||0,s=(s||0)*o,[qb,Lb].indexOf(n)>=0?{x:s,y:a}:{x:a,y:s}}(r,t.rects,i),e}),{}),s=a[t.placement],c=s.x,l=s.y;null!=t.modifiersData.popperOffsets&&(t.modifiersData.popperOffsets.x+=c,t.modifiersData.popperOffsets.y+=l),t.modifiersData[n]=a}},lw={left:"right",right:"left",bottom:"top",top:"bottom"};function uw(e){return e.replace(/left|right|bottom|top/g,(function(e){return lw[e]}))}var dw={start:"end",end:"start"};function hw(e){return e.replace(/start|end/g,(function(e){return dw[e]}))}function pw(e,t){var r=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(r&&pb(r)){var n=t;do{if(n&&e.isSameNode(n))return!0;n=n.parentNode||n.host}while(n)}return!1}function fw(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function gw(e,t,r){return t===Ub?fw(function(e,t){var r=ub(e),n=Ab(e),o=r.visualViewport,i=n.clientWidth,a=n.clientHeight,s=0,c=0;if(o){i=o.width,a=o.height;var l=vb();(l||!l&&"fixed"===t)&&(s=o.offsetLeft,c=o.offsetTop)}return{width:i,height:a,x:s+kb(e),y:c}}(e,r)):db(t)?function(e,t){var r=bb(e,!1,"fixed"===t);return r.top=r.top+e.clientTop,r.left=r.left+e.clientLeft,r.bottom=r.top+e.clientHeight,r.right=r.left+e.clientWidth,r.width=e.clientWidth,r.height=e.clientHeight,r.x=r.left,r.y=r.top,r}(t,r):fw(function(e){var t,r=Ab(e),n=wb(e),o=null==(t=e.ownerDocument)?void 0:t.body,i=fb(r.scrollWidth,r.clientWidth,o?o.scrollWidth:0,o?o.clientWidth:0),a=fb(r.scrollHeight,r.clientHeight,o?o.scrollHeight:0,o?o.clientHeight:0),s=-n.scrollLeft+kb(e),c=-n.scrollTop;return"rtl"===Sb(o||r).direction&&(s+=fb(r.clientWidth,o?o.clientWidth:0)-i),{width:i,height:a,x:s,y:c}}(Ab(e)))}function mw(e){return Object.assign({},{top:0,right:0,bottom:0,left:0},e)}function yw(e,t){return t.reduce((function(t,r){return t[r]=e,t}),{})}function vw(e,t){void 0===t&&(t={});var r=t,n=r.placement,o=void 0===n?e.placement:n,i=r.strategy,a=void 0===i?e.strategy:i,s=r.boundary,c=void 0===s?"clippingParents":s,l=r.rootBoundary,u=void 0===l?Ub:l,d=r.elementContext,h=void 0===d?jb:d,p=r.altBoundary,f=void 0!==p&&p,g=r.padding,m=void 0===g?0:g,y=mw("number"!=typeof m?m:yw(m,$b)),v=h===jb?"reference":jb,b=e.rects.popper,w=e.elements[f?v:h],C=function(e,t,r,n){var o="clippingParents"===t?function(e){var t=Pb(xb(e)),r=["absolute","fixed"].indexOf(Sb(e).position)>=0&&hb(e)?Mb(e):e;return db(r)?t.filter((function(e){return db(e)&&pw(e,r)&&"body"!==Cb(e)})):[]}(e):[].concat(t),i=[].concat(o,[r]),a=i[0],s=i.reduce((function(t,r){var o=gw(e,r,n);return t.top=fb(o.top,t.top),t.right=gb(o.right,t.right),t.bottom=gb(o.bottom,t.bottom),t.left=fb(o.left,t.left),t}),gw(e,a,n));return s.width=s.right-s.left,s.height=s.bottom-s.top,s.x=s.left,s.y=s.top,s}(db(w)?w:w.contextElement||Ab(e.elements.popper),c,u,a),A=bb(e.elements.reference),k=ow({reference:A,element:b,strategy:"absolute",placement:o}),S=fw(Object.assign({},b,k)),T=h===jb?S:A,I={top:C.top-T.top+y.top,bottom:T.bottom-C.bottom+y.bottom,left:C.left-T.left+y.left,right:T.right-C.right+y.right},E=e.modifiersData.offset;if(h===jb&&E){var x=E[o];Object.keys(I).forEach((function(e){var t=[Lb,Bb].indexOf(e)>=0?1:-1,r=[Nb,Bb].indexOf(e)>=0?"y":"x";I[e]+=x[r]*t}))}return I}var bw={name:"flip",enabled:!0,phase:"main",fn:function(e){var t=e.state,r=e.options,n=e.name;if(!t.modifiersData[n]._skip){for(var o=r.mainAxis,i=void 0===o||o,a=r.altAxis,s=void 0===a||a,c=r.fallbackPlacements,l=r.padding,u=r.boundary,d=r.rootBoundary,h=r.altBoundary,p=r.flipVariations,f=void 0===p||p,g=r.allowedAutoPlacements,m=t.options.placement,y=tw(m),v=c||(y!==m&&f?function(e){if(tw(e)===Hb)return[];var t=uw(e);return[hw(e),t,hw(t)]}(m):[uw(m)]),b=[m].concat(v).reduce((function(e,r){return e.concat(tw(r)===Hb?function(e,t){void 0===t&&(t={});var r=t,n=r.placement,o=r.boundary,i=r.rootBoundary,a=r.padding,s=r.flipVariations,c=r.allowedAutoPlacements,l=void 0===c?Kb:c,u=rw(n),d=u?s?zb:zb.filter((function(e){return rw(e)===u})):$b,h=d.filter((function(e){return l.indexOf(e)>=0}));0===h.length&&(h=d);var p=h.reduce((function(t,r){return t[r]=vw(e,{placement:r,boundary:o,rootBoundary:i,padding:a})[tw(r)],t}),{});return Object.keys(p).sort((function(e,t){return p[e]-p[t]}))}(t,{placement:r,boundary:u,rootBoundary:d,padding:l,flipVariations:f,allowedAutoPlacements:g}):r)}),[]),w=t.rects.reference,C=t.rects.popper,A=new Map,k=!0,S=b[0],T=0;T<b.length;T++){var I=b[T],E=tw(I),x=rw(I)===Db,_=[Nb,Bb].indexOf(E)>=0,P=_?"width":"height",R=vw(t,{placement:I,boundary:u,rootBoundary:d,altBoundary:h,padding:l}),O=_?x?Lb:qb:x?Bb:Nb;w[P]>C[P]&&(O=uw(O));var M=uw(O),N=[];if(i&&N.push(R[E]<=0),s&&N.push(R[O]<=0,R[M]<=0),N.every((function(e){return e}))){S=I,k=!1;break}A.set(I,N)}if(k)for(var B=function(e){var t=b.find((function(t){var r=A.get(t);if(r)return r.slice(0,e).every((function(e){return e}))}));if(t)return S=t,"break"},L=f?3:1;L>0&&"break"!==B(L);L--);t.placement!==S&&(t.modifiersData[n]._skip=!0,t.placement=S,t.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}};function ww(e,t,r){return fb(e,gb(t,r))}var Cw={name:"preventOverflow",enabled:!0,phase:"main",fn:function(e){var t=e.state,r=e.options,n=e.name,o=r.mainAxis,i=void 0===o||o,a=r.altAxis,s=void 0!==a&&a,c=r.boundary,l=r.rootBoundary,u=r.altBoundary,d=r.padding,h=r.tether,p=void 0===h||h,f=r.tetherOffset,g=void 0===f?0:f,m=vw(t,{boundary:c,rootBoundary:l,padding:d,altBoundary:u}),y=tw(t.placement),v=rw(t.placement),b=!v,w=nw(y),C="x"===w?"y":"x",A=t.modifiersData.popperOffsets,k=t.rects.reference,S=t.rects.popper,T="function"==typeof g?g(Object.assign({},t.rects,{placement:t.placement})):g,I="number"==typeof T?{mainAxis:T,altAxis:T}:Object.assign({mainAxis:0,altAxis:0},T),E=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,x={x:0,y:0};if(A){if(i){var _,P="y"===w?Nb:qb,R="y"===w?Bb:Lb,O="y"===w?"height":"width",M=A[w],N=M+m[P],B=M-m[R],L=p?-S[O]/2:0,q=v===Db?k[O]:S[O],H=v===Db?-S[O]:-k[O],$=t.elements.arrow,D=p&&$?Eb($):{width:0,height:0},F=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},U=F[P],j=F[R],z=ww(0,k[O],D[O]),K=b?k[O]/2-L-z-U-I.mainAxis:q-z-U-I.mainAxis,W=b?-k[O]/2+L+z+j+I.mainAxis:H+z+j+I.mainAxis,G=t.elements.arrow&&Mb(t.elements.arrow),V=G?"y"===w?G.clientTop||0:G.clientLeft||0:0,Y=null!=(_=null==E?void 0:E[w])?_:0,Q=M+W-Y,J=ww(p?gb(N,M+K-Y-V):N,M,p?fb(B,Q):B);A[w]=J,x[w]=J-M}if(s){var X,Z="x"===w?Nb:qb,ee="x"===w?Bb:Lb,te=A[C],re="y"===C?"height":"width",ne=te+m[Z],oe=te-m[ee],ie=-1!==[Nb,qb].indexOf(y),ae=null!=(X=null==E?void 0:E[C])?X:0,se=ie?ne:te-k[re]-S[re]-ae+I.altAxis,ce=ie?te+k[re]+S[re]-ae-I.altAxis:oe,le=p&&ie?function(e,t,r){var n=ww(e,t,r);return n>r?r:n}(se,te,ce):ww(p?se:ne,te,p?ce:oe);A[C]=le,x[C]=le-te}t.modifiersData[n]=x}},requiresIfExists:["offset"]},Aw={name:"arrow",enabled:!0,phase:"main",fn:function(e){var t,r=e.state,n=e.name,o=e.options,i=r.elements.arrow,a=r.modifiersData.popperOffsets,s=tw(r.placement),c=nw(s),l=[qb,Lb].indexOf(s)>=0?"height":"width";if(i&&a){var u=function(e,t){return mw("number"!=typeof(e="function"==typeof e?e(Object.assign({},t.rects,{placement:t.placement})):e)?e:yw(e,$b))}(o.padding,r),d=Eb(i),h="y"===c?Nb:qb,p="y"===c?Bb:Lb,f=r.rects.reference[l]+r.rects.reference[c]-a[c]-r.rects.popper[l],g=a[c]-r.rects.reference[c],m=Mb(i),y=m?"y"===c?m.clientHeight||0:m.clientWidth||0:0,v=f/2-g/2,b=u[h],w=y-d[l]-u[p],C=y/2-d[l]/2+v,A=ww(b,C,w),k=c;r.modifiersData[n]=((t={})[k]=A,t.centerOffset=A-C,t)}},effect:function(e){var t=e.state,r=e.options.element,n=void 0===r?"[data-popper-arrow]":r;null!=n&&("string"!=typeof n||(n=t.elements.popper.querySelector(n)))&&pw(t.elements.popper,n)&&(t.elements.arrow=n)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function kw(e,t,r){return void 0===r&&(r={x:0,y:0}),{top:e.top-t.height-r.y,right:e.right-t.width+r.x,bottom:e.bottom-t.height+r.y,left:e.left-t.width-r.x}}function Sw(e){return[Nb,Lb,Bb,qb].some((function(t){return e[t]>=0}))}var Tw=Xb({defaultModifiers:[ew,{name:"popperOffsets",enabled:!0,phase:"read",fn:function(e){var t=e.state,r=e.name;t.modifiersData[r]=ow({reference:t.rects.reference,element:t.rects.popper,strategy:"absolute",placement:t.placement})},data:{}},sw,{name:"applyStyles",enabled:!0,phase:"write",fn:function(e){var t=e.state;Object.keys(t.elements).forEach((function(e){var r=t.styles[e]||{},n=t.attributes[e]||{},o=t.elements[e];hb(o)&&Cb(o)&&(Object.assign(o.style,r),Object.keys(n).forEach((function(e){var t=n[e];!1===t?o.removeAttribute(e):o.setAttribute(e,!0===t?"":t)})))}))},effect:function(e){var t=e.state,r={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,r.popper),t.styles=r,t.elements.arrow&&Object.assign(t.elements.arrow.style,r.arrow),function(){Object.keys(t.elements).forEach((function(e){var n=t.elements[e],o=t.attributes[e]||{},i=Object.keys(t.styles.hasOwnProperty(e)?t.styles[e]:r[e]).reduce((function(e,t){return e[t]="",e}),{});hb(n)&&Cb(n)&&(Object.assign(n.style,i),Object.keys(o).forEach((function(e){n.removeAttribute(e)})))}))}},requires:["computeStyles"]},cw,bw,Cw,Aw,{name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(e){var t=e.state,r=e.name,n=t.rects.reference,o=t.rects.popper,i=t.modifiersData.preventOverflow,a=vw(t,{elementContext:"reference"}),s=vw(t,{altBoundary:!0}),c=kw(a,n),l=kw(s,o,i),u=Sw(c),d=Sw(l);t.modifiersData[r]={referenceClippingOffsets:c,popperEscapeOffsets:l,isReferenceHidden:u,hasPopperEscaped:d},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":u,"data-popper-escaped":d})}}]}),Iw=function(e,t,r){return void 0===e||"string"==typeof e?t:{...t,ownerState:{...t.ownerState,...r}}},Ew=function(e){if(void 0===e)return{};const t={};return Object.keys(e).filter((t=>!(t.match(/^on[A-Z]/)&&"function"==typeof e[t]))).forEach((r=>{t[r]=e[r]})),t},xw=function(e){const{getSlotProps:t,additionalProps:r,externalSlotProps:n,externalForwardedProps:o,className:i}=e;if(!t){const e=He(r?.className,i,o?.className,n?.className),t={...r?.style,...o?.style,...n?.style},a={...r,...o,...n};return e.length>0&&(a.className=e),Object.keys(t).length>0&&(a.style=t),{props:a,internalRef:void 0}}const a=function(e,t=[]){if(void 0===e)return{};const r={};return Object.keys(e).filter((r=>r.match(/^on[A-Z]/)&&"function"==typeof e[r]&&!t.includes(r))).forEach((t=>{r[t]=e[t]})),r}({...o,...n}),s=Ew(n),c=Ew(o),l=t(a),u=He(l?.className,r?.className,i,o?.className,n?.className),d={...l?.style,...r?.style,...o?.style,...n?.style},h={...l,...r,...c,...s};return u.length>0&&(h.className=u),Object.keys(d).length>0&&(h.style=d),{props:h,internalRef:l.ref}},_w=function(e,t,r){return"function"==typeof e?e(t,r):e};function Pw(e,t){"function"==typeof e?e(t):e&&(e.current=t)}var Rw=n.forwardRef((function(e,t){const{children:r,container:o,disablePortal:i=!1}=e,[a,s]=n.useState(null),c=la(n.isValidElement(r)?Gv(r):null,t);if(da((()=>{i||s(function(e){return"function"==typeof e?e():e}(o)||document.body)}),[o,i]),da((()=>{if(a&&!i)return Pw(t,a),()=>{Pw(t,null)}}),[t,a,i]),i){if(n.isValidElement(r)){const e={ref:c};return n.cloneElement(r,e)}return r}return a?Vv.createPortal(r,a):a}));function Ow(e){return vi("MuiPopper",e)}function Mw(e){return"function"==typeof e?e():e}bi("MuiPopper",["root"]);const Nw={},Bw=n.forwardRef((function(e,t){const{anchorEl:r,children:o,direction:i,disablePortal:a,modifiers:s,open:c,placement:l,popperOptions:u,popperRef:d,slotProps:h={},slots:p={},TransitionProps:f,ownerState:g,...m}=e,y=n.useRef(null),v=la(y,t),b=n.useRef(null),w=la(b,d),C=n.useRef(w);da((()=>{C.current=w}),[w]),n.useImperativeHandle(d,(()=>b.current),[]);const A=function(e,t){if("ltr"===t)return e;switch(e){case"bottom-end":return"bottom-start";case"bottom-start":return"bottom-end";case"top-end":return"top-start";case"top-start":return"top-end";default:return e}}(l,i),[k,S]=n.useState(A),[T,I]=n.useState(Mw(r));n.useEffect((()=>{b.current&&b.current.forceUpdate()})),n.useEffect((()=>{r&&I(Mw(r))}),[r]),da((()=>{if(!T||!c)return;let e=[{name:"preventOverflow",options:{altBoundary:a}},{name:"flip",options:{altBoundary:a}},{name:"onUpdate",enabled:!0,phase:"afterWrite",fn:({state:e})=>{S(e.placement)}}];null!=s&&(e=e.concat(s)),u&&null!=u.modifiers&&(e=e.concat(u.modifiers));const t=Tw(T,y.current,{placement:A,...u,modifiers:e});return C.current(t),()=>{t.destroy(),C.current(null)}}),[T,a,s,c,u,A]);const E={placement:k};null!==f&&(E.TransitionProps=f);const x=(e=>{const{classes:t}=e;return Si({root:["root"]},Ow,t)})(e),_=p.root??"div",P=function(e){const{elementType:t,externalSlotProps:r,ownerState:n,skipResolvingSlotProps:o=!1,...i}=e,a=o?{}:_w(r,n),{props:s,internalRef:c}=xw({...i,externalSlotProps:a}),l=la(c,a?.ref,e.additionalProps?.ref);return Iw(t,{...s,ref:l},n)}({elementType:_,externalSlotProps:h.root,externalForwardedProps:m,additionalProps:{role:"tooltip",ref:v},ownerState:e,className:x.root});return(0,Bn.jsx)(_,{...P,children:"function"==typeof o?o(E):o})})),Lw=Bi(n.forwardRef((function(e,t){const{anchorEl:r,children:o,container:i,direction:a="ltr",disablePortal:s=!1,keepMounted:c=!1,modifiers:l,open:u,placement:d="bottom",popperOptions:h=Nw,popperRef:p,style:f,transition:g=!1,slotProps:m={},slots:y={},...v}=e,[b,w]=n.useState(!0);if(!c&&!u&&(!g||b))return null;let C;if(i)C=i;else if(r){const e=Mw(r);C=e&&void 0!==e.nodeType?lb(e).body:lb(null).body}const A=u||!c||g&&!b?void 0:"none",k=g?{in:u,onEnter:()=>{w(!1)},onExited:()=>{w(!0)}}:void 0;return(0,Bn.jsx)(Rw,{disablePortal:s,container:C,children:(0,Bn.jsx)(Bw,{anchorEl:r,direction:a,disablePortal:s,modifiers:l,ref:t,open:g?!b:u,placement:d,popperOptions:h,popperRef:p,slotProps:m,slots:y,...v,style:{position:"fixed",top:0,left:0,display:A,...f},TransitionProps:k,children:o})})})),{name:"MuiPopper",slot:"Root"})({});var qw=n.forwardRef((function(e,t){const r=Wv(),n=Hi({props:e,name:"MuiPopper"}),{anchorEl:o,component:i,components:a,componentsProps:s,container:c,disablePortal:l,keepMounted:u,modifiers:d,open:h,placement:p,popperOptions:f,popperRef:g,transition:m,slots:y,slotProps:v,...b}=n,w=y?.root??a?.Root,C={anchorEl:o,container:c,disablePortal:l,keepMounted:u,modifiers:d,open:h,placement:p,popperOptions:f,popperRef:g,transition:m,...b};return(0,Bn.jsx)(Lw,{as:i,direction:r?"rtl":"ltr",slots:{root:w},slotProps:v??s,...C,ref:t})}));function Hw(e,t){const{className:r,elementType:n,ownerState:o,externalForwardedProps:i,internalForwardedProps:a,shouldForwardComponentProp:s=!1,...c}=t,{component:l,slots:u={[e]:void 0},slotProps:d={[e]:void 0},...h}=i,p=u[e]||n,f=_w(d[e],o),{props:{component:g,...m},internalRef:y}=xw({className:r,...c,externalForwardedProps:"root"===e?h:void 0,externalSlotProps:f}),v=la(y,f?.ref,t.ref),b="root"===e?g||l:g;return[p,Iw(p,{..."root"===e&&!l&&!u[e]&&a,..."root"!==e&&!u[e]&&a,...m,...b&&!s&&{as:b},...b&&s&&{component:b},ref:v},o)]}function $w(e){return vi("MuiTooltip",e)}var Dw=bi("MuiTooltip",["popper","popperInteractive","popperArrow","popperClose","tooltip","tooltipArrow","touch","tooltipPlacementLeft","tooltipPlacementRight","tooltipPlacementTop","tooltipPlacementBottom","arrow"]);const Fw=Bi(qw,{name:"MuiTooltip",slot:"Popper",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.popper,!r.disableInteractive&&t.popperInteractive,r.arrow&&t.popperArrow,!r.open&&t.popperClose]}})(Fi((({theme:e})=>({zIndex:(e.vars||e).zIndex.tooltip,pointerEvents:"none",variants:[{props:({ownerState:e})=>!e.disableInteractive,style:{pointerEvents:"auto"}},{props:({open:e})=>!e,style:{pointerEvents:"none"}},{props:({ownerState:e})=>e.arrow,style:{[`&[data-popper-placement*="bottom"] .${Dw.arrow}`]:{top:0,marginTop:"-0.71em","&::before":{transformOrigin:"0 100%"}},[`&[data-popper-placement*="top"] .${Dw.arrow}`]:{bottom:0,marginBottom:"-0.71em","&::before":{transformOrigin:"100% 0"}},[`&[data-popper-placement*="right"] .${Dw.arrow}`]:{height:"1em",width:"0.71em","&::before":{transformOrigin:"100% 100%"}},[`&[data-popper-placement*="left"] .${Dw.arrow}`]:{height:"1em",width:"0.71em","&::before":{transformOrigin:"0 0"}}}},{props:({ownerState:e})=>e.arrow&&!e.isRtl,style:{[`&[data-popper-placement*="right"] .${Dw.arrow}`]:{left:0,marginLeft:"-0.71em"}}},{props:({ownerState:e})=>e.arrow&&!!e.isRtl,style:{[`&[data-popper-placement*="right"] .${Dw.arrow}`]:{right:0,marginRight:"-0.71em"}}},{props:({ownerState:e})=>e.arrow&&!e.isRtl,style:{[`&[data-popper-placement*="left"] .${Dw.arrow}`]:{right:0,marginRight:"-0.71em"}}},{props:({ownerState:e})=>e.arrow&&!!e.isRtl,style:{[`&[data-popper-placement*="left"] .${Dw.arrow}`]:{left:0,marginLeft:"-0.71em"}}}]})))),Uw=Bi("div",{name:"MuiTooltip",slot:"Tooltip",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.tooltip,r.touch&&t.touch,r.arrow&&t.tooltipArrow,t[`tooltipPlacement${Ji(r.placement.split("-")[0])}`]]}})(Fi((({theme:e})=>{return{backgroundColor:e.vars?e.vars.palette.Tooltip.bg:Kn(e.palette.grey[700],.92),borderRadius:(e.vars||e).shape.borderRadius,color:(e.vars||e).palette.common.white,fontFamily:e.typography.fontFamily,padding:"4px 8px",fontSize:e.typography.pxToRem(11),maxWidth:300,margin:2,wordWrap:"break-word",fontWeight:e.typography.fontWeightMedium,[`.${Dw.popper}[data-popper-placement*="left"] &`]:{transformOrigin:"right center"},[`.${Dw.popper}[data-popper-placement*="right"] &`]:{transformOrigin:"left center"},[`.${Dw.popper}[data-popper-placement*="top"] &`]:{transformOrigin:"center bottom",marginBottom:"14px"},[`.${Dw.popper}[data-popper-placement*="bottom"] &`]:{transformOrigin:"center top",marginTop:"14px"},variants:[{props:({ownerState:e})=>e.arrow,style:{position:"relative",margin:0}},{props:({ownerState:e})=>e.touch,style:{padding:"8px 16px",fontSize:e.typography.pxToRem(14),lineHeight:(t=16/14,Math.round(1e5*t)/1e5+"em"),fontWeight:e.typography.fontWeightRegular}},{props:({ownerState:e})=>!e.isRtl,style:{[`.${Dw.popper}[data-popper-placement*="left"] &`]:{marginRight:"14px"},[`.${Dw.popper}[data-popper-placement*="right"] &`]:{marginLeft:"14px"}}},{props:({ownerState:e})=>!e.isRtl&&e.touch,style:{[`.${Dw.popper}[data-popper-placement*="left"] &`]:{marginRight:"24px"},[`.${Dw.popper}[data-popper-placement*="right"] &`]:{marginLeft:"24px"}}},{props:({ownerState:e})=>!!e.isRtl,style:{[`.${Dw.popper}[data-popper-placement*="left"] &`]:{marginLeft:"14px"},[`.${Dw.popper}[data-popper-placement*="right"] &`]:{marginRight:"14px"}}},{props:({ownerState:e})=>!!e.isRtl&&e.touch,style:{[`.${Dw.popper}[data-popper-placement*="left"] &`]:{marginLeft:"24px"},[`.${Dw.popper}[data-popper-placement*="right"] &`]:{marginRight:"24px"}}},{props:({ownerState:e})=>e.touch,style:{[`.${Dw.popper}[data-popper-placement*="top"] &`]:{marginBottom:"24px"}}},{props:({ownerState:e})=>e.touch,style:{[`.${Dw.popper}[data-popper-placement*="bottom"] &`]:{marginTop:"24px"}}}]};var t}))),jw=Bi("span",{name:"MuiTooltip",slot:"Arrow"})(Fi((({theme:e})=>({overflow:"hidden",position:"absolute",width:"1em",height:"0.71em",boxSizing:"border-box",color:e.vars?e.vars.palette.Tooltip.bg:Kn(e.palette.grey[700],.9),"&::before":{content:'""',margin:"auto",display:"block",width:"100%",height:"100%",backgroundColor:"currentColor",transform:"rotate(45deg)"}}))));let zw=!1;const Kw=new xa;let Ww={x:0,y:0};function Gw(e,t){return(r,...n)=>{t&&t(r,...n),e(r,...n)}}var Vw=n.forwardRef((function(e,t){const r=Hi({props:e,name:"MuiTooltip"}),{arrow:o=!1,children:i,classes:a,components:s={},componentsProps:c={},describeChild:l=!1,disableFocusListener:u=!1,disableHoverListener:d=!1,disableInteractive:h=!1,disableTouchListener:p=!1,enterDelay:f=100,enterNextDelay:g=0,enterTouchDelay:m=700,followCursor:y=!1,id:v,leaveDelay:b=0,leaveTouchDelay:w=1500,onClose:C,onOpen:A,open:k,placement:S="bottom",PopperComponent:T,PopperProps:I={},slotProps:E={},slots:x={},title:_,TransitionComponent:P,TransitionProps:R,...O}=r,M=n.isValidElement(i)?i:(0,Bn.jsx)("span",{children:i}),N=$i(),B=Wv(),[L,q]=n.useState(),[H,$]=n.useState(null),D=n.useRef(!1),F=h||y,U=_a(),j=_a(),z=_a(),K=_a(),[W,G]=function(e){const{controlled:t,default:r,name:o,state:i="value"}=e,{current:a}=n.useRef(void 0!==t),[s,c]=n.useState(r);return[a?t:s,n.useCallback((e=>{a||c(e)}),[])]}({controlled:k,default:!1,name:"Tooltip",state:"open"});let V=W;const Y=sa(v),Q=n.useRef(),J=ha((()=>{void 0!==Q.current&&(document.body.style.WebkitUserSelect=Q.current,Q.current=void 0),K.clear()}));n.useEffect((()=>J),[J]);const X=e=>{Kw.clear(),zw=!0,G(!0),A&&!V&&A(e)},Z=ha((e=>{Kw.start(800+b,(()=>{zw=!1})),G(!1),C&&V&&C(e),U.start(N.transitions.duration.shortest,(()=>{D.current=!1}))})),ee=e=>{D.current&&"touchstart"!==e.type||(L&&L.removeAttribute("title"),j.clear(),z.clear(),f||zw&&g?j.start(zw?g:f,(()=>{X(e)})):X(e))},te=e=>{j.clear(),z.start(b,(()=>{Z(e)}))},[,re]=n.useState(!1),ne=e=>{ca(e.target)||(re(!1),te(e))},oe=e=>{L||q(e.currentTarget),ca(e.target)&&(re(!0),ee(e))},ie=e=>{D.current=!0;const t=M.props;t.onTouchStart&&t.onTouchStart(e)};n.useEffect((()=>{if(V)return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)};function e(e){"Escape"===e.key&&Z(e)}}),[Z,V]);const ae=ua(Gv(M),q,t);_||0===_||(V=!1);const se=n.useRef(),ce={},le="string"==typeof _;l?(ce.title=V||!le||d?null:_,ce["aria-describedby"]=V?Y:null):(ce["aria-label"]=le?_:null,ce["aria-labelledby"]=V&&!le?Y:null);const ue={...ce,...O,...M.props,className:He(O.className,M.props.className),onTouchStart:ie,ref:ae,...y?{onMouseMove:e=>{const t=M.props;t.onMouseMove&&t.onMouseMove(e),Ww={x:e.clientX,y:e.clientY},se.current&&se.current.update()}}:{}},de={};p||(ue.onTouchStart=e=>{ie(e),z.clear(),U.clear(),J(),Q.current=document.body.style.WebkitUserSelect,document.body.style.WebkitUserSelect="none",K.start(m,(()=>{document.body.style.WebkitUserSelect=Q.current,ee(e)}))},ue.onTouchEnd=e=>{M.props.onTouchEnd&&M.props.onTouchEnd(e),J(),z.start(w,(()=>{Z(e)}))}),d||(ue.onMouseOver=Gw(ee,ue.onMouseOver),ue.onMouseLeave=Gw(te,ue.onMouseLeave),F||(de.onMouseOver=ee,de.onMouseLeave=te)),u||(ue.onFocus=Gw(oe,ue.onFocus),ue.onBlur=Gw(ne,ue.onBlur),F||(de.onFocus=oe,de.onBlur=ne));const he={...r,isRtl:B,arrow:o,disableInteractive:F,placement:S,PopperComponentProp:T,touch:D.current},pe="function"==typeof E.popper?E.popper(he):E.popper,fe=n.useMemo((()=>{let e=[{name:"arrow",enabled:Boolean(H),options:{element:H,padding:4}}];return I.popperOptions?.modifiers&&(e=e.concat(I.popperOptions.modifiers)),pe?.popperOptions?.modifiers&&(e=e.concat(pe.popperOptions.modifiers)),{...I.popperOptions,...pe?.popperOptions,modifiers:e}}),[H,I.popperOptions,pe?.popperOptions]),ge=(e=>{const{classes:t,disableInteractive:r,arrow:n,touch:o,placement:i}=e;return Si({popper:["popper",!r&&"popperInteractive",n&&"popperArrow"],tooltip:["tooltip",n&&"tooltipArrow",o&&"touch",`tooltipPlacement${Ji(i.split("-")[0])}`],arrow:["arrow"]},$w,t)})(he),me="function"==typeof E.transition?E.transition(he):E.transition,ye={slots:{popper:s.Popper,transition:s.Transition??P,tooltip:s.Tooltip,arrow:s.Arrow,...x},slotProps:{arrow:E.arrow??c.arrow,popper:{...I,...pe??c.popper},tooltip:E.tooltip??c.tooltip,transition:{...R,...me??c.transition}}},[ve,be]=Hw("popper",{elementType:Fw,externalForwardedProps:ye,ownerState:he,className:He(ge.popper,I?.className)}),[we,Ce]=Hw("transition",{elementType:cb,externalForwardedProps:ye,ownerState:he}),[Ae,ke]=Hw("tooltip",{elementType:Uw,className:ge.tooltip,externalForwardedProps:ye,ownerState:he}),[Se,Te]=Hw("arrow",{elementType:jw,className:ge.arrow,externalForwardedProps:ye,ownerState:he,ref:$});return(0,Bn.jsxs)(n.Fragment,{children:[n.cloneElement(M,ue),(0,Bn.jsx)(ve,{as:T??qw,placement:S,anchorEl:y?{getBoundingClientRect:()=>({top:Ww.y,left:Ww.x,right:Ww.x,bottom:Ww.y,width:0,height:0})}:L,popperRef:se,open:!!L&&V,id:Y,transition:!0,...de,...be,popperOptions:fe,children:({TransitionProps:e})=>(0,Bn.jsx)(we,{timeout:N.transitions.duration.shorter,...e,...Ce,children:(0,Bn.jsxs)(Ae,{...ke,children:[_,o?(0,Bn.jsx)(Se,{...Te}):null]})})})]})})),Yw=r(64583).Promise,Qw=function(){var e=(0,n.useState)(!0),t=e[0],r=e[1],o=(0,n.useState)(!1),i=o[0],a=o[1];return(0,n.useEffect)((function(){var e=setTimeout((function(){r(!1)}),2e3);return function(){return clearTimeout(e)}}),[]),n.createElement(n.Fragment,null,n.createElement(ki,{sx:{backgroundColor:"#f5f5f5",padding:"8px",borderRadius:2,maxWidth:600}},n.createElement(Gi,{sx:{paddingLeft:"2px",paddingRight:"8px"}},n.createElement(Qi,null,t?n.createElement(n.Fragment,null,n.createElement(oa,{sx:{fontWeight:"bold",fontSize:"18px",padding:"6px 0"},color:"primary"},gs.success.loading.title),n.createElement(ki,{sx:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:120}},n.createElement(rs,{sx:{color:"#0288D1"},size:30})),n.createElement(oa,{sx:{padding:"6px 0"}},gs.success.loading.description)):n.createElement(n.Fragment,null,n.createElement(oa,{sx:{fontWeight:"bold",fontSize:"18px",padding:"6px 0"},color:"primary"},gs.success.title),n.createElement(ki,{sx:{background:"#d4f5d4",borderLeft:"6px solid #219653",borderRadius:2,px:2,py:2,mb:2,borderRight:"4px"}},n.createElement(oa,{variant:"body1",sx:{color:"#218838"}},gs.success.success_msg)),n.createElement(oa,{variant:"body1",paragraph:!0},gs.success.description),n.createElement(Vw,{placement:"top",title:"This action will delete the reported email from your inbox."},n.createElement(fs,{variant:"contained",color:"primary",style:{textTransform:"capitalize"},onClick:function(){return e=void 0,t=void 0,n=function(){var e,t,r,n,o;return function(e,t){var r,n,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,n=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}}(this,(function(i){switch(i.label){case 0:if(i.trys.push([0,4,5,6]),a(!0),e=window.Office.context.mailbox.item,!(t=e.itemId))throw new Error("No email selected to delete.");return r=window.Office.context.mailbox.convertToRestId(t,Office.MailboxEnums.RestVersion.v2_0),(n=r)?[4,Hv(n)]:[3,2];case 1:return i.sent(),[3,3];case 2:console.error("No message ID found for the current item."),i.label=3;case 3:return[3,6];case 4:return o=i.sent(),console.error("Error processing email:",o),Hs.error("Failed to process email"),[3,6];case 5:return a(!1),[7];case 6:return[2]}}))},new((r=void 0)||(r=Yw))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}));var e,t,r,n},disabled:i},i?gs.success.buttons.deleting:gs.success.buttons.done)))))))},Jw=function(){return n.createElement(ie,null,n.createElement(ce,null,n.createElement(ae,{path:"/",element:n.createElement(zv,null)}),n.createElement(ae,{path:"/phishing",element:n.createElement(Qw,null)})))},Xw=function(){return n.createElement(n.Fragment,null,n.createElement(Jw,null))};const Zw=Symbol.for("fui.slotRenderFunction"),eC=Symbol.for("fui.slotElementType"),tC=Symbol.for("fui.slotClassNameProp");function rC(e){return Boolean(null==e?void 0:e.hasOwnProperty(eC))}function nC(e,t){return function(r,n,o,i,a){return rC(n)?t(function(e,t){return{...t,[eC]:e}}(r,n),null,o,i,a):rC(r)?t(r,n,o,i,a):e(r,n,o,i,a)}}function oC(e){const{as:t,[tC]:r,[eC]:n,[Zw]:o,...i}=e,a=i,s="string"==typeof n&&null!=t?t:n;return"string"!=typeof s&&t&&(a.as=t),{elementType:s,props:a,renderFunction:o}}r(44363);const iC=Ln,aC=nC(iC.jsx,((e,t,r)=>{const{elementType:o,renderFunction:i,props:a}=oC(e),s={...a,...t};return i?iC.jsx(n.Fragment,{children:i(o,s)},r):iC.jsx(o,s,r)})),sC=nC(iC.jsxs,((e,t,r)=>{const{elementType:o,renderFunction:i,props:a}=oC(e),s={...a,...t};return i?iC.jsx(n.Fragment,{children:i(o,{...s,children:iC.jsxs(n.Fragment,{children:s.children},void 0)})},r):iC.jsxs(o,s,r)}));function cC(){return"undefined"!=typeof window&&!(!window.document||!window.document.createElement)}const lC=n.createContext("ltr"),uC=({children:e,dir:t})=>n.createElement(lC.Provider,{value:t},e),dC=n.createContext(void 0),hC={targetDocument:"object"==typeof document?document:void 0,dir:"ltr"},pC=dC.Provider;function fC(){var e;return null!==(e=n.useContext(dC))&&void 0!==e?e:hC}const gC=n.createContext(void 0),mC=gC.Provider,yC=n.createContext(void 0).Provider,vC=n.createContext(void 0),bC=vC.Provider,wC=n.createContext(void 0).Provider,CC=n.createContext(void 0),AC=CC.Provider,kC=n.createContext(void 0).Provider,SC="undefined"==typeof window?r.g:window,TC="@griffel/";function IC(e,t){return SC[Symbol.for(TC+e)]||(SC[Symbol.for(TC+e)]=t),SC[Symbol.for(TC+e)]}const EC=IC("DEFINITION_LOOKUP_TABLE",{}),xC="data-make-styles-bucket";const _C=["r","d","l","v","w","f","i","h","a","s","k","t","m","c"].reduce(((e,t,r)=>(e[t]=r,e)),{});function PC(e,t,r,n,o={}){var i,a;const s="m"===e,c=null!==(i=o.m)&&void 0!==i?i:"0",l=null!==(a=o.p)&&void 0!==a?a:0,u=function(e,t,r){return("m"===e?e+t:e)+r}(e,c,l);if(!n.stylesheets[u]){const i=t&&t.createElement("style"),a=function(e,t,r,n){const o=[];if(n[xC]=t,n["data-priority"]=String(r),e)for(const t in n)e.setAttribute(t,n[t]);return{elementAttributes:n,insertRule:function(t){return(null==e?void 0:e.sheet)?e.sheet.insertRule(t,e.sheet.cssRules.length):o.push(t)},element:e,bucketName:t,cssRules(){return(null==e?void 0:e.sheet)?Array.from(e.sheet.cssRules).map((e=>e.cssText)):o}}}(i,e,l,Object.assign({},n.styleElementAttributes,s&&{media:c}));n.stylesheets[u]=a,(null==t?void 0:t.head)&&i&&t.head.insertBefore(i,function(e,t,r,n,o={}){var i,a;const s=_C[r],c=null!==(i=o.m)&&void 0!==i?i:"",l=null!==(a=o.p)&&void 0!==a?a:0;let u=e=>s-_C[e.getAttribute(xC)],d=e.head.querySelectorAll(`[${xC}]`);if("m"===r){const t=e.head.querySelectorAll(`[${xC}="${r}"]`);t.length&&(d=t,u=e=>n.compareMediaQueries(c,e.media))}const h=d.length;let p=h-1;for(;p>=0;){const e=d.item(p);if((function(e,t,r){var n,o;return t+(null!==(n=r.m)&&void 0!==n?n:"")===e.getAttribute(xC)+(null!==(o=e.media)&&void 0!==o?o:"")}(f=e,r,o)?l-Number(f.getAttribute("data-priority")):u(f))>0)return e.nextSibling;p--}var f;return h>0?d.item(0):t?t.nextSibling:null}(t,r,e,n,o))}return n.stylesheets[u]}function RC(e,t){try{e.insertRule(t)}catch(e){}}let OC=0;const MC=(e,t)=>e<t?-1:e>t?1:0;function NC(e=("undefined"==typeof document?void 0:document),t={}){const{classNameHashSalt:r,unstable_filterCSSRule:n,insertionPoint:o,styleElementAttributes:i,compareMediaQueries:a=MC}=t,s={classNameHashSalt:r,insertionCache:{},stylesheets:{},styleElementAttributes:Object.freeze(i),compareMediaQueries:a,id:"d"+OC++,insertCSSRules(t){for(const i in t){const a=t[i];for(let t=0,c=a.length;t<c;t++){const[c,l]=(r=a[t],Array.isArray(r)?r:[r]),u=PC(i,e,o||null,s,l);s.insertionCache[c]||(s.insertionCache[c]=i,n?n(c)&&RC(u,c):RC(u,c))}}var r}};return s}const BC=n.createContext(NC());function LC(){return n.useContext(BC)}function qC(e,t){var r;const n=e;var o;return Boolean((null==n||null===(r=n.ownerDocument)||void 0===r?void 0:r.defaultView)&&n instanceof n.ownerDocument.defaultView[null!==(o=null==t?void 0:t.constructorName)&&void 0!==o?o:"HTMLElement"])}var HC="undefined"!=typeof WeakRef,$C=class{constructor(e){HC&&"object"==typeof e?this._weakRef=new WeakRef(e):this._instance=e}deref(){var e,t;let r;return this._weakRef?(r=null==(e=this._weakRef)?void 0:e.deref(),r||delete this._weakRef):(r=this._instance,(null==(t=null==r?void 0:r.isDisposed)?void 0:t.call(r))&&delete this._instance),r}},DC="keyborg:focusin",FC=!1,UC=0,jC=class{constructor(e,t){this._isNavigatingWithKeyboard_DO_NOT_USE=!1,this._onFocusIn=e=>{if(this._isMouseOrTouchUsedTimer)return;if(this.isNavigatingWithKeyboard)return;const t=e.detail;t.relatedTarget&&(t.isFocusedProgrammatically||void 0===t.isFocusedProgrammatically||(this.isNavigatingWithKeyboard=!0))},this._onMouseDown=e=>{0===e.buttons||0===e.clientX&&0===e.clientY&&0===e.screenX&&0===e.screenY||this._onMouseOrTouch()},this._onMouseOrTouch=()=>{const e=this._win;e&&(this._isMouseOrTouchUsedTimer&&e.clearTimeout(this._isMouseOrTouchUsedTimer),this._isMouseOrTouchUsedTimer=e.setTimeout((()=>{delete this._isMouseOrTouchUsedTimer}),1e3)),this.isNavigatingWithKeyboard=!1},this._onKeyDown=e=>{this.isNavigatingWithKeyboard?this._shouldDismissKeyboardNavigation(e)&&this._scheduleDismiss():this._shouldTriggerKeyboardNavigation(e)&&(this.isNavigatingWithKeyboard=!0)},this.id="c"+ ++UC,this._win=e;const r=e.document;if(t){const e=t.triggerKeys,r=t.dismissKeys;(null==e?void 0:e.length)&&(this._triggerKeys=new Set(e)),(null==r?void 0:r.length)&&(this._dismissKeys=new Set(r))}r.addEventListener(DC,this._onFocusIn,!0),r.addEventListener("mousedown",this._onMouseDown,!0),e.addEventListener("keydown",this._onKeyDown,!0),r.addEventListener("touchstart",this._onMouseOrTouch,!0),r.addEventListener("touchend",this._onMouseOrTouch,!0),r.addEventListener("touchcancel",this._onMouseOrTouch,!0),function(e){const t=e;FC||(FC=function(e){const t=e.HTMLElement,r=t.prototype.focus;let n=!1;return t.prototype.focus=function(){n=!0},e.document.createElement("button").focus(),t.prototype.focus=r,n}(t));const r=t.HTMLElement.prototype.focus;if(r.__keyborgNativeFocus)return;t.HTMLElement.prototype.focus=c;const n=new Set,o=e=>{const t=e.target;if(!t)return;const r=new CustomEvent("keyborg:focusout",{cancelable:!0,bubbles:!0,composed:!0,detail:{originalEvent:e}});t.dispatchEvent(r)},i=e=>{const t=e.target;if(!t)return;let r=e.composedPath()[0];const s=new Set;for(;r;)r.nodeType===Node.DOCUMENT_FRAGMENT_NODE?(s.add(r),r=r.host):r=r.parentNode;for(const e of n){const t=e.deref();t&&s.has(t)||(n.delete(e),t&&(t.removeEventListener("focusin",i,!0),t.removeEventListener("focusout",o,!0)))}a(t,e.relatedTarget||void 0)},a=(e,t,r)=>{var a;const c=e.shadowRoot;if(c){for(const e of n)if(e.deref()===c)return;return c.addEventListener("focusin",i,!0),c.addEventListener("focusout",o,!0),void n.add(new $C(c))}const l={relatedTarget:t,originalEvent:r},u=new CustomEvent(DC,{cancelable:!0,bubbles:!0,composed:!0,detail:l});u.details=l,(FC||s.lastFocusedProgrammatically)&&(l.isFocusedProgrammatically=e===(null==(a=s.lastFocusedProgrammatically)?void 0:a.deref()),s.lastFocusedProgrammatically=void 0),e.dispatchEvent(u)},s=t.__keyborgData={focusInHandler:i,focusOutHandler:o,shadowTargets:n};function c(){const e=t.__keyborgData;return e&&(e.lastFocusedProgrammatically=new $C(this)),r.apply(this,arguments)}t.document.addEventListener("focusin",t.__keyborgData.focusInHandler,!0),t.document.addEventListener("focusout",t.__keyborgData.focusOutHandler,!0);let l=t.document.activeElement;for(;l&&l.shadowRoot;)a(l),l=l.shadowRoot.activeElement;c.__keyborgNativeFocus=r}(e)}get isNavigatingWithKeyboard(){return this._isNavigatingWithKeyboard_DO_NOT_USE}set isNavigatingWithKeyboard(e){this._isNavigatingWithKeyboard_DO_NOT_USE!==e&&(this._isNavigatingWithKeyboard_DO_NOT_USE=e,this.update())}dispose(){const e=this._win;if(e){this._isMouseOrTouchUsedTimer&&(e.clearTimeout(this._isMouseOrTouchUsedTimer),this._isMouseOrTouchUsedTimer=void 0),this._dismissTimer&&(e.clearTimeout(this._dismissTimer),this._dismissTimer=void 0),function(e){const t=e,r=t.HTMLElement.prototype,n=r.focus.__keyborgNativeFocus,o=t.__keyborgData;if(o){t.document.removeEventListener("focusin",o.focusInHandler,!0),t.document.removeEventListener("focusout",o.focusOutHandler,!0);for(const e of o.shadowTargets){const t=e.deref();t&&(t.removeEventListener("focusin",o.focusInHandler,!0),t.removeEventListener("focusout",o.focusOutHandler,!0))}o.shadowTargets.clear(),delete t.__keyborgData}n&&(r.focus=n)}(e);const t=e.document;t.removeEventListener(DC,this._onFocusIn,!0),t.removeEventListener("mousedown",this._onMouseDown,!0),e.removeEventListener("keydown",this._onKeyDown,!0),t.removeEventListener("touchstart",this._onMouseOrTouch,!0),t.removeEventListener("touchend",this._onMouseOrTouch,!0),t.removeEventListener("touchcancel",this._onMouseOrTouch,!0),delete this._win}}isDisposed(){return!!this._win}update(){var e,t;const r=null==(t=null==(e=this._win)?void 0:e.__keyborg)?void 0:t.refs;if(r)for(const e of Object.keys(r))zC.update(r[e],this.isNavigatingWithKeyboard)}_shouldTriggerKeyboardNavigation(e){var t;if("Tab"===e.key)return!0;const r=null==(t=this._win)?void 0:t.document.activeElement,n=!this._triggerKeys||this._triggerKeys.has(e.keyCode),o=r&&("INPUT"===r.tagName||"TEXTAREA"===r.tagName||r.isContentEditable);return n&&!o}_shouldDismissKeyboardNavigation(e){var t;return null==(t=this._dismissKeys)?void 0:t.has(e.keyCode)}_scheduleDismiss(){const e=this._win;if(e){this._dismissTimer&&(e.clearTimeout(this._dismissTimer),this._dismissTimer=void 0);const t=e.document.activeElement;this._dismissTimer=e.setTimeout((()=>{this._dismissTimer=void 0;const r=e.document.activeElement;t&&r&&t===r&&(this.isNavigatingWithKeyboard=!1)}),500)}}},zC=class e{constructor(e,t){this._cb=[],this._id="k"+ ++UC,this._win=e;const r=e.__keyborg;r?(this._core=r.core,r.refs[this._id]=this):(this._core=new jC(e,t),e.__keyborg={core:this._core,refs:{[this._id]:this}})}static create(t,r){return new e(t,r)}static dispose(e){e.dispose()}static update(e,t){e._cb.forEach((e=>e(t)))}dispose(){var e;const t=null==(e=this._win)?void 0:e.__keyborg;(null==t?void 0:t.refs[this._id])&&(delete t.refs[this._id],0===Object.keys(t.refs).length&&(t.core.dispose(),delete this._win.__keyborg)),this._cb=[],delete this._core,delete this._win}isNavigatingWithKeyboard(){var e;return!!(null==(e=this._core)?void 0:e.isNavigatingWithKeyboard)}subscribe(e){this._cb.push(e)}unsubscribe(e){const t=this._cb.indexOf(e);t>=0&&this._cb.splice(t,1)}setVal(e){this._core&&(this._core.isNavigatingWithKeyboard=e)}};const KC="data-fui-focus-visible";function WC(e,t){if(GC(e))return()=>{};const r={current:void 0},n=(o=t,zC.create(o,undefined));var o;function i(e){n.isNavigatingWithKeyboard()&&qC(e)&&(r.current=e,e.setAttribute(KC,""))}function a(){r.current&&(r.current.removeAttribute(KC),r.current=void 0)}n.subscribe((e=>{e?i(t.document.activeElement):a()}));const s=e=>{a(),i(e.composedPath()[0])},c=t=>{(!t.relatedTarget||qC(t.relatedTarget)&&!e.contains(t.relatedTarget))&&a()};return e.addEventListener(DC,s),e.addEventListener("focusout",c),e.focusVisible=!0,e.contains(t.document.activeElement)&&i(t.document.activeElement),()=>{var t;a(),e.removeEventListener(DC,s),e.removeEventListener("focusout",c),delete e.focusVisible,t=n,zC.dispose(t)}}function GC(e){return!!e&&(!!e.focusVisible||GC(null==e?void 0:e.parentElement))}function VC(e={}){const t=fC(),r=n.useRef(null);var o;const i=null!==(o=e.targetDocument)&&void 0!==o?o:t.targetDocument;return n.useEffect((()=>{if((null==i?void 0:i.defaultView)&&r.current)return WC(r.current,i.defaultView)}),[r,i]),r}function YC(e,t){const{defaultProps:r,elementType:o}=t,i=function(e){return"string"==typeof e||"number"==typeof e||Array.isArray(e)||n.isValidElement(e)?{children:e}:e}(e),a={...r,...i,[eC]:o,[tC]:null==i?void 0:i.className};return i&&"function"==typeof i.children&&(a[Zw]=i.children,a.children=null==r?void 0:r.children),a}const QC=(...e)=>{const t={};for(const r of e){const e=Array.isArray(r)?r:Object.keys(r);for(const r of e)t[r]=1}return t},JC=QC(["onAuxClick","onAnimationEnd","onAnimationStart","onCopy","onCut","onPaste","onCompositionEnd","onCompositionStart","onCompositionUpdate","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onInput","onSubmit","onLoad","onError","onKeyDown","onKeyDownCapture","onKeyPress","onKeyUp","onAbort","onCanPlay","onCanPlayThrough","onDurationChange","onEmptied","onEncrypted","onEnded","onLoadedData","onLoadedMetadata","onLoadStart","onPause","onPlay","onPlaying","onProgress","onRateChange","onSeeked","onSeeking","onStalled","onSuspend","onTimeUpdate","onVolumeChange","onWaiting","onClick","onClickCapture","onContextMenu","onDoubleClick","onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onMouseUpCapture","onSelect","onTouchCancel","onTouchEnd","onTouchMove","onTouchStart","onScroll","onWheel","onPointerCancel","onPointerDown","onPointerEnter","onPointerLeave","onPointerMove","onPointerOut","onPointerOver","onPointerUp","onGotPointerCapture","onLostPointerCapture"]),XC=QC(["accessKey","children","className","contentEditable","dir","draggable","hidden","htmlFor","id","lang","ref","role","style","tabIndex","title","translate","spellCheck","name"]),ZC=QC(["itemID","itemProp","itemRef","itemScope","itemType"]),eA=QC(XC,JC,ZC),tA=QC(eA,["form"]),rA=QC(eA,["height","loop","muted","preload","src","width"]),nA=QC(rA,["poster"]),oA=QC(eA,["start"]),iA=QC(eA,["value"]),aA=QC(eA,["download","href","hrefLang","media","rel","target","type"]),sA=QC(eA,["dateTime"]),cA=QC(eA,["autoFocus","disabled","form","formAction","formEncType","formMethod","formNoValidate","formTarget","type","value"]),lA={label:tA,audio:rA,video:nA,ol:oA,li:iA,a:aA,button:cA,input:QC(cA,["accept","alt","autoCorrect","autoCapitalize","autoComplete","checked","dirname","form","height","inputMode","list","max","maxLength","min","minLength","multiple","pattern","placeholder","readOnly","required","src","step","size","type","value","width"]),textarea:QC(cA,["autoCapitalize","cols","dirname","form","maxLength","placeholder","readOnly","required","rows","wrap"]),select:QC(cA,["form","multiple","required"]),option:QC(eA,["selected","value"]),table:QC(eA,["cellPadding","cellSpacing"]),tr:eA,th:QC(eA,["colSpan","rowSpan","scope"]),td:QC(eA,["colSpan","headers","rowSpan","scope"]),colGroup:QC(eA,["span"]),col:QC(eA,["span"]),fieldset:QC(eA,["disabled","form"]),form:QC(eA,["acceptCharset","action","encType","encType","method","noValidate","target"]),iframe:QC(eA,["allow","allowFullScreen","allowPaymentRequest","allowTransparency","csp","height","importance","referrerPolicy","sandbox","src","srcDoc","width"]),img:QC(eA,["alt","crossOrigin","height","src","srcSet","useMap","width"]),time:sA,dialog:QC(eA,["open","onCancel","onClose"])};const uA=(e,t,r)=>{var n;return function(e,t,r){const n=e&&lA[e]||eA;return n.as=1,function(e,t,r){const n=Array.isArray(t),o={},i=Object.keys(e);for(const a of i)!(!n&&t[a]||n&&t.indexOf(a)>=0||0===a.indexOf("data-")||0===a.indexOf("aria-"))||r&&-1!==(null==r?void 0:r.indexOf(a))||(o[a]=e[a]);return o}(t,n,r)}(null!==(n=t.as)&&void 0!==n?n:e,t,r)};function dA(...e){const t=n.useCallback((r=>{t.current=r;for(const t of e)"function"==typeof t?t(r):t&&(t.current=r)}),[...e]);return t}const hA=cC()?n.useLayoutEffect:n.useEffect,pA={current:0},fA=n.createContext(void 0);const gA=n.createContext(void 0);function mA(e="fui-",t){const r=null!==(s=n.useContext(fA))&&void 0!==s?s:pA,i=n.useContext(gA)||"",a=o.useId;var s;if(a){const r=a(),o=n.useMemo((()=>r.replace(/:/g,"")),[r]);return t||`${i}${e}${o}`}return n.useMemo((()=>t||`${i}${e}${++r.current}`),[i,e,t,r])}gA.Provider;const yA=()=>{const e={};return function(t,r){void 0===e[t.id]&&(t.insertCSSRules(r),e[t.id]=!0)}};function vA(e,t,r=[]){return"___"+function(e){const t=e.length;if(7===t)return e;for(let r=t;r<7;r++)e+="0";return e}(zt(e+t))}function bA(e,t){let r="",n="";for(const o in e){const i=e[o];if(0===i){n+=o+" ";continue}const a=Array.isArray(i),s="rtl"===t?(a?i[1]:i)+" ":(a?i[0]:i)+" ";r+=s,n+=s}return[r.slice(0,-1),n.slice(0,-1)]}function wA(e,t){const r={};for(const n in e){const[o,i]=bA(e[n],t);if(""===i){r[n]="";continue}const a=vA(i,t),s=a+(""===o?"":" "+o);EC[a]=[e[n],t],r[n]=s}return r}function CA(e,t,r=yA){const n=r();let o=null,i=null;return function(r){const{dir:a,renderer:s}=r,c="ltr"===a;return c?null===o&&(o=wA(e,a)):null===i&&(i=wA(e,a)),n(s,t),c?o:i}}const AA={},kA="fui-FluentProvider",SA=CA({root:{sj55zd:"f19n0e5",De3pzq:"fxugw4r",fsow6f:["f1o700av","fes3tcz"],Bahqtrf:"fk6fouc",Be2twd7:"fkhj508",Bhrd7zp:"figsok6",Bg96gwp:"f1i3iumi"}},{d:[".f19n0e5{color:var(--colorNeutralForeground1);}",".fxugw4r{background-color:var(--colorNeutralBackground1);}",".f1o700av{text-align:left;}",".fes3tcz{text-align:right;}",".fk6fouc{font-family:var(--fontFamilyBase);}",".fkhj508{font-size:var(--fontSizeBase300);}",".figsok6{font-weight:var(--fontWeightRegular);}",".f1i3iumi{line-height:var(--lineHeightBase300);}"]}),TA=o.useInsertionEffect?o.useInsertionEffect:hA,IA={},EA={},xA=(e,t)=>{const r=fC(),o=n.useContext(gC),i=null!==(a=n.useContext(CC))&&void 0!==a?a:{};var a;const s=n.useContext(vC)||IA,{applyStylesToPortals:c=!0,customStyleHooks_unstable:l,dir:u=r.dir,targetDocument:d=r.targetDocument,theme:h,overrides_unstable:p={}}=e,f=_A(o,h),g=_A(i,p),m=_A(s,l),y=LC();var v;const{styleTagId:b,rule:w}=(e=>{const{targetDocument:t,theme:r,rendererAttributes:o}=e,i=n.useRef(),a=mA(kA),s=o,c=n.useMemo((()=>function(e,t){return t?`${e} { ${Object.keys(t).reduce(((e,r)=>`${e}--${r}: ${t[r]}; `),"")} }`:`${e} {}`}(`.${a}`,r)),[r,a]);return function(e,t){n.useState((()=>{if(!e)return;const r=e.getElementById(t);r&&e.head.append(r)}))}(t,a),TA((()=>{const e=null==t?void 0:t.getElementById(a);return e?i.current=e:(i.current=((e,t)=>{if(!(null==e?void 0:e.head))return;const r=e.createElement("style");return Object.keys(t).forEach((e=>{r.setAttribute(e,t[e])})),e.head.appendChild(r),r})(t,{...s,id:a}),i.current&&((e,t)=>{const r=e.sheet;r&&(r.cssRules.length>0&&r.deleteRule(0),r.insertRule(t,0))})(i.current,c)),()=>{var e;null===(e=i.current)||void 0===e||e.remove()}}),[a,t,c,s]),{styleTagId:a,rule:c}})({theme:f,targetDocument:d,rendererAttributes:null!==(v=y.styleElementAttributes)&&void 0!==v?v:EA});return{applyStylesToPortals:c,customStyleHooks_unstable:m,dir:u,targetDocument:d,theme:f,overrides_unstable:g,themeClassName:b,components:{root:"div"},root:YC(uA("div",{...e,dir:u,ref:dA(t,VC({targetDocument:d}))}),{elementType:"div"}),serverStyleProps:{cssRule:w,attributes:{...y.styleElementAttributes,id:b}}}};function _A(e,t){return e&&t?{...e,...t}:e||t}const PA=n.forwardRef(((e,t)=>{const r=xA(e,t);(e=>{const t=LC(),r=SA({dir:e.dir,renderer:t});e.root.className=function(){let e=null,t="",r="";const n=new Array(arguments.length);for(let e=0;e<arguments.length;e++){const o=arguments[e];if("string"==typeof o&&""!==o){const i=o.indexOf("___");if(-1===i)t+=o+" ";else{const a=o.substr(i,10);i>0&&(t+=o.slice(0,i)),r+=a,n[e]=a}}}if(""===r)return t.slice(0,-1);const o=AA[r];if(void 0!==o)return t+o;const i=[];for(let t=0;t<arguments.length;t++){const r=n[t];if(r){const t=EC[r];t&&(i.push(t[0]),e=t[1])}}const a=Object.assign.apply(Object,[{}].concat(i)),[s,c]=bA(a,e),l=vA(c,e,n),u=l+" "+s;return AA[r]=u,EC[l]=[a,e],t+u}(kA,e.themeClassName,r.root,e.root.className)})(r);const o=function(e){const{applyStylesToPortals:t,customStyleHooks_unstable:r,dir:o,root:i,targetDocument:a,theme:s,themeClassName:c,overrides_unstable:l}=e,u=n.useMemo((()=>({dir:o,targetDocument:a})),[o,a]),[d]=n.useState((()=>({}))),h=n.useMemo((()=>({textDirection:o})),[o]);return{customStyleHooks_unstable:r,overrides_unstable:l,provider:u,textDirection:o,iconDirection:h,tooltip:d,theme:s,themeClassName:t?i.className:c}}(r);return((e,t)=>aC(pC,{value:t.provider,children:aC(mC,{value:t.theme,children:aC(yC,{value:t.themeClassName,children:aC(bC,{value:t.customStyleHooks_unstable,children:aC(wC,{value:t.tooltip,children:aC(uC,{dir:t.textDirection,children:aC(kC,{value:t.iconDirection,children:aC(AC,{value:t.overrides_unstable,children:sC(e.root,{children:[cC()?null:aC("style",{dangerouslySetInnerHTML:{__html:e.serverStyleProps.cssRule},...e.serverStyleProps.attributes}),e.root.children]})})})})})})})})}))(r,o)}));PA.displayName="FluentProvider";const RA="#242424",OA="#424242",MA="#616161",NA="#bdbdbd",BA="#e0e0e0",LA="#e6e6e6",qA="#ebebeb",HA="#f0f0f0",$A="#f5f5f5",DA="#fafafa",FA="rgba(255, 255, 255, 0.4)",UA="rgba(255, 255, 255, 0.5)",jA="rgba(0, 0, 0, 0.05)",zA="rgba(0, 0, 0, 0.1)",KA="#ffffff",WA={shade50:"#200205",shade40:"#3b0509",shade30:"#6e0811",shade20:"#960b18",shade10:"#b10e1c",primary:"#c50f1f",tint10:"#cc2635",tint20:"#d33f4c",tint30:"#dc626d",tint40:"#eeacb2",tint50:"#f6d1d5",tint60:"#fdf3f4"},GA={shade50:"#031403",shade40:"#052505",shade30:"#094509",shade20:"#0c5e0c",shade10:"#0e700e",primary:"#107c10",tint10:"#218c21",tint20:"#359b35",tint30:"#54b054",tint40:"#9fd89f",tint50:"#c9eac9",tint60:"#f1faf1"},VA={red:{shade50:"#210809",shade40:"#3f1011",shade30:"#751d1f",shade20:"#9f282b",shade10:"#bc2f32",primary:"#d13438",tint10:"#d7494c",tint20:"#dc5e62",tint30:"#e37d80",tint40:"#f1bbbc",tint50:"#f8dadb",tint60:"#fdf6f6"},green:GA,darkOrange:{shade50:"#230900",shade40:"#411200",shade30:"#7a2101",shade20:"#a62d01",shade10:"#c43501",primary:"#da3b01",tint10:"#de501c",tint20:"#e36537",tint30:"#e9835e",tint40:"#f4bfab",tint50:"#f9dcd1",tint60:"#fdf6f3"},yellow:{shade50:"#282400",shade40:"#4c4400",shade30:"#817400",shade20:"#c0ad00",shade10:"#e4cc00",primary:"#fde300",tint10:"#fde61e",tint20:"#fdea3d",tint30:"#feee66",tint40:"#fef7b2",tint50:"#fffad6",tint60:"#fffef5"},berry:{shade50:"#1f091d",shade40:"#3a1136",shade30:"#6d2064",shade20:"#932b88",shade10:"#af33a1",primary:"#c239b3",tint10:"#c94cbc",tint20:"#d161c4",tint30:"#da7ed0",tint40:"#edbbe7",tint50:"#f5daf2",tint60:"#fdf5fc"},lightGreen:{shade50:"#031a02",shade40:"#063004",shade30:"#0b5a08",shade20:"#0e7a0b",shade10:"#11910d",primary:"#13a10e",tint10:"#27ac22",tint20:"#3db838",tint30:"#5ec75a",tint40:"#a7e3a5",tint50:"#cef0cd",tint60:"#f2fbf2"},marigold:{shade50:"#251a00",shade40:"#463100",shade30:"#835b00",shade20:"#b27c00",shade10:"#d39300",primary:"#eaa300",tint10:"#edad1c",tint20:"#efb839",tint30:"#f2c661",tint40:"#f9e2ae",tint50:"#fcefd3",tint60:"#fefbf4"}},YA={darkRed:{shade50:"#130204",shade40:"#230308",shade30:"#420610",shade20:"#590815",shade10:"#690a19",primary:"#750b1c",tint10:"#861b2c",tint20:"#962f3f",tint30:"#ac4f5e",tint40:"#d69ca5",tint50:"#e9c7cd",tint60:"#f9f0f2"},cranberry:WA,pumpkin:{shade50:"#200d03",shade40:"#3d1805",shade30:"#712d09",shade20:"#9a3d0c",shade10:"#b6480e",primary:"#ca5010",tint10:"#d06228",tint20:"#d77440",tint30:"#df8e64",tint40:"#efc4ad",tint50:"#f7dfd2",tint60:"#fdf7f4"},peach:{shade50:"#291600",shade40:"#4d2a00",shade30:"#8f4e00",shade20:"#c26a00",shade10:"#e67e00",primary:"#ff8c00",tint10:"#ff9a1f",tint20:"#ffa83d",tint30:"#ffba66",tint40:"#ffddb3",tint50:"#ffedd6",tint60:"#fffaf5"},gold:{shade50:"#1f1900",shade40:"#3a2f00",shade30:"#6c5700",shade20:"#937700",shade10:"#ae8c00",primary:"#c19c00",tint10:"#c8a718",tint20:"#d0b232",tint30:"#dac157",tint40:"#ecdfa5",tint50:"#f5eece",tint60:"#fdfbf2"},brass:{shade50:"#181202",shade40:"#2e2103",shade30:"#553e06",shade20:"#745408",shade10:"#89640a",primary:"#986f0b",tint10:"#a47d1e",tint20:"#b18c34",tint30:"#c1a256",tint40:"#e0cea2",tint50:"#efe4cb",tint60:"#fbf8f2"},brown:{shade50:"#170e07",shade40:"#2b1a0e",shade30:"#50301a",shade20:"#6c4123",shade10:"#804d29",primary:"#8e562e",tint10:"#9c663f",tint20:"#a97652",tint30:"#bb8f6f",tint40:"#ddc3b0",tint50:"#edded3",tint60:"#faf7f4"},forest:{shade50:"#0c1501",shade40:"#162702",shade30:"#294903",shade20:"#376304",shade10:"#427505",primary:"#498205",tint10:"#599116",tint20:"#6ba02b",tint30:"#85b44c",tint40:"#bdd99b",tint50:"#dbebc7",tint60:"#f6faf0"},seafoam:{shade50:"#002111",shade40:"#003d20",shade30:"#00723b",shade20:"#009b51",shade10:"#00b85f",primary:"#00cc6a",tint10:"#19d279",tint20:"#34d889",tint30:"#5ae0a0",tint40:"#a8f0cd",tint50:"#cff7e4",tint60:"#f3fdf8"},darkGreen:{shade50:"#021102",shade40:"#032003",shade30:"#063b06",shade20:"#085108",shade10:"#0a5f0a",primary:"#0b6a0b",tint10:"#1a7c1a",tint20:"#2d8e2d",tint30:"#4da64d",tint40:"#9ad29a",tint50:"#c6e7c6",tint60:"#f0f9f0"},lightTeal:{shade50:"#001d1f",shade40:"#00373a",shade30:"#00666d",shade20:"#008b94",shade10:"#00a5af",primary:"#00b7c3",tint10:"#18bfca",tint20:"#32c8d1",tint30:"#58d3db",tint40:"#a6e9ed",tint50:"#cef3f5",tint60:"#f2fcfd"},teal:{shade50:"#001516",shade40:"#012728",shade30:"#02494c",shade20:"#026467",shade10:"#037679",primary:"#038387",tint10:"#159195",tint20:"#2aa0a4",tint30:"#4cb4b7",tint40:"#9bd9db",tint50:"#c7ebec",tint60:"#f0fafa"},steel:{shade50:"#000f12",shade40:"#001b22",shade30:"#00333f",shade20:"#004555",shade10:"#005265",primary:"#005b70",tint10:"#0f6c81",tint20:"#237d92",tint30:"#4496a9",tint40:"#94c8d4",tint50:"#c3e1e8",tint60:"#eff7f9"},blue:{shade50:"#001322",shade40:"#002440",shade30:"#004377",shade20:"#005ba1",shade10:"#006cbf",primary:"#0078d4",tint10:"#1a86d9",tint20:"#3595de",tint30:"#5caae5",tint40:"#a9d3f2",tint50:"#d0e7f8",tint60:"#f3f9fd"},royalBlue:{shade50:"#000c16",shade40:"#00172a",shade30:"#002c4e",shade20:"#003b6a",shade10:"#00467e",primary:"#004e8c",tint10:"#125e9a",tint20:"#286fa8",tint30:"#4a89ba",tint40:"#9abfdc",tint50:"#c7dced",tint60:"#f0f6fa"},cornflower:{shade50:"#0d1126",shade40:"#182047",shade30:"#2c3c85",shade20:"#3c51b4",shade10:"#4760d5",primary:"#4f6bed",tint10:"#637cef",tint20:"#778df1",tint30:"#93a4f4",tint40:"#c8d1fa",tint50:"#e1e6fc",tint60:"#f7f9fe"},navy:{shade50:"#00061d",shade40:"#000c36",shade30:"#001665",shade20:"#001e89",shade10:"#0023a2",primary:"#0027b4",tint10:"#173bbd",tint20:"#3050c6",tint30:"#546fd2",tint40:"#a3b2e8",tint50:"#ccd5f3",tint60:"#f2f4fc"},lavender:{shade50:"#120f25",shade40:"#221d46",shade30:"#3f3682",shade20:"#5649b0",shade10:"#6656d1",primary:"#7160e8",tint10:"#8172eb",tint20:"#9184ee",tint30:"#a79cf1",tint40:"#d2ccf8",tint50:"#e7e4fb",tint60:"#f9f8fe"},purple:{shade50:"#0f0717",shade40:"#1c0e2b",shade30:"#341a51",shade20:"#46236e",shade10:"#532982",primary:"#5c2e91",tint10:"#6b3f9e",tint20:"#7c52ab",tint30:"#9470bd",tint40:"#c6b1de",tint50:"#e0d3ed",tint60:"#f7f4fb"},grape:{shade50:"#160418",shade40:"#29072e",shade30:"#4c0d55",shade20:"#671174",shade10:"#7a1589",primary:"#881798",tint10:"#952aa4",tint20:"#a33fb1",tint30:"#b55fc1",tint40:"#d9a7e0",tint50:"#eaceef",tint60:"#faf2fb"},lilac:{shade50:"#1c0b1f",shade40:"#35153a",shade30:"#63276d",shade20:"#863593",shade10:"#9f3faf",primary:"#b146c2",tint10:"#ba58c9",tint20:"#c36bd1",tint30:"#cf87da",tint40:"#e6bfed",tint50:"#f2dcf5",tint60:"#fcf6fd"},pink:{shade50:"#24091b",shade40:"#441232",shade30:"#80215d",shade20:"#ad2d7e",shade10:"#cd3595",primary:"#e43ba6",tint10:"#e750b0",tint20:"#ea66ba",tint30:"#ef85c8",tint40:"#f7c0e3",tint50:"#fbddf0",tint60:"#fef6fb"},magenta:{shade50:"#1f0013",shade40:"#390024",shade30:"#6b0043",shade20:"#91005a",shade10:"#ac006b",primary:"#bf0077",tint10:"#c71885",tint20:"#ce3293",tint30:"#d957a8",tint40:"#eca5d1",tint50:"#f5cee6",tint60:"#fcf2f9"},plum:{shade50:"#13000c",shade40:"#240017",shade30:"#43002b",shade20:"#5a003b",shade10:"#6b0045",primary:"#77004d",tint10:"#87105d",tint20:"#98246f",tint30:"#ad4589",tint40:"#d696c0",tint50:"#e9c4dc",tint60:"#faf0f6"},beige:{shade50:"#141313",shade40:"#252323",shade30:"#444241",shade20:"#5d5958",shade10:"#6e6968",primary:"#7a7574",tint10:"#8a8584",tint20:"#9a9594",tint30:"#afabaa",tint40:"#d7d4d4",tint50:"#eae8e8",tint60:"#faf9f9"},mink:{shade50:"#0f0e0e",shade40:"#1c1b1a",shade30:"#343231",shade20:"#474443",shade10:"#54514f",primary:"#5d5a58",tint10:"#706d6b",tint20:"#84817e",tint30:"#9e9b99",tint40:"#cecccb",tint50:"#e5e4e3",tint60:"#f8f8f8"},platinum:{shade50:"#111314",shade40:"#1f2426",shade30:"#3b4447",shade20:"#505c60",shade10:"#5f6d71",primary:"#69797e",tint10:"#79898d",tint20:"#89989d",tint30:"#a0adb2",tint40:"#cdd6d8",tint50:"#e4e9ea",tint60:"#f8f9fa"},anchor:{shade50:"#090a0b",shade40:"#111315",shade30:"#202427",shade20:"#2b3135",shade10:"#333a3f",primary:"#394146",tint10:"#4d565c",tint20:"#626c72",tint30:"#808a90",tint40:"#bcc3c7",tint50:"#dbdfe1",tint60:"#f6f7f8"}},QA={cranberry:WA,green:GA,orange:{shade50:"#271002",shade40:"#4a1e04",shade30:"#8a3707",shade20:"#bc4b09",shade10:"#de590b",primary:"#f7630c",tint10:"#f87528",tint20:"#f98845",tint30:"#faa06b",tint40:"#fdcfb4",tint50:"#fee5d7",tint60:"#fff9f5"}},JA={success:"green",warning:"orange",danger:"cranberry"},XA=["red","green","darkOrange","yellow","berry","lightGreen","marigold"].reduce(((e,t)=>{const r=t.slice(0,1).toUpperCase()+t.slice(1),n={[`colorPalette${r}Background1`]:VA[t].tint60,[`colorPalette${r}Background2`]:VA[t].tint40,[`colorPalette${r}Background3`]:VA[t].primary,[`colorPalette${r}Foreground1`]:VA[t].shade10,[`colorPalette${r}Foreground2`]:VA[t].shade30,[`colorPalette${r}Foreground3`]:VA[t].primary,[`colorPalette${r}BorderActive`]:VA[t].primary,[`colorPalette${r}Border1`]:VA[t].tint40,[`colorPalette${r}Border2`]:VA[t].primary};return Object.assign(e,n)}),{});XA.colorPaletteYellowForeground1=VA.yellow.shade30,XA.colorPaletteRedForegroundInverted=VA.red.tint20,XA.colorPaletteGreenForegroundInverted=VA.green.tint20,XA.colorPaletteYellowForegroundInverted=VA.yellow.tint40;const ZA=["darkRed","cranberry","pumpkin","peach","gold","brass","brown","forest","seafoam","darkGreen","lightTeal","teal","steel","blue","royalBlue","cornflower","navy","lavender","purple","grape","lilac","pink","magenta","plum","beige","mink","platinum","anchor"].reduce(((e,t)=>{const r=t.slice(0,1).toUpperCase()+t.slice(1),n={[`colorPalette${r}Background2`]:YA[t].tint40,[`colorPalette${r}Foreground2`]:YA[t].shade30,[`colorPalette${r}BorderActive`]:YA[t].primary};return Object.assign(e,n)}),{}),ek={...XA,...ZA},tk=Object.entries(JA).reduce(((e,[t,r])=>{const n=t.slice(0,1).toUpperCase()+t.slice(1),o={[`colorStatus${n}Background1`]:QA[r].tint60,[`colorStatus${n}Background2`]:QA[r].tint40,[`colorStatus${n}Background3`]:QA[r].primary,[`colorStatus${n}Foreground1`]:QA[r].shade10,[`colorStatus${n}Foreground2`]:QA[r].shade30,[`colorStatus${n}Foreground3`]:QA[r].primary,[`colorStatus${n}ForegroundInverted`]:QA[r].tint30,[`colorStatus${n}BorderActive`]:QA[r].primary,[`colorStatus${n}Border1`]:QA[r].tint40,[`colorStatus${n}Border2`]:QA[r].primary};return Object.assign(e,o)}),{});tk.colorStatusDangerBackground3Hover=QA[JA.danger].shade10,tk.colorStatusDangerBackground3Pressed=QA[JA.danger].shade20,tk.colorStatusWarningForeground1=QA[JA.warning].shade20,tk.colorStatusWarningForeground3=QA[JA.warning].shade20,tk.colorStatusWarningBorder2=QA[JA.warning].shade20;const rk={borderRadiusNone:"0",borderRadiusSmall:"2px",borderRadiusMedium:"4px",borderRadiusLarge:"6px",borderRadiusXLarge:"8px",borderRadiusCircular:"10000px"},nk={fontSizeBase100:"10px",fontSizeBase200:"12px",fontSizeBase300:"14px",fontSizeBase400:"16px",fontSizeBase500:"20px",fontSizeBase600:"24px",fontSizeHero700:"28px",fontSizeHero800:"32px",fontSizeHero900:"40px",fontSizeHero1000:"68px"},ok={lineHeightBase100:"14px",lineHeightBase200:"16px",lineHeightBase300:"20px",lineHeightBase400:"22px",lineHeightBase500:"28px",lineHeightBase600:"32px",lineHeightHero700:"36px",lineHeightHero800:"40px",lineHeightHero900:"52px",lineHeightHero1000:"92px"},ik={fontWeightRegular:400,fontWeightMedium:500,fontWeightSemibold:600,fontWeightBold:700},ak={fontFamilyBase:"'Segoe UI', 'Segoe UI Web (West European)', -apple-system, BlinkMacSystemFont, Roboto, 'Helvetica Neue', sans-serif",fontFamilyMonospace:"Consolas, 'Courier New', Courier, monospace",fontFamilyNumeric:"Bahnschrift, 'Segoe UI', 'Segoe UI Web (West European)', -apple-system, BlinkMacSystemFont, Roboto, 'Helvetica Neue', sans-serif"},sk={strokeWidthThin:"1px",strokeWidthThick:"2px",strokeWidthThicker:"3px",strokeWidthThickest:"4px"};function ck(e,t,r=""){return{[`shadow2${r}`]:`0 0 2px ${e}, 0 1px 2px ${t}`,[`shadow4${r}`]:`0 0 2px ${e}, 0 2px 4px ${t}`,[`shadow8${r}`]:`0 0 2px ${e}, 0 4px 8px ${t}`,[`shadow16${r}`]:`0 0 2px ${e}, 0 8px 16px ${t}`,[`shadow28${r}`]:`0 0 8px ${e}, 0 14px 28px ${t}`,[`shadow64${r}`]:`0 0 8px ${e}, 0 32px 64px ${t}`}}const lk={durationUltraFast:"50ms",durationFaster:"100ms",durationFast:"150ms",durationNormal:"200ms",durationGentle:"250ms",durationSlow:"300ms",durationSlower:"400ms",durationUltraSlow:"500ms"},uk={curveAccelerateMax:"cubic-bezier(0.9,0.1,1,0.2)",curveAccelerateMid:"cubic-bezier(1,0,1,1)",curveAccelerateMin:"cubic-bezier(0.8,0,0.78,1)",curveDecelerateMax:"cubic-bezier(0.1,0.9,0.2,1)",curveDecelerateMid:"cubic-bezier(0,0,0,1)",curveDecelerateMin:"cubic-bezier(0.33,0,0.1,1)",curveEasyEaseMax:"cubic-bezier(0.8,0,0.2,1)",curveEasyEase:"cubic-bezier(0.33,0,0.67,1)",curveLinear:"cubic-bezier(0,0,1,1)"},dk="10px",hk="12px",pk="16px",fk="20px",gk="24px",mk="32px",yk={spacingHorizontalNone:"0",spacingHorizontalXXS:"2px",spacingHorizontalXS:"4px",spacingHorizontalSNudge:"6px",spacingHorizontalS:"8px",spacingHorizontalMNudge:dk,spacingHorizontalM:hk,spacingHorizontalL:pk,spacingHorizontalXL:fk,spacingHorizontalXXL:gk,spacingHorizontalXXXL:mk},vk={spacingVerticalNone:"0",spacingVerticalXXS:"2px",spacingVerticalXS:"4px",spacingVerticalSNudge:"6px",spacingVerticalS:"8px",spacingVerticalMNudge:dk,spacingVerticalM:hk,spacingVerticalL:pk,spacingVerticalXL:fk,spacingVerticalXXL:gk,spacingVerticalXXXL:mk},bk=(()=>{const e=(e=>({colorNeutralForeground1:RA,colorNeutralForeground1Hover:RA,colorNeutralForeground1Pressed:RA,colorNeutralForeground1Selected:RA,colorNeutralForeground2:OA,colorNeutralForeground2Hover:RA,colorNeutralForeground2Pressed:RA,colorNeutralForeground2Selected:RA,colorNeutralForeground2BrandHover:e[80],colorNeutralForeground2BrandPressed:e[70],colorNeutralForeground2BrandSelected:e[80],colorNeutralForeground3:MA,colorNeutralForeground3Hover:OA,colorNeutralForeground3Pressed:OA,colorNeutralForeground3Selected:OA,colorNeutralForeground3BrandHover:e[80],colorNeutralForeground3BrandPressed:e[70],colorNeutralForeground3BrandSelected:e[80],colorNeutralForeground4:"#707070",colorNeutralForegroundDisabled:NA,colorNeutralForegroundInvertedDisabled:FA,colorBrandForegroundLink:e[70],colorBrandForegroundLinkHover:e[60],colorBrandForegroundLinkPressed:e[40],colorBrandForegroundLinkSelected:e[70],colorNeutralForeground2Link:OA,colorNeutralForeground2LinkHover:RA,colorNeutralForeground2LinkPressed:RA,colorNeutralForeground2LinkSelected:RA,colorCompoundBrandForeground1:e[80],colorCompoundBrandForeground1Hover:e[70],colorCompoundBrandForeground1Pressed:e[60],colorBrandForeground1:e[80],colorBrandForeground2:e[70],colorBrandForeground2Hover:e[60],colorBrandForeground2Pressed:e[30],colorNeutralForeground1Static:RA,colorNeutralForegroundStaticInverted:KA,colorNeutralForegroundInverted:KA,colorNeutralForegroundInvertedHover:KA,colorNeutralForegroundInvertedPressed:KA,colorNeutralForegroundInvertedSelected:KA,colorNeutralForegroundInverted2:KA,colorNeutralForegroundOnBrand:KA,colorNeutralForegroundInvertedLink:KA,colorNeutralForegroundInvertedLinkHover:KA,colorNeutralForegroundInvertedLinkPressed:KA,colorNeutralForegroundInvertedLinkSelected:KA,colorBrandForegroundInverted:e[100],colorBrandForegroundInvertedHover:e[110],colorBrandForegroundInvertedPressed:e[100],colorBrandForegroundOnLight:e[80],colorBrandForegroundOnLightHover:e[70],colorBrandForegroundOnLightPressed:e[50],colorBrandForegroundOnLightSelected:e[60],colorNeutralBackground1:KA,colorNeutralBackground1Hover:$A,colorNeutralBackground1Pressed:BA,colorNeutralBackground1Selected:qA,colorNeutralBackground2:DA,colorNeutralBackground2Hover:HA,colorNeutralBackground2Pressed:"#dbdbdb",colorNeutralBackground2Selected:LA,colorNeutralBackground3:$A,colorNeutralBackground3Hover:qA,colorNeutralBackground3Pressed:"#d6d6d6",colorNeutralBackground3Selected:BA,colorNeutralBackground4:HA,colorNeutralBackground4Hover:DA,colorNeutralBackground4Pressed:$A,colorNeutralBackground4Selected:KA,colorNeutralBackground5:qA,colorNeutralBackground5Hover:$A,colorNeutralBackground5Pressed:HA,colorNeutralBackground5Selected:DA,colorNeutralBackground6:LA,colorNeutralBackgroundInverted:"#292929",colorNeutralBackgroundStatic:"#333333",colorNeutralBackgroundAlpha:UA,colorNeutralBackgroundAlpha2:"rgba(255, 255, 255, 0.8)",colorSubtleBackground:"transparent",colorSubtleBackgroundHover:$A,colorSubtleBackgroundPressed:BA,colorSubtleBackgroundSelected:qA,colorSubtleBackgroundLightAlphaHover:"rgba(255, 255, 255, 0.7)",colorSubtleBackgroundLightAlphaPressed:UA,colorSubtleBackgroundLightAlphaSelected:"transparent",colorSubtleBackgroundInverted:"transparent",colorSubtleBackgroundInvertedHover:zA,colorSubtleBackgroundInvertedPressed:"rgba(0, 0, 0, 0.3)",colorSubtleBackgroundInvertedSelected:"rgba(0, 0, 0, 0.2)",colorTransparentBackground:"transparent",colorTransparentBackgroundHover:"transparent",colorTransparentBackgroundPressed:"transparent",colorTransparentBackgroundSelected:"transparent",colorNeutralBackgroundDisabled:HA,colorNeutralBackgroundInvertedDisabled:"rgba(255, 255, 255, 0.1)",colorNeutralStencil1:LA,colorNeutralStencil2:DA,colorNeutralStencil1Alpha:zA,colorNeutralStencil2Alpha:jA,colorBackgroundOverlay:"rgba(0, 0, 0, 0.4)",colorScrollbarOverlay:"rgba(0, 0, 0, 0.5)",colorBrandBackground:e[80],colorBrandBackgroundHover:e[70],colorBrandBackgroundPressed:e[40],colorBrandBackgroundSelected:e[60],colorCompoundBrandBackground:e[80],colorCompoundBrandBackgroundHover:e[70],colorCompoundBrandBackgroundPressed:e[60],colorBrandBackgroundStatic:e[80],colorBrandBackground2:e[160],colorBrandBackground2Hover:e[150],colorBrandBackground2Pressed:e[130],colorBrandBackground3Static:e[60],colorBrandBackground4Static:e[40],colorBrandBackgroundInverted:KA,colorBrandBackgroundInvertedHover:e[160],colorBrandBackgroundInvertedPressed:e[140],colorBrandBackgroundInvertedSelected:e[150],colorNeutralCardBackground:DA,colorNeutralCardBackgroundHover:KA,colorNeutralCardBackgroundPressed:$A,colorNeutralCardBackgroundSelected:qA,colorNeutralCardBackgroundDisabled:HA,colorNeutralStrokeAccessible:MA,colorNeutralStrokeAccessibleHover:"#575757",colorNeutralStrokeAccessiblePressed:"#4d4d4d",colorNeutralStrokeAccessibleSelected:e[80],colorNeutralStroke1:"#d1d1d1",colorNeutralStroke1Hover:"#c7c7c7",colorNeutralStroke1Pressed:"#b3b3b3",colorNeutralStroke1Selected:NA,colorNeutralStroke2:BA,colorNeutralStroke3:HA,colorNeutralStrokeSubtle:BA,colorNeutralStrokeOnBrand:KA,colorNeutralStrokeOnBrand2:KA,colorNeutralStrokeOnBrand2Hover:KA,colorNeutralStrokeOnBrand2Pressed:KA,colorNeutralStrokeOnBrand2Selected:KA,colorBrandStroke1:e[80],colorBrandStroke2:e[140],colorBrandStroke2Hover:e[120],colorBrandStroke2Pressed:e[80],colorBrandStroke2Contrast:e[140],colorCompoundBrandStroke:e[80],colorCompoundBrandStrokeHover:e[70],colorCompoundBrandStrokePressed:e[60],colorNeutralStrokeDisabled:BA,colorNeutralStrokeInvertedDisabled:FA,colorTransparentStroke:"transparent",colorTransparentStrokeInteractive:"transparent",colorTransparentStrokeDisabled:"transparent",colorNeutralStrokeAlpha:jA,colorNeutralStrokeAlpha2:"rgba(255, 255, 255, 0.2)",colorStrokeFocus1:KA,colorStrokeFocus2:"#000000",colorNeutralShadowAmbient:"rgba(0,0,0,0.12)",colorNeutralShadowKey:"rgba(0,0,0,0.14)",colorNeutralShadowAmbientLighter:"rgba(0,0,0,0.06)",colorNeutralShadowKeyLighter:"rgba(0,0,0,0.07)",colorNeutralShadowAmbientDarker:"rgba(0,0,0,0.20)",colorNeutralShadowKeyDarker:"rgba(0,0,0,0.24)",colorBrandShadowAmbient:"rgba(0,0,0,0.30)",colorBrandShadowKey:"rgba(0,0,0,0.25)"}))({10:"#061724",20:"#082338",30:"#0a2e4a",40:"#0c3b5e",50:"#0e4775",60:"#0f548c",70:"#115ea3",80:"#0f6cbd",90:"#2886de",100:"#479ef5",110:"#62abf5",120:"#77b7f7",130:"#96c6fa",140:"#b4d6fa",150:"#cfe4fa",160:"#ebf3fc"});return{...rk,...nk,...ok,...ak,...ik,...sk,...yk,...vk,...lk,...uk,...e,...ek,...tk,...ck(e.colorNeutralShadowAmbient,e.colorNeutralShadowKey),...ck(e.colorBrandShadowAmbient,e.colorBrandShadowKey,"Brand")}})();var wk=document.getElementById("container"),Ck=wk?(0,i.H)(wk):void 0;Office.onReady((function(){null==Ck||Ck.render(n.createElement(PA,{theme:bk},n.createElement(Xw,null)))}))},71354:function(e){e.exports=function(e){var t=e[1],r=e[3];if(!r)return t;if("function"==typeof btoa){var n=btoa(unescape(encodeURIComponent(JSON.stringify(r)))),o="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(n),i="/*# ".concat(o," */");return[t].concat([i]).join("\n")}return[t].join("\n")}},73404:function(e,t,r){e.exports=r(3072)},74848:function(e,t,r){e.exports=r(21020)},76314:function(e){e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var r="",n=void 0!==t[5];return t[4]&&(r+="@supports (".concat(t[4],") {")),t[2]&&(r+="@media ".concat(t[2]," {")),n&&(r+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),r+=e(t),n&&(r+="}"),t[2]&&(r+="}"),t[4]&&(r+="}"),r})).join("")},t.i=function(e,r,n,o,i){"string"==typeof e&&(e=[[null,e,void 0]]);var a={};if(n)for(var s=0;s<this.length;s++){var c=this[s][0];null!=c&&(a[c]=!0)}for(var l=0;l<e.length;l++){var u=[].concat(e[l]);n&&a[u[0]]||(void 0!==i&&(void 0===u[5]||(u[1]="@layer".concat(u[5].length>0?" ".concat(u[5]):""," {").concat(u[1],"}")),u[5]=i),r&&(u[2]?(u[1]="@media ".concat(u[2]," {").concat(u[1],"}"),u[2]=r):u[2]=r),o&&(u[4]?(u[1]="@supports (".concat(u[4],") {").concat(u[1],"}"),u[4]=o):u[4]="".concat(o)),t.push(u))}},t}},77659:function(e){var t={};e.exports=function(e,r){var n=function(e){if(void 0===t[e]){var r=document.querySelector(e);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(e){r=null}t[e]=r}return t[e]}(e);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");n.appendChild(r)}},85072:function(e){var t=[];function r(e){for(var r=-1,n=0;n<t.length;n++)if(t[n].identifier===e){r=n;break}return r}function n(e,n){for(var i={},a=[],s=0;s<e.length;s++){var c=e[s],l=n.base?c[0]+n.base:c[0],u=i[l]||0,d="".concat(l," ").concat(u);i[l]=u+1;var h=r(d),p={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==h)t[h].references++,t[h].updater(p);else{var f=o(p,n);n.byIndex=s,t.splice(s,0,{identifier:d,updater:f,references:1})}a.push(d)}return a}function o(e,t){var r=t.domAPI(t);return r.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;r.update(e=t)}else r.remove()}}e.exports=function(e,o){var i=n(e=e||[],o=o||{});return function(e){e=e||[];for(var a=0;a<i.length;a++){var s=r(i[a]);t[s].references--}for(var c=n(e,o),l=0;l<i.length;l++){var u=r(i[l]);0===t[u].references&&(t[u].updater(),t.splice(u,1))}i=c}}},96674:function(e,t,r){var n=r(71354),o=r.n(n),i=r(76314),a=r.n(i)()(o());a.push([e.id,'@-webkit-keyframes notyf-fadeinup{0%{opacity:0;transform:translateY(25%)}to{opacity:1;transform:translateY(0)}}@keyframes notyf-fadeinup{0%{opacity:0;transform:translateY(25%)}to{opacity:1;transform:translateY(0)}}@-webkit-keyframes notyf-fadeinleft{0%{opacity:0;transform:translateX(25%)}to{opacity:1;transform:translateX(0)}}@keyframes notyf-fadeinleft{0%{opacity:0;transform:translateX(25%)}to{opacity:1;transform:translateX(0)}}@-webkit-keyframes notyf-fadeoutright{0%{opacity:1;transform:translateX(0)}to{opacity:0;transform:translateX(25%)}}@keyframes notyf-fadeoutright{0%{opacity:1;transform:translateX(0)}to{opacity:0;transform:translateX(25%)}}@-webkit-keyframes notyf-fadeoutdown{0%{opacity:1;transform:translateY(0)}to{opacity:0;transform:translateY(25%)}}@keyframes notyf-fadeoutdown{0%{opacity:1;transform:translateY(0)}to{opacity:0;transform:translateY(25%)}}@-webkit-keyframes ripple{0%{transform:scale(0) translateY(-45%) translateX(13%)}to{transform:scale(1) translateY(-45%) translateX(13%)}}@keyframes ripple{0%{transform:scale(0) translateY(-45%) translateX(13%)}to{transform:scale(1) translateY(-45%) translateX(13%)}}.notyf{position:fixed;top:0;left:0;height:100%;width:100%;color:#fff;z-index:9999;display:flex;flex-direction:column;align-items:flex-end;justify-content:flex-end;pointer-events:none;box-sizing:border-box;padding:20px}.notyf__icon--error,.notyf__icon--success{height:21px;width:21px;background:#fff;border-radius:50%;display:block;margin:0 auto;position:relative}.notyf__icon--error:after,.notyf__icon--error:before{content:"";background:currentColor;display:block;position:absolute;width:3px;border-radius:3px;left:9px;height:12px;top:5px}.notyf__icon--error:after{transform:rotate(-45deg)}.notyf__icon--error:before{transform:rotate(45deg)}.notyf__icon--success:after,.notyf__icon--success:before{content:"";background:currentColor;display:block;position:absolute;width:3px;border-radius:3px}.notyf__icon--success:after{height:6px;transform:rotate(-45deg);top:9px;left:6px}.notyf__icon--success:before{height:11px;transform:rotate(45deg);top:5px;left:10px}.notyf__toast{display:block;overflow:hidden;pointer-events:auto;-webkit-animation:notyf-fadeinup .3s ease-in forwards;animation:notyf-fadeinup .3s ease-in forwards;box-shadow:0 3px 7px 0 rgba(0,0,0,.25);position:relative;padding:0 15px;border-radius:2px;max-width:300px;transform:translateY(25%);box-sizing:border-box;flex-shrink:0}.notyf__toast--disappear{transform:translateY(0);-webkit-animation:notyf-fadeoutdown .3s forwards;animation:notyf-fadeoutdown .3s forwards;-webkit-animation-delay:.25s;animation-delay:.25s}.notyf__toast--disappear .notyf__icon,.notyf__toast--disappear .notyf__message{-webkit-animation:notyf-fadeoutdown .3s forwards;animation:notyf-fadeoutdown .3s forwards;opacity:1;transform:translateY(0)}.notyf__toast--disappear .notyf__dismiss{-webkit-animation:notyf-fadeoutright .3s forwards;animation:notyf-fadeoutright .3s forwards;opacity:1;transform:translateX(0)}.notyf__toast--disappear .notyf__message{-webkit-animation-delay:.05s;animation-delay:.05s}.notyf__toast--upper{margin-bottom:20px}.notyf__toast--lower{margin-top:20px}.notyf__toast--dismissible .notyf__wrapper{padding-right:30px}.notyf__ripple{height:400px;width:400px;position:absolute;transform-origin:bottom right;right:0;top:0;border-radius:50%;transform:scale(0) translateY(-51%) translateX(13%);z-index:5;-webkit-animation:ripple .4s ease-out forwards;animation:ripple .4s ease-out forwards}.notyf__wrapper{display:flex;align-items:center;padding-top:17px;padding-bottom:17px;padding-right:15px;border-radius:3px;position:relative;z-index:10}.notyf__icon{width:22px;text-align:center;font-size:1.3em;opacity:0;-webkit-animation:notyf-fadeinup .3s forwards;animation:notyf-fadeinup .3s forwards;-webkit-animation-delay:.3s;animation-delay:.3s;margin-right:13px}.notyf__dismiss{position:absolute;top:0;right:0;height:100%;width:26px;margin-right:-15px;-webkit-animation:notyf-fadeinleft .3s forwards;animation:notyf-fadeinleft .3s forwards;-webkit-animation-delay:.35s;animation-delay:.35s;opacity:0}.notyf__dismiss-btn{background-color:rgba(0,0,0,.25);border:none;cursor:pointer;transition:opacity .2s ease,background-color .2s ease;outline:none;opacity:.35;height:100%;width:100%}.notyf__dismiss-btn:after,.notyf__dismiss-btn:before{content:"";background:#fff;height:12px;width:2px;border-radius:3px;position:absolute;left:calc(50% - 1px);top:calc(50% - 5px)}.notyf__dismiss-btn:after{transform:rotate(-45deg)}.notyf__dismiss-btn:before{transform:rotate(45deg)}.notyf__dismiss-btn:hover{opacity:.7;background-color:rgba(0,0,0,.15)}.notyf__dismiss-btn:active{opacity:.8}.notyf__message{vertical-align:middle;position:relative;opacity:0;-webkit-animation:notyf-fadeinup .3s forwards;animation:notyf-fadeinup .3s forwards;-webkit-animation-delay:.25s;animation-delay:.25s;line-height:1.5em}@media only screen and (max-width:480px){.notyf{padding:0}.notyf__ripple{height:600px;width:600px;-webkit-animation-duration:.5s;animation-duration:.5s}.notyf__toast{max-width:none;border-radius:0;box-shadow:0 -2px 7px 0 rgba(0,0,0,.13);width:100%}.notyf__dismiss{width:56px}}',"",{version:3,sources:["webpack://./node_modules/notyf/notyf.min.css"],names:[],mappings:"AAAA,kCAAkC,GAAG,SAAS,CAAC,yBAAyB,CAAC,GAAG,SAAS,CAAC,uBAAuB,CAAC,CAAC,0BAA0B,GAAG,SAAS,CAAC,yBAAyB,CAAC,GAAG,SAAS,CAAC,uBAAuB,CAAC,CAAC,oCAAoC,GAAG,SAAS,CAAC,yBAAyB,CAAC,GAAG,SAAS,CAAC,uBAAuB,CAAC,CAAC,4BAA4B,GAAG,SAAS,CAAC,yBAAyB,CAAC,GAAG,SAAS,CAAC,uBAAuB,CAAC,CAAC,sCAAsC,GAAG,SAAS,CAAC,uBAAuB,CAAC,GAAG,SAAS,CAAC,yBAAyB,CAAC,CAAC,8BAA8B,GAAG,SAAS,CAAC,uBAAuB,CAAC,GAAG,SAAS,CAAC,yBAAyB,CAAC,CAAC,qCAAqC,GAAG,SAAS,CAAC,uBAAuB,CAAC,GAAG,SAAS,CAAC,yBAAyB,CAAC,CAAC,6BAA6B,GAAG,SAAS,CAAC,uBAAuB,CAAC,GAAG,SAAS,CAAC,yBAAyB,CAAC,CAAC,0BAA0B,GAAG,mDAAmD,CAAC,GAAG,mDAAmD,CAAC,CAAC,kBAAkB,GAAG,mDAAmD,CAAC,GAAG,mDAAmD,CAAC,CAAC,OAAO,cAAc,CAAC,KAAK,CAAC,MAAM,CAAC,WAAW,CAAC,UAAU,CAAC,UAAU,CAAC,YAAY,CAAC,YAAY,CAAC,qBAAqB,CAAC,oBAAoB,CAAC,wBAAwB,CAAC,mBAAmB,CAAC,qBAAqB,CAAC,YAAY,CAAC,0CAA0C,WAAW,CAAC,UAAU,CAAC,eAAe,CAAC,iBAAiB,CAAC,aAAa,CAAC,aAAa,CAAC,iBAAiB,CAAC,qDAAqD,UAAU,CAAC,uBAAuB,CAAC,aAAa,CAAC,iBAAiB,CAAC,SAAS,CAAC,iBAAiB,CAAC,QAAQ,CAAC,WAAW,CAAC,OAAO,CAAC,0BAA0B,wBAAwB,CAAC,2BAA2B,uBAAuB,CAAC,yDAAyD,UAAU,CAAC,uBAAuB,CAAC,aAAa,CAAC,iBAAiB,CAAC,SAAS,CAAC,iBAAiB,CAAC,4BAA4B,UAAU,CAAC,wBAAwB,CAAC,OAAO,CAAC,QAAQ,CAAC,6BAA6B,WAAW,CAAC,uBAAuB,CAAC,OAAO,CAAC,SAAS,CAAC,cAAc,aAAa,CAAC,eAAe,CAAC,mBAAmB,CAAC,qDAAqD,CAAC,6CAA6C,CAAC,sCAAsC,CAAC,iBAAiB,CAAC,cAAc,CAAC,iBAAiB,CAAC,eAAe,CAAC,yBAAyB,CAAC,qBAAqB,CAAC,aAAa,CAAC,yBAAyB,uBAAuB,CAAC,gDAAgD,CAAC,wCAAwC,CAAC,4BAA4B,CAAC,oBAAoB,CAAC,+EAA+E,gDAAgD,CAAC,wCAAwC,CAAC,SAAS,CAAC,uBAAuB,CAAC,yCAAyC,iDAAiD,CAAC,yCAAyC,CAAC,SAAS,CAAC,uBAAuB,CAAC,yCAAyC,4BAA4B,CAAC,oBAAoB,CAAC,qBAAqB,kBAAkB,CAAC,qBAAqB,eAAe,CAAC,2CAA2C,kBAAkB,CAAC,eAAe,YAAY,CAAC,WAAW,CAAC,iBAAiB,CAAC,6BAA6B,CAAC,OAAO,CAAC,KAAK,CAAC,iBAAiB,CAAC,mDAAmD,CAAC,SAAS,CAAC,8CAA8C,CAAC,sCAAsC,CAAC,gBAAgB,YAAY,CAAC,kBAAkB,CAAC,gBAAgB,CAAC,mBAAmB,CAAC,kBAAkB,CAAC,iBAAiB,CAAC,iBAAiB,CAAC,UAAU,CAAC,aAAa,UAAU,CAAC,iBAAiB,CAAC,eAAe,CAAC,SAAS,CAAC,6CAA6C,CAAC,qCAAqC,CAAC,2BAA2B,CAAC,mBAAmB,CAAC,iBAAiB,CAAC,gBAAgB,iBAAiB,CAAC,KAAK,CAAC,OAAO,CAAC,WAAW,CAAC,UAAU,CAAC,kBAAkB,CAAC,+CAA+C,CAAC,uCAAuC,CAAC,4BAA4B,CAAC,oBAAoB,CAAC,SAAS,CAAC,oBAAoB,gCAAgC,CAAC,WAAW,CAAC,cAAc,CAAC,qDAAqD,CAAC,YAAY,CAAC,WAAW,CAAC,WAAW,CAAC,UAAU,CAAC,qDAAqD,UAAU,CAAC,eAAe,CAAC,WAAW,CAAC,SAAS,CAAC,iBAAiB,CAAC,iBAAiB,CAAC,oBAAoB,CAAC,mBAAmB,CAAC,0BAA0B,wBAAwB,CAAC,2BAA2B,uBAAuB,CAAC,0BAA0B,UAAU,CAAC,gCAAgC,CAAC,2BAA2B,UAAU,CAAC,gBAAgB,qBAAqB,CAAC,iBAAiB,CAAC,SAAS,CAAC,6CAA6C,CAAC,qCAAqC,CAAC,4BAA4B,CAAC,oBAAoB,CAAC,iBAAiB,CAAC,yCAAyC,OAAO,SAAS,CAAC,eAAe,YAAY,CAAC,WAAW,CAAC,8BAA8B,CAAC,sBAAsB,CAAC,cAAc,cAAc,CAAC,eAAe,CAAC,uCAAuC,CAAC,UAAU,CAAC,gBAAgB,UAAU,CAAC",sourcesContent:['@-webkit-keyframes notyf-fadeinup{0%{opacity:0;transform:translateY(25%)}to{opacity:1;transform:translateY(0)}}@keyframes notyf-fadeinup{0%{opacity:0;transform:translateY(25%)}to{opacity:1;transform:translateY(0)}}@-webkit-keyframes notyf-fadeinleft{0%{opacity:0;transform:translateX(25%)}to{opacity:1;transform:translateX(0)}}@keyframes notyf-fadeinleft{0%{opacity:0;transform:translateX(25%)}to{opacity:1;transform:translateX(0)}}@-webkit-keyframes notyf-fadeoutright{0%{opacity:1;transform:translateX(0)}to{opacity:0;transform:translateX(25%)}}@keyframes notyf-fadeoutright{0%{opacity:1;transform:translateX(0)}to{opacity:0;transform:translateX(25%)}}@-webkit-keyframes notyf-fadeoutdown{0%{opacity:1;transform:translateY(0)}to{opacity:0;transform:translateY(25%)}}@keyframes notyf-fadeoutdown{0%{opacity:1;transform:translateY(0)}to{opacity:0;transform:translateY(25%)}}@-webkit-keyframes ripple{0%{transform:scale(0) translateY(-45%) translateX(13%)}to{transform:scale(1) translateY(-45%) translateX(13%)}}@keyframes ripple{0%{transform:scale(0) translateY(-45%) translateX(13%)}to{transform:scale(1) translateY(-45%) translateX(13%)}}.notyf{position:fixed;top:0;left:0;height:100%;width:100%;color:#fff;z-index:9999;display:flex;flex-direction:column;align-items:flex-end;justify-content:flex-end;pointer-events:none;box-sizing:border-box;padding:20px}.notyf__icon--error,.notyf__icon--success{height:21px;width:21px;background:#fff;border-radius:50%;display:block;margin:0 auto;position:relative}.notyf__icon--error:after,.notyf__icon--error:before{content:"";background:currentColor;display:block;position:absolute;width:3px;border-radius:3px;left:9px;height:12px;top:5px}.notyf__icon--error:after{transform:rotate(-45deg)}.notyf__icon--error:before{transform:rotate(45deg)}.notyf__icon--success:after,.notyf__icon--success:before{content:"";background:currentColor;display:block;position:absolute;width:3px;border-radius:3px}.notyf__icon--success:after{height:6px;transform:rotate(-45deg);top:9px;left:6px}.notyf__icon--success:before{height:11px;transform:rotate(45deg);top:5px;left:10px}.notyf__toast{display:block;overflow:hidden;pointer-events:auto;-webkit-animation:notyf-fadeinup .3s ease-in forwards;animation:notyf-fadeinup .3s ease-in forwards;box-shadow:0 3px 7px 0 rgba(0,0,0,.25);position:relative;padding:0 15px;border-radius:2px;max-width:300px;transform:translateY(25%);box-sizing:border-box;flex-shrink:0}.notyf__toast--disappear{transform:translateY(0);-webkit-animation:notyf-fadeoutdown .3s forwards;animation:notyf-fadeoutdown .3s forwards;-webkit-animation-delay:.25s;animation-delay:.25s}.notyf__toast--disappear .notyf__icon,.notyf__toast--disappear .notyf__message{-webkit-animation:notyf-fadeoutdown .3s forwards;animation:notyf-fadeoutdown .3s forwards;opacity:1;transform:translateY(0)}.notyf__toast--disappear .notyf__dismiss{-webkit-animation:notyf-fadeoutright .3s forwards;animation:notyf-fadeoutright .3s forwards;opacity:1;transform:translateX(0)}.notyf__toast--disappear .notyf__message{-webkit-animation-delay:.05s;animation-delay:.05s}.notyf__toast--upper{margin-bottom:20px}.notyf__toast--lower{margin-top:20px}.notyf__toast--dismissible .notyf__wrapper{padding-right:30px}.notyf__ripple{height:400px;width:400px;position:absolute;transform-origin:bottom right;right:0;top:0;border-radius:50%;transform:scale(0) translateY(-51%) translateX(13%);z-index:5;-webkit-animation:ripple .4s ease-out forwards;animation:ripple .4s ease-out forwards}.notyf__wrapper{display:flex;align-items:center;padding-top:17px;padding-bottom:17px;padding-right:15px;border-radius:3px;position:relative;z-index:10}.notyf__icon{width:22px;text-align:center;font-size:1.3em;opacity:0;-webkit-animation:notyf-fadeinup .3s forwards;animation:notyf-fadeinup .3s forwards;-webkit-animation-delay:.3s;animation-delay:.3s;margin-right:13px}.notyf__dismiss{position:absolute;top:0;right:0;height:100%;width:26px;margin-right:-15px;-webkit-animation:notyf-fadeinleft .3s forwards;animation:notyf-fadeinleft .3s forwards;-webkit-animation-delay:.35s;animation-delay:.35s;opacity:0}.notyf__dismiss-btn{background-color:rgba(0,0,0,.25);border:none;cursor:pointer;transition:opacity .2s ease,background-color .2s ease;outline:none;opacity:.35;height:100%;width:100%}.notyf__dismiss-btn:after,.notyf__dismiss-btn:before{content:"";background:#fff;height:12px;width:2px;border-radius:3px;position:absolute;left:calc(50% - 1px);top:calc(50% - 5px)}.notyf__dismiss-btn:after{transform:rotate(-45deg)}.notyf__dismiss-btn:before{transform:rotate(45deg)}.notyf__dismiss-btn:hover{opacity:.7;background-color:rgba(0,0,0,.15)}.notyf__dismiss-btn:active{opacity:.8}.notyf__message{vertical-align:middle;position:relative;opacity:0;-webkit-animation:notyf-fadeinup .3s forwards;animation:notyf-fadeinup .3s forwards;-webkit-animation-delay:.25s;animation-delay:.25s;line-height:1.5em}@media only screen and (max-width:480px){.notyf{padding:0}.notyf__ripple{height:600px;width:600px;-webkit-animation-duration:.5s;animation-duration:.5s}.notyf__toast{max-width:none;border-radius:0;box-shadow:0 -2px 7px 0 rgba(0,0,0,.13);width:100%}.notyf__dismiss{width:56px}}'],sourceRoot:""}]),t.A=a},97825:function(e){e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(r){!function(e,t,r){var n="";r.supports&&(n+="@supports (".concat(r.supports,") {")),r.media&&(n+="@media ".concat(r.media," {"));var o=void 0!==r.layer;o&&(n+="@layer".concat(r.layer.length>0?" ".concat(r.layer):""," {")),n+=r.css,o&&(n+="}"),r.media&&(n+="}"),r.supports&&(n+="}");var i=r.sourceMap;i&&"undefined"!=typeof btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),t.styleTagTransform(n,e,t.options)}(t,e,r)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}}},function(e){var t=function(t){return e(e.s=t)};t(65975),t(39046)}]);
//# sourceMappingURL=taskpane.js.map